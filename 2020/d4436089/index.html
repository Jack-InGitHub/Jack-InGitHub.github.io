<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.webp"><link rel="icon" href="/img/favicon.webp"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="author" content="Oikiou"><meta name="keywords" content=""><meta name="description" content="前言 Uboot、根文件系统、Linux Linux驱动分为三大类，字符设备驱动、块设备驱动、网络设备驱动  linux 入门基础user@machine: ~$  $ 代表当前用户是普通用户 # 代表当前用户是root  系统目录   &#x2F;bin  存储一些二进制可执行命令文件，&#x2F;usr&#x2F;bin也存放了一些基于用户的命令文件。一般用户可用, 启动可能会用到的命令."><meta property="og:type" content="article"><meta property="og:title" content="Linux 杂乱学习笔记"><meta property="og:url" content="https://www.oikiou.top/2020/d4436089/index.html"><meta property="og:site_name" content="Oikiou&#39;s Blog"><meta property="og:description" content="前言 Uboot、根文件系统、Linux Linux驱动分为三大类，字符设备驱动、块设备驱动、网络设备驱动  linux 入门基础user@machine: ~$  $ 代表当前用户是普通用户 # 代表当前用户是root  系统目录   &#x2F;bin  存储一些二进制可执行命令文件，&#x2F;usr&#x2F;bin也存放了一些基于用户的命令文件。一般用户可用, 启动可能会用到的命令."><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/63d0f703918fa0ece0691081209759ee3c6ddb94.jpg"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/123.png"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/1-s2.0-S1742287617300270-gr2.jpg"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/image-20230107231700676.png"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/1192583-20170925225909964-1496152149.png"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/v2-7cf8cec396a66dca2dd1fcd6dadab537_720w.webp"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/v2-5606413e1b5d2c727399711d347617a2_720w.webp"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/5e3e5278d08a31313.png_e1080.jpg"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/webp.webp"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/webp-16552860429952.webp"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/main-16552870928465.png"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/GPIO1.png"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/image-20210801204738591.png"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/1889022-20200410121643886-1233996502.png"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/1889022-20200410132825370-786913267.png"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/1889022-20200410134354086-537662427.png"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/1889022-20200410134655161-2081521744.png"><meta property="og:image" content="https://www.oikiou.top/2020/d4436089/1889022-20200410134856417-744239525.png"><meta property="article:published_time" content="2020-10-29T05:12:15.000Z"><meta property="article:modified_time" content="2023-07-06T13:17:32.035Z"><meta property="article:author" content="Oikiou"><meta property="article:tag" content="linux"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://www.oikiou.top/2020/d4436089/63d0f703918fa0ece0691081209759ee3c6ddb94.jpg"><meta name="referrer" content="no-referrer-when-downgrade"><title>Linux 杂乱学习笔记 - Oikiou&#39;s Blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/custom.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var dntVal,CONFIG={hostname:"www.oikiou.top",root:"/",version:"1.9.7",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"bash"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"left",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!1,baidu:null,google:"G-TSV6137NWK",tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1},gtag:"G-TSV6137NWK"},search_path:"/xml/local-search-database.xml",include_content_in_search:!0};CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=",function(){function a(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],a("js",new Date),a("config","")})</script><meta name="generator" content="Hexo 6.3.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Oikiou&#39;s Blog</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/" target="_self"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/" target="_self"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/" target="_self"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/" target="_self"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item"><a class="nav-link" href="/links/" target="_self"><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(https://bing.img.run/1920x1080.php) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="Linux 杂乱学习笔记"></span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> Oikiou </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2020-10-29 13:12" pubdate>2020年10月29日 下午</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 28k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 463 分钟 </span><span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="busuanzi_value_page_pv"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="padding-left:2rem;margin-right:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">Linux 杂乱学习笔记</h1><p id="updated-time" class="note note-info" style="display:none">本文最后更新于 2023-07-06T21:17:32+08:00</p><div class="markdown-body"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><ul><li>Uboot、根文件系统、Linux</li><li>Linux驱动分为三大类，字符设备驱动、块设备驱动、网络设备驱动</li></ul><h1 id="linux-入门"><a href="#linux-入门" class="headerlink" title="linux 入门"></a>linux 入门</h1><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><p><code>user@machine: ~$</code></p><ul><li>$ 代表当前用户是普通用户</li><li># 代表当前用户是root</li></ul><h2 id="系统目录"><a href="#系统目录" class="headerlink" title="系统目录"></a>系统目录</h2><blockquote><p><strong>&#x2F;bin</strong><br>存储一些二进制可执行命令文件，&#x2F;usr&#x2F;bin也存放了一些基于用户的命令文件。一般用户可用, 启动可能会用到的命令.</p><p><strong>&#x2F;sbin</strong><br>存储了很多系统命令， &#x2F;usr&#x2F;sbin也存储了许多系统命令。</p><p><strong>&#x2F;root</strong><br>超级用户 root的根目录文件。</p><p><strong>&#x2F;home</strong><br>普通用户默认目录，在该目录下，每个用户都有一以本名命的文件夹。</p><p><strong>&#x2F;boot</strong><br>存放 Ubuntu系统<strong>内核和启动</strong>文件。</p><p><strong>&#x2F;mnt</strong><br>通常包括系统引导后被挂载的文件点。 通常包括系统引导后被挂载的文件点。</p><p><strong>&#x2F;dev</strong><br>存放设备文件，我们后面学习 Linux驱动主要是跟这个文件夹打交道的。</p><p><strong>&#x2F;etc</strong><br>保存系统管理所需的<strong>配置文件</strong>和目录。</p><p><strong>&#x2F;lib</strong><br>保存系统程序运行所需的库文件， &#x2F;usr&#x2F;lib下存放了一些用于普通户的库文件。</p><p><strong>&#x2F;lost+found</strong><br>一般为空，当系统非正常关机以后此文件夹会保存些零散文件。</p><p><strong>&#x2F;var</strong> (variable 可变动的)<br>存储一些不断变化的文件 ，比如日志文件 。</p><p><strong>&#x2F;usr</strong> (Unix Software Resource)<br>包括与系统用户直接有关的文件和目录，比如应程序所需库。</p><p><strong>&#x2F;media</strong><br>存放 Ubuntu系统自动挂载的设备文件。</p><p><strong>&#x2F;proc</strong><br>虚拟目录，不实际存储在磁盘上通常用来保系统信息和进程。</p><p><strong>&#x2F;tmp</strong><br>存储系统和用户的临时文件，该夹对所有都提供读写权限。</p><p><strong>&#x2F;opt</strong><br>可选第三方程序的存放目录。</p><p><strong>&#x2F;sys</strong><br>系统设备和文件层次结构，并向用户程序提供详细的内核数据信息。</p></blockquote><h2 id="Shell-基本操作"><a href="#Shell-基本操作" class="headerlink" title="Shell 基本操作"></a>Shell 基本操作</h2><h3 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h3><p>^x(Ctrl+x)</p><p>^C	终止前面运行程序</p><p>^D	退出exit</p><p>^L	清屏</p><p>^A	光标移到到最前面</p><p>^E	光标移到到最后面</p><p>^U	删除光标前面所有字符</p><p>^K	删除光标前面所有字符</p><p>Alt+Backspace 删除一个单词</p><p>^R	搜索历史命令</p><p>Alt+.	引用最后一个命令的参数等价于!$</p><p>Esc . 同上</p><h3 id="历史命令"><a href="#历史命令" class="headerlink" title="历史命令"></a>历史命令</h3><ul><li># history</li><li>光标上下</li><li>^R	搜索历史命令</li><li>!200 特定序号</li><li>!字符串 以某字符串开头的</li><li>!$ 引用最后一个命令的参数</li></ul><blockquote><p>按<code>Ctrl+R</code>可以调出 bash中曾经的历史命令,</p><p>再次按<code>Ctrl+R</code>可以切换匹配的内容</p><p>光标会停留在 第一次被匹配的字符上, (即使后面你再输入被匹配的字符, 光标也不移动)</p><p>然后, 根据你的需要 来进行任何一次的操作, 都表示接受: (也就是说, 这个时候, 你就可以当作 你已经输入了这样的命令, 你就可以直接对该命令进行操作&#x2F;编辑&#x2F;修改了….)</p><p>如:<br>向前, 向后进行编辑: <code>ctrl+F</code>, <code>ctrl+B</code><br>删除前面,后面的字符: <code>ctrl+D</code>,<code>ctrl+H</code><br>移动到命令结尾,开头:<code>ctrl+E</code>, <code>ctrl+A</code></p></blockquote><h2 id="初窥文件系统"><a href="#初窥文件系统" class="headerlink" title="初窥文件系统"></a>初窥文件系统</h2><p>在 Windows 下有 FAT、NTFS 和 exFAT 这样的文件系统，在 Linux 下的文件系统主要有 ext2、ext3、ext4 等文件系统。</p><p>Linux 还支持其他的 UNIX 文件系统，比如 XFS、JFS、UFS 等，也支持 Windows 的 FAT 文件系统和网络文件系统 NFS 等。</p><blockquote><p>格式化：在windows 下的<strong>格式化</strong>其实我们应该理解成<strong>更换（或者说更新）文件系统</strong>，而<strong>格式化</strong>就是理解成把<strong>磁盘等等硬件设备</strong>按照<strong>文件系统的要求的格式</strong>进行划分。每个文件系统的规则都是不一样的，这也是为什么格式化之后文件都没了，因为新的文件系统规则是无法兼容旧的文件系统规则的，所以自然也就无法读取旧的文件系统的数据。</p></blockquote><p>在windows下磁盘的分区是根据盘符来加以区分，而在linux下是根据磁盘分区的挂载点（<code>mount</code>命令）来确定位置。</p><h2 id="磁盘管理"><a href="#磁盘管理" class="headerlink" title="磁盘管理"></a>磁盘管理</h2><blockquote><p>linux下磁盘的操作主要是通过 fdisk 命令</p><p>通过 fdisk 建立的磁盘 我们需要给他创建(构建)一个文件系统 创建文件系统后就能存放文件，这里用的就是 mkfs 命令去构建文件系统</p><p>在linux下和windows下不一样的是，windows会自动分配盘符给你，但是linux需要“手动分配盘符”，linux下是没有盘符的概念，linux是基于根目录<code>/</code>的根概念，所以我们可以认为linux只有一个盘符，我们只能把磁盘挂在“树的枝叶”上，也就是某个目录，这就涉及到了mount和unmount挂载和卸载的命令。</p></blockquote><p><a href="#fdisk">点击转到 fdisk 命令</a></p><p><a href="#mkfs">点击转到 mkfs 命令</a></p><p><a href="#mount">点击转到 mount 命令</a></p><h2 id="文件类型-amp-权限"><a href="#文件类型-amp-权限" class="headerlink" title="文件类型&amp;权限"></a>文件类型&amp;权限</h2><h3 id="文件类型"><a href="#文件类型" class="headerlink" title="文件类型"></a>文件类型</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">ls</span> -l</span><br>drwxr-xr-x 1 root root    4096 May 21  2019 vmware-tools<br>lrwxrwxrwx 1 root root      23 May 21  2019 vtrgb -&gt; /etc/alternatives/vtrgb<br>-rw-r--r-- 1 root root    4942 Apr  9  2019 wgetrc <br></code></pre></td></tr></table></figure><table><thead><tr><th>第一个字母</th><th></th></tr></thead><tbody><tr><td>-</td><td>普通文件</td></tr><tr><td>d</td><td>目录文件</td></tr><tr><td>c</td><td>字符设备文件，串口，音频等</td></tr><tr><td>b</td><td>块设备文件，U盘，硬盘等</td></tr><tr><td>l</td><td>符号链接</td></tr><tr><td>s</td><td>套接字文件</td></tr><tr><td>p</td><td>管道文件 FIFO</td></tr></tbody></table><h3 id="文件权限"><a href="#文件权限" class="headerlink" title="文件权限"></a>文件权限</h3><p>其后九个字母，每三个为一组。</p><ul><li>第一组表示用户的权限</li><li>第二组表示用户组的权限</li><li>第三组表示其他用户的权限</li></ul><p>列如<code>-rw-r--r-- 1 root root 4942 Apr 9 2019 wgetrc</code></p><ul><li>root用户权限是<code>rw-</code></li><li>root组的权限是<code>r--</code></li><li>其他用户权限是<code>r--</code></li></ul><table><thead><tr><th>字母</th><th>二进制</th><th>值</th><th></th></tr></thead><tbody><tr><td>r</td><td>100</td><td>4</td><td>可读权限: 如果目录没有可读权限,则无法用 ls 等命令查看目录中的文件内容.</td></tr><tr><td>w</td><td>010</td><td>2</td><td>可写权限: 如果目录没有可写权限,则无法在目录中创建文件, 也无法在目录中删除文件.</td></tr><tr><td>x</td><td>001</td><td>1</td><td>可执行权限：如果没有目录可执行权限，则无法 cd 到目录中</td></tr></tbody></table><table><thead><tr><th>字母</th><th>归属</th></tr></thead><tbody><tr><td>a</td><td>all user</td></tr><tr><td>u</td><td>user</td></tr><tr><td>g</td><td>group user</td></tr><tr><td>o</td><td>other user</td></tr></tbody></table><table><thead><tr><th>字母</th><th>操作</th></tr></thead><tbody><tr><td>&#x3D;</td><td>拥有权限</td></tr><tr><td>+</td><td>增加权限</td></tr><tr><td>-</td><td>删除权限</td></tr></tbody></table><h4 id="chmod-文件权限修改"><a href="#chmod-文件权限修改" class="headerlink" title="chmod 文件权限修改"></a>chmod 文件权限修改</h4><p>chmod [参数 ] [文件名 &#x2F;目录名]</p><table><thead><tr><th></th><th>参数</th></tr></thead><tbody><tr><td>-c</td><td>类似-v，回显更改的部分</td></tr><tr><td>-f</td><td>不显示错误信息</td></tr><tr><td>-R</td><td>递归</td></tr><tr><td>-v</td><td>显示执行过程</td></tr><tr><td>-t</td><td>粘滞位</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">修改权限</span> <br><span class="hljs-meta prompt_"># </span><span class="language-bash">test_dir文件夹权限更改为 rwxrwxrwx</span><br>chmod 777 test_dir<br><span class="hljs-meta prompt_"># </span><span class="language-bash">向组用户添加rwx权限</span> <br>chmod g+rwx<br><span class="hljs-meta prompt_"># </span><span class="language-bash">递归更改为rwx权限</span><br>chmod -R 777 test_dir<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">755</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">drwxr-xr-x</span><br></code></pre></td></tr></table></figure><blockquote><p><strong>粘滞位</strong></p><p>other用户可以在特定的目录下创建文件并写入，但是不想让任何人删除掉自己的文件</p></blockquote><h4 id="chown-文件夹归属修改"><a href="#chown-文件夹归属修改" class="headerlink" title="chown 文件夹归属修改"></a>chown 文件夹归属修改</h4><p>chown [参数 ] [用户名 .&lt;组名 &gt;] [文件名 &#x2F;目录 ]</p><table><thead><tr><th></th><th>参数</th></tr></thead><tbody><tr><td>-c</td><td>类似-v，回显更改的部分</td></tr><tr><td>-f</td><td>不显示错误信息</td></tr><tr><td>-h</td><td>只对符号链接修改</td></tr><tr><td>-R</td><td>递归</td></tr><tr><td>-v</td><td>显示执行过程</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">递归修改<span class="hljs-built_in">dir</span>文件夹归属者为 frank</span><br>sudo chown -Rv frank.frank dir/<br></code></pre></td></tr></table></figure><h3 id="文件夹权限"><a href="#文件夹权限" class="headerlink" title="文件夹权限"></a>文件夹权限</h3><ul><li>目录的可执行权限是表示你可否在目录下执行命令。</li><li>如果目录没有 - x 权限，则无法对目录执行任何命令，甚至无法 cd 进入目, 即使目录仍然有 - r 读权限（这个地方很容易犯错，认为有读权限就可以进入目录读取目录下的文件）</li><li>而如果目录具有 - x 权限，但没有 - r 权限，则用户可以执行命令，可以 cd 进入目录。但由于没有目录的读权限</li><li>所以在目录下，即使可以执行 ls 命令，但仍然没有权限读出目录下的文档。</li></ul><h2 id="压缩命令"><a href="#压缩命令" class="headerlink" title="压缩命令"></a>压缩命令</h2><p>zip [参数 ] [压缩文件名.zip] [被压缩的文件]</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>-r</td><td>递归压缩，将指定目录下的所有文件和子一起压缩。</td></tr><tr><td>-v</td><td>显示指令执行过程。</td></tr><tr><td>-num</td><td>压缩率，为 1~9的数值。</td></tr><tr><td>-m</td><td>压缩完成以后删除源文件。</td></tr><tr><td>-g</td><td>将文件压缩入现有压缩文件中，不需要新建。</td></tr><tr><td>-n&lt;字尾符号&gt;</td><td>不压缩特定拓展名文件</td></tr><tr><td>-P</td><td>密码</td></tr></tbody></table><p>unzip [参数 ] [压缩文件名 .zip]</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>-d</td><td>解压到指定目录</td></tr><tr><td>-P</td><td>密码</td></tr><tr><td>-v</td><td>显示指令执行过程。</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">压缩</span><br>zip -rv -9 a.zip *.jpg<br><span class="hljs-meta prompt_"># </span><span class="language-bash">解压</span><br>unzip -d a a.zip<br></code></pre></td></tr></table></figure><p><strong>.bz2 .gz .xz文件</strong></p><p>一般来说<code>bz2</code>的压缩率最高, 但是速度太慢了, <code>gz</code>压缩率比较均衡速度也比较快, <code>tar</code>只会打包不会压缩.</p><p>tar [参数 ] [压缩文件名] [被压缩文件名]</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>-c</td><td><strong>打包(将所有文件变成一个文件 Create a new archive)</strong></td></tr><tr><td>-x</td><td><strong>解压缩, 解包</strong></td></tr><tr><td>-j</td><td>tar生成压缩文件 ，bzip2压缩</td></tr><tr><td>-z</td><td>tar生成压缩文件，gzip压缩</td></tr><tr><td>-f&lt;文件名&gt;</td><td>指定压缩文件</td></tr><tr><td>-v</td><td>显示执行过程</td></tr><tr><td>-C,–directory&#x3D;DIR</td><td>执行任何操作前请先更改为DIR。 该选项是顺序敏感的，即它影响后面的所有选项。</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">压缩 bzip2</span><br>tar -cjvf 1.tar.bz2 *.*<br><span class="hljs-meta prompt_">#</span><span class="language-bash">☆压缩 gzip</span><br>tar -czvf 1.tar.gz *.*<br><span class="hljs-meta prompt_"># </span><span class="language-bash">压缩 = c</span><br>tar -cvf a.tar /etc<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">解压 = x</span><br>tar -jxvf 1.tar.bz2<br>tar -zxvf 1.tar.gz<br><span class="hljs-meta prompt_">#</span><span class="language-bash">tar会自动检测压缩类型，并且解压缩包文件。同样的命令可以用来解压缩使用其他算法，例如：.tar.gz 或者.tar.bz2 压缩的文件。</span><br>tar -v -x -f archive.tar.xz<br>tar -v -x -f archive.tar.xz -C ./dir1<br></code></pre></td></tr></table></figure><h2 id="用户和组-管理"><a href="#用户和组-管理" class="headerlink" title="用户和组 管理"></a>用户和组 管理</h2><h3 id="etc-passwd文件"><a href="#etc-passwd文件" class="headerlink" title="/etc/passwd文件"></a><code>/etc/passwd</code>文件</h3><p>Linux 系统中的 <code>/etc/passwd</code> 文件，是系统用户配置文件，存储了系统中所有用户的基本信息，并且所有用户都可以对此文件执行读操作。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">查看用户和用户组</span><br>sudo cat /etc/passwd<br></code></pre></td></tr></table></figure><p>每行用户信息都以 “：” 作为分隔符，划分为 7 个字段，每个字段所表示的含义如下：</p><blockquote><p><strong>用户名：密码：UID（用户ID）：GID（组ID）：描述性信息：主目录：默认Shell</strong></p></blockquote><p><img src="/2020/d4436089/63d0f703918fa0ece0691081209759ee3c6ddb94.jpg" srcset="/img/loading.gif" lazyload></p><blockquote><p>读者可能会问，Linux 系统中默认怎么会有这么多的用户？这些用户中的绝大多数是系统或服务正常运行所必需的用户，这种用户通常称为系统用户或伪用户。系统用户无法用来登录系统，但也不能删除，因为一旦删除，依赖这些用户运行的服务或程序就不能正常执行，会导致系统问题。</p></blockquote><h4 id="UID-用户ID"><a href="#UID-用户ID" class="headerlink" title="UID 用户ID"></a>UID 用户ID</h4><p>UID，也就是用户 ID。每个用户都有唯一的一个 UID，Linux 系统通过 UID 来识别不同的用户。</p><p>实际上，UID 就是一个 0~65535 之间的数，不同范围的数字表示不同的用户身份，具体如表 1 所示。</p><table><thead><tr><th>UID 范围</th><th>用户身份</th></tr></thead><tbody><tr><td>0</td><td>超级用户。UID 为 0 就代表这个账号是管理员账号。在 Linux 中，如何把普通用户升级成管理员呢？只需把其他用户的 UID 修改为 0 就可以了，这一点和 Windows 是不同的。不过不建议建立多个管理员账号。</td></tr><tr><td>1~499</td><td>系统用户（伪用户）。也就是说，此范围的 UID 保留给系统使用。其中，1<del>99 用于系统自行创建的账号；100</del>499 分配给有系统账号需求的用户。 其实，除了 0 之外，其他的 UID 并无不同，这里只是默认 500 以下的数字给系统作为保留账户，只是一个公认的习惯而已。</td></tr><tr><td>500~65535</td><td>普通用户。通常这些 UID 已经足够用户使用了。但不够用也没关系，2.6.x 内核之后的 Linux 系统已经可以支持 232 个 UID 了。</td></tr></tbody></table><h4 id="GID-组ID"><a href="#GID-组ID" class="headerlink" title="GID 组ID"></a>GID 组ID</h4><p>全称“Group ID”，简称“组ID”，表示用户初始组的组 ID 号。这里需要解释一下初始组和附加组的概念。</p><p>初始组，指用户登陆时就拥有这个用户组的相关权限。每个用户的初始组只能有一个，通常就是将和此用户的用户名相同的组名作为该用户的初始组。比如说，我们手工添加用户 lamp，在建立用户 lamp 的同时，就会建立 lamp 组作为 lamp 用户的初始组。</p><p>附加组，指用户可以加入多个其他的用户组，并拥有这些组的权限。每个用户只能有一个初始组，除初始组外，用户再加入其他的用户组，这些用户组就是这个用户的附加组。附加组可以有多个，而且用户可以有这些附加组的权限。</p><p>举例来说，刚刚的 lamp 用户除属于初始组 lamp 外，我又把它加入了 users 组，那么 lamp 用户同时属于 lamp 组和 users 组，其中 lamp 是初始组，users 是附加组。</p><p>当然，初始组和附加组的身份是可以修改的，但是我们在工作中不修改初始组，只修改附加组，因为修改了初始组有时会让管理员逻辑混乱。</p><p>需要注意的是，在 &#x2F;etc&#x2F;passwd 文件的第四个字段中看到的 ID 是这个用户的初始组。</p><h3 id="etc-shadow-文件"><a href="#etc-shadow-文件" class="headerlink" title="/etc/shadow 文件"></a><code>/etc/shadow</code> 文件</h3><p><code>/etc/shadow</code> 文件，用于存储 Linux 系统中用户的密码信息，又称为“影子文件”。</p><p><a target="_blank" rel="noopener" href="http://c.biancheng.net/view/840.html">参考</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">查看密码文件</span> <br>sudo cat /etc/shadow<br></code></pre></td></tr></table></figure><p>每行用户信息被划分为 9 个字段。每个字段的含义如下(时间的单位是天)：</p><blockquote><p><strong>用户名：加密密码：最后一次修改时间：最小修改时间间隔：密码有效期：密码需要变更前的警告天数：密码过期后的宽限时间：账号失效时间：保留字段</strong></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">frank@ubuntu-hyper:~$ sudo cat /etc/shadow<br>root:!:19361:0:99999:7:::<br>daemon:*:19235:0:99999:7:::<br>...<br>frank:$strstrstrssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss/:19361:0:99999:7:::<br>...<br></code></pre></td></tr></table></figure><h4 id="最后一次修改时间"><a href="#最后一次修改时间" class="headerlink" title="最后一次修改时间"></a>最后一次修改时间</h4><p>此字段表示最后一次修改密码的时间，可是，为什么 root 用户显示的是15775 呢？</p><p>这是因为，Linux 计算日期的时间是以1970 年1 月1 日（UTC&#x2F;GMT的午夜）作为1 不断累加得到的时间，到1971 年1 月1 日，则为366 天。这里显示15775 天，也就是说，此 root 账号在1970 年1 月1 日之后的第15775 天修改的 root 用户密码。</p><p>那么，到底15775 代表的是哪一天呢？可以使用如下命令进行换算：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">frank@ubuntu-hyper:~$ date -d &quot;1970-01-01 19361 days&quot;<br>2023年 01月 04日 星期三 00:00:00 CST<br></code></pre></td></tr></table></figure><p>可以看到，通过以上命令，即可将其换算为我们习惯的系统日期。</p><h3 id="etc-group文件"><a href="#etc-group文件" class="headerlink" title="/etc/group文件"></a><code>/etc/group</code>文件</h3><p>&#x2F;ect&#x2F;group 文件是用户组配置文件，即用户组的所有信息都存放在此文件中。</p><p>此文件是记录组 ID（GID）和组名相对应的文件。前面讲过，etc&#x2F;passwd 文件中每行用户信息的第四个字段记录的是用户的初始组 ID，那么，此 GID 的组名到底是什么呢？就要从 &#x2F;etc&#x2F;group 文件中查找。</p><p>各用户组中，还是以 “：” 作为字段之间的分隔符，分为 4 个字段，每个字段对应的含义为：</p><blockquote><p><strong>组名：密码：GID：该用户组中的用户列表</strong></p></blockquote><h3 id="user用户管理"><a href="#user用户管理" class="headerlink" title="user用户管理"></a>user用户管理</h3><h4 id="su-切换root"><a href="#su-切换root" class="headerlink" title="su 切换root"></a>su 切换root</h4><p>切换成root用户</p><p>“sudo su 用户名 ”即可切换回去</p><p>第一次运行root没有密码需要先设置一个密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs linux">sudo passwd root #输入密码就行了<br></code></pre></td></tr></table></figure><h4 id="查看用户"><a href="#查看用户" class="headerlink" title="查看用户"></a>查看用户</h4><ul><li>cat &#x2F;etc&#x2F;passwd文件就行了</li><li>看第三个参数:500以上的,就是后面建的用户了.其它则为系统的用户</li></ul><h4 id="adduser添加用户-优"><a href="#adduser添加用户-优" class="headerlink" title="adduser添加用户(优)"></a>adduser添加用户(优)</h4><p>添加用户（需要Root权限）</p><p>会自动为创建的用户指定主目录、系统shell版本，会在创建时输入用户密码。</p><h4 id="useradd-添加用户"><a href="#useradd-添加用户" class="headerlink" title="useradd 添加用户"></a>useradd 添加用户</h4><p>需要使用参数选项指定上述基本设置，如果不使用任何参数，则创建的用户无密码、无主目录、没有指定shell版本。</p><h4 id="deluser删除用户"><a href="#deluser删除用户" class="headerlink" title="deluser删除用户"></a>deluser删除用户</h4><p>删除用户（需要Root权限）</p><h4 id="userdel-删除用户"><a href="#userdel-删除用户" class="headerlink" title="userdel  删除用户"></a>userdel 删除用户</h4><h4 id="◬-usermod-修改账号设定"><a href="#◬-usermod-修改账号设定" class="headerlink" title="◬ usermod 修改账号设定"></a><strong>◬ usermod 修改账号设定</strong></h4><p><strong>参数说明</strong>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs shell">  -b, --badnames                allow bad names<br>  -c, --comment 注释            GECOS 字段的新值<br>  -d, --home HOME_DIR           用户的新主目录<br>  -e, --expiredate EXPIRE_DATE  设定帐户过期的日期为 EXPIRE_DATE<br>  -f, --inactive INACTIVE       过期 INACTIVE 天数后，设定密码为失效状态<br>  -g, --gid GROUP               强制使用 GROUP 为新主组<br>◬ -G, --groups GROUPS           新的附加组列表 GROUPS<br>  -a, --append GROUP            将用户追加至上边 -G 中提到的附加组中，<br>                                并不从其它组中删除此用户<br>  -h, --help                    显示此帮助信息并推出<br>  -l, --login LOGIN             新的登录名称<br>  -L, --lock                    锁定用户帐号<br>  -m, --move-home               将家目录内容移至新位置 (仅于 -d 一起使用)<br>  -o, --non-unique              允许使用重复的(非唯一的) UID<br>  -p, --password PASSWORD       将加密过的密码 (PASSWORD) 设为新密码<br>  -R, --root CHROOT_DIR         chroot 到的目录<br>  -P, --prefix PREFIX_DIR       prefix directory where are located the /etc/* files<br>  -s, --shell SHELL             该用户帐号的新登录 shell<br>  -u, --uid UID                 用户帐号的新 UID<br>  -U, --unlock                  解锁用户帐号<br>  -v, --add-subuids FIRST-LAST  添加子 UID 范围<br>  -V, --del-subuids FIRST-LAST  移除子 UID 范围<br>  -w, --add-subgids FIRST-LAST  添加子 GID 范围<br>  -W, --del-subgids FIRST-LAST  移除子 GID 范围<br>  -Z, --selinux-user  SEUSER       用户账户的新 SELinux 用户映射<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">示例</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">将 userA 加入到 groupB 中</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">Note 当时这个权限修改了但是没有生效 可能是要重开 ssh 我当时是重启主机解决的</span><br>usermod -aG userA groupB<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">修改用户说明</span><br>usermod -c &quot;test user&quot; lamp <br></code></pre></td></tr></table></figure><h4 id="passwd-设置修改密码"><a href="#passwd-设置修改密码" class="headerlink" title="passwd 设置修改密码"></a>passwd 设置修改密码</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo passwd root<br></code></pre></td></tr></table></figure><h4 id="id查看用户UID-GID-归属-组"><a href="#id查看用户UID-GID-归属-组" class="headerlink" title="id查看用户UID GID 归属 组"></a>id查看用户UID GID 归属 组</h4><h4 id="groupadd-添加用户组"><a href="#groupadd-添加用户组" class="headerlink" title="groupadd 添加用户组"></a>groupadd 添加用户组</h4><h4 id="groupdel-删除用户组"><a href="#groupdel-删除用户组" class="headerlink" title="groupdel 删除用户组"></a>groupdel 删除用户组</h4><h4 id="groupmod修改用户组信息"><a href="#groupmod修改用户组信息" class="headerlink" title="groupmod修改用户组信息"></a>groupmod修改用户组信息</h4><h3 id="Note"><a href="#Note" class="headerlink" title="Note"></a>Note</h3><h4 id="给用户添加sudo权限-以及免除密码"><a href="#给用户添加sudo权限-以及免除密码" class="headerlink" title="给用户添加sudo权限 以及免除密码"></a>给用户添加sudo权限 以及免除密码</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">将用户添加一个附加sudo群组就好</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">下面有两种方法</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">1 修改group</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">查看sudo群组的<span class="hljs-built_in">id</span></span><br>cat /etc/group | grep &#x27;sudo&#x27;<br><span class="hljs-meta prompt_"># </span><span class="language-bash">给new_username增加一个sudo群组</span><br>usermod -G 27 new_username<br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">id</span>可以看到new_username多了一个群组</span><br>id new_username<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2 修改sudoers</span><br>vim /etc/sudoers<br><span class="hljs-meta prompt_"># </span><span class="language-bash">然后在root ALL=(ALL:ALL) ALL下面添加上：</span> <br>new_username ALL=(ALL:ALL) ALL<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">免除全部密码</span><br>your_user_name ALL=(ALL) NOPASSWD: ALL<br><span class="hljs-meta prompt_"># </span><span class="language-bash">免除部分命令的密码</span><br>your_user_name   ALL= (root) NOPASSWD: /sbin/mount, (root) NOPASSWD: /bin/umount, (root) NOPASSWD: /mnt/mount, (root) NOPASSWD: /bin/rm, (root) NOPASSWD: /usr/bin/make, (root) NOPASSWD: /bin/ln, (root) NOPASSWD: /bin/sh, (root) NOPASSWD: /bin/mv, (root) NOPASSWD: /bin/chown, (root) NOPASSWD: /bin/chgrp, (root) NOPASSWD: /bin/cp, (root) NOPASSWD: /bin/chmod<br></code></pre></td></tr></table></figure><h2 id="ubuntu-apt包管理"><a href="#ubuntu-apt包管理" class="headerlink" title="ubuntu apt包管理"></a>ubuntu apt包管理</h2><h3 id="换源"><a href="#换源" class="headerlink" title="换源"></a>换源</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># 一键更换国内软件源脚本</span><br><span class="hljs-comment"># https://github.com/SuperManito/LinuxMirrors</span><br>bash &lt;(curl -sSL https:<span class="hljs-regexp">//gi</span>tee.com<span class="hljs-regexp">/SuperManito/</span>LinuxMirrors<span class="hljs-regexp">/raw/m</span>ain/ChangeMirrors.sh)<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">源网站list</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">https://www.raspbian.org/RaspbianMirrors</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">examp</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">mirrors.shu.edu.cn/raspbian/raspbian/</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">http://mirrors.aliyun.com/raspbian/raspbian/</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"></span><br><span class="language-bash"></span><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">先备份</span><br>sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak<br><span class="hljs-meta prompt_"># </span><span class="language-bash"></span><br><span class="language-bash">sudo vim /etc/apt/sources.list</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">改成如下 32bit OS</span><br>deb http://mirrors.aliyun.com/raspbian/raspbian/ buster main non-free contrib rpi<br>deb-src http://mirrors.aliyun.com/raspbian/raspbian/ buster main non-free contrib rpi<br><span class="hljs-meta prompt_"># </span><span class="language-bash">64bit OS</span><br>deb https://mirrors.tuna.tsinghua.edu.cn/debian buster main contrib non-free<br>deb https://mirrors.tuna.tsinghua.edu.cn/debian-security/ buster/updates main contrib non-free<br>deb https://mirrors.tuna.tsinghua.edu.cn/debian buster-updates main contrib non-free<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">先备份</span><br>sudo cp /etc/apt/sources.list.d/raspi.list  /etc/apt/sources.list.d/raspi.list.bak<br><span class="hljs-meta prompt_"># </span><span class="language-bash"></span><br><span class="language-bash">sudo nano /etc/apt/sources.list.d/raspi.list</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">改成如下</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">debian 10.x (buster)</span><br>deb http://mirrors.aliyun.com/raspbian/raspbian/ buster main ui<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">or</span> <br>deb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main ui<br><span class="hljs-meta prompt_"># </span><span class="language-bash">debian 11.x (bullseye)</span><br>deb http://mirrors.aliyun.com/raspbian/raspbian/ bullseye main<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">ubuntu 20.04</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">添加阿里源</span><br>deb https://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse<br>deb-src https://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse<br>deb https://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse<br>deb-src https://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse<br>deb https://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse<br>deb-src https://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse<br>deb https://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse<br>deb-src https://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse<br>deb https://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse<br>deb-src https://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span><br>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse<br><span class="hljs-meta prompt_"># </span><span class="language-bash">deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse<br><span class="hljs-meta prompt_"># </span><span class="language-bash">deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse<br><span class="hljs-meta prompt_"># </span><span class="language-bash">deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse<br><span class="hljs-meta prompt_"># </span><span class="language-bash">deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse</span><br></code></pre></td></tr></table></figure><h4 id="换源后出现证书问题"><a href="#换源后出现证书问题" class="headerlink" title="换源后出现证书问题"></a>换源后出现证书问题</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Err:<span class="hljs-number">22</span> https://mirrors.tuna.tsinghua.edu.cn/ubuntu focal <span class="hljs-keyword">Release</span><br>  Certificate verification failed: The certificate <span class="hljs-keyword">is</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">trusted</span>. The certificate chain uses expired certificate.  Could <span class="hljs-keyword">not</span> handshake: Error <span class="hljs-keyword">in</span> the certificate verification. [IP: <span class="hljs-number">101.6</span><span class="hljs-number">.15</span><span class="hljs-number">.130</span> <span class="hljs-number">443</span>]<br># 证书验证失败:证书不受信任。证书链使用过期的证书。无法握手:证书验证中出现错误。<br></code></pre></td></tr></table></figure><p>原因为未安装<code>ca-certificates</code></p><p>可以先使用http代替掉https，然后安装<code>ca-certificates</code>。</p><p>安装 ca-certificates.</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sudo apt-<span class="hljs-built_in">get</span> install ca-certificates<br></code></pre></td></tr></table></figure><p>再次 <code>sudo apt-get update</code> 发现问题已经消失.</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">sudo gpg <span class="hljs-params">--keyserver</span> keyserver.ubuntu.com <span class="hljs-params">--recv</span> 5523BAEEB01FA116 <span class="hljs-string">//</span><span class="hljs-params">(这个公钥根据提示来写的)</span><br><span class="hljs-comment"># eg.</span><br><span class="hljs-comment"># sudo gpg --keyserver keyserver.ubuntu.com --recv 648ACFD622F3D138 0E98404D386FA1D9 DCC9EFBF77E11517 112695A0E562B32A  54404762BBB6E853</span><br> <br>sudo gpg <span class="hljs-params">--export</span> <span class="hljs-params">--armor</span> 5523BAEEB01FA116 | sudo apt-key add -<br><span class="hljs-comment"># eg.</span><br><span class="hljs-comment"># sudo gpg --export --armor 648ACFD622F3D138 0E98404D386FA1D9 DCC9EFBF77E11517 112695A0E562B32A  54404762BBB6E853 | sudo apt-key add -</span><br></code></pre></td></tr></table></figure><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">安装指定版本的包</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">sudo apt-get install package=version</span><br>sudo apt-get install python3=3.7.3-1<br><span class="hljs-meta prompt_"># </span><span class="language-bash">列出所有包 apt-cache madison package</span><br>apt-cache madison python3<br></code></pre></td></tr></table></figure><h3 id="更新源-amp-包"><a href="#更新源-amp-包" class="headerlink" title="更新源&amp;包"></a>更新源&amp;包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">更新源</span><br>sudo apt-get update<br><span class="hljs-meta prompt_"># </span><span class="language-bash">更新软件包</span><br>sudo apt-get upgrade<br></code></pre></td></tr></table></figure><h3 id="卸载包"><a href="#卸载包" class="headerlink" title="卸载包"></a>卸载包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">删除包</span><br>sudo apt-get remove nginx<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">查找 xx 相关软件</span><br>dpkg --get-selections|grep nginx<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">删除包及其配置</span><br>sudo apt-get --purge remove nginx<br>sudo apt-get purge --auto-remove nginx<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">删除不使用的包</span><br>sudo apt-get autoremove<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">清除缓存</span><br>sudo apt-get clean<br></code></pre></td></tr></table></figure><h1 id="linux-进阶"><a href="#linux-进阶" class="headerlink" title="linux 进阶"></a>linux 进阶</h1><h2 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/139381645">https://zhuanlan.zhihu.com/p/139381645</a></p><p><a target="_blank" rel="noopener" href="https://wiki.ubuntu.org.cn/Ufw%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97">https://wiki.ubuntu.org.cn/Ufw%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 安装</span><br>sudo apt-get install ufw<br><span class="hljs-comment"># 启动</span><br>sudo ufw <span class="hljs-built_in">enable</span><br><span class="hljs-comment"># 以下这条命令 我们设置默认的规则为allow， 这样除非指明打开的端口， 否则所有端口默认都是关闭的。</span><br>sudo ufw default deny <br><span class="hljs-comment"># 查看状态</span><br>sudo ufw status <br><br> ufw  [--dry-run]  route [delete] [insert NUM] allow|deny|reject|<span class="hljs-built_in">limit</span> [<span class="hljs-keyword">in</span>|out on  INTERFACE] [<span class="hljs-built_in">log</span>|log-all] [proto PROTOCOL] [from ADDRESS [port PORT]] [to ADDRESS [port PORT]]<br><br>sudo ufw allow 80 允许外部访问80端口<br><span class="hljs-comment"># 这个好像最大一次性只能开一百个</span><br>sudo ufw allow 50000:50100/tcp 允许外部访问端口范围<br><br><span class="hljs-comment"># 允许eth0的所有流量</span><br>sudo ufw allow <span class="hljs-keyword">in</span> on eth0<br><br>sudo ufw delete allow 80 禁止外部访问80 端口<br><br>sudo ufw allow from 192.168.1.1 允许此IP访问所有的本机端口<br><br>sudo ufw deny smtp 禁止外部访问smtp服务<br><br><span class="hljs-comment"># 想要允许连接通过指定网络接口，使用allow in on 和 网络接口的名字：</span><br>sudo ufw allow <span class="hljs-keyword">in</span> on eth2 to any port 3306<br><br>sudo ufw delete allow smtp 删除上面建立的某条规则<br><br><span class="hljs-comment"># 要拒绝所有的TCP流量从10.0.0.0/8 到192.168.0.1地址的22端口</span><br>sudo ufw deny proto tcp from 10.0.0.0/8 to 192.168.0.1 port 22 <br> <br><span class="hljs-comment"># 可以允许所有RFC1918网络（局域网/无线局域网的）访问这个主机（/8,/16,/12是一种网络分级）：</span><br>sudo ufw allow from 10.0.0.0/8<br><br>sudo ufw allow from 172.16.0.0/12<br><br>sudo ufw allow from 192.168.0.0/16<br></code></pre></td></tr></table></figure><h2 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h2><ol><li>echo 查看单个环境变量</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$HOME</span><br></code></pre></td></tr></table></figure><ol start="2"><li>env 查看全部环境变量</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">env</span><br><span class="hljs-built_in">env</span> | grep SSH<br><br><span class="hljs-comment"># export 也可以查看</span><br><span class="hljs-built_in">export</span><br></code></pre></td></tr></table></figure><ol start="3"><li>set 查看本地定义的环境变量</li></ol><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">set</span><br></code></pre></td></tr></table></figure><ol start="4"><li>export 设置一个新的环境变量(临时的，重启后消失)</li></ol><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">HELLO</span>=<span class="hljs-string">&quot;hello&quot;</span><br></code></pre></td></tr></table></figure><ol start="5"><li>unset 清除环境变量</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">unset</span> HELLO<br></code></pre></td></tr></table></figure><ol start="6"><li>readonly 设定只读环境变量</li></ol><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">readonly HELLO<span class="hljs-operator">=</span><span class="hljs-string">&quot;hello&quot;</span><br></code></pre></td></tr></table></figure><ol start="7"><li>添加环境变量</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 将/usr/local/nginx/sbin/目录临时添加到环境变量中</span><br><span class="hljs-built_in">export</span> PATH=/usr/local/nginx/sbin/:<span class="hljs-variable">$PATH</span><br></code></pre></td></tr></table></figure><ol start="8"><li>设定永久环境变量（其实就是<strong>开机</strong>&#x2F;<strong>启动bash</strong>等等这些操作之前会运行一个脚本，我们的思路就是在这个脚本）</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">编辑后面的特定位置的文件  示例是当前用户的bash的启动执行的脚本  如果是其他终端则修改的是对应的脚本  比如zsh 修改的是.zshrc</span><br>vim ~/.bashrc<br><span class="hljs-meta prompt_"># </span><span class="language-bash">加上环境变量</span><br>export DONT_PROMPT_WSL_INSTALL=1<br></code></pre></td></tr></table></figure><h3 id="一些常见环境变量"><a href="#一些常见环境变量" class="headerlink" title="一些常见环境变量"></a>一些常见环境变量</h3><ol><li>PATH：决定了shell将到哪些目录中寻找命令或程序</li><li>HOME：指定用户的主目录（即用户登录到Linux系统时的默认目录）</li><li>HISTSIZE：保存历史命令记录的条数</li><li>LOGNAME：显示当前用户的登录名 （同 指令logname）</li><li>HOSTNAME：显示主机的名字 （同 指令hostname）</li><li>SHELL：指当前用户使用的shell类型</li><li>LANG&#x2F;LANGUGE：语言相关的环境变量，多语言可以修改此环境变量</li></ol><h3 id="环境变量存放的位置"><a href="#环境变量存放的位置" class="headerlink" title="环境变量存放的位置"></a>环境变量存放的位置</h3><ol><li><code>etc/profile</code> （所有用户）</li></ol><p>这个文件是<strong>每个用户登录时都会运行的环境变量设置</strong>，当用户第一次登陆时该文件被执行*(这就是用户启动执行特定程序的原理了)*，并从<code>/etc/profile.d</code>目录的配置文件中搜索shell的设置。这个文件的作用就是当用户登录的时候用于获取系统的环境变量，只在登录的时候获取一次。</p><p>所以说，在<code>/etc/profile</code>文件中添加的变量，<strong>对所有用户永久的生效</strong>。</p><ol start="2"><li><code>~/.bash_profile</code>（单个用户）</li></ol><p><strong>每个用户都可以使用该文件输入自己专用的shell信息，当用户登录时，该文件仅仅执行一次</strong>。默认情况下，它设置一些环境变量，执行用户的.bashrc文件。单个用户对此文件的修改只会影响到它以后的每一次登录。</p><p>也就是说，在用户目录下的.bash_profile文件中增加变量，<strong>仅对当前用户永久生效，</strong> <strong>操作同 &#x2F;etc&#x2F;profile</strong></p><ol start="3"><li><code>/etc/bashrc</code>（所有用户）</li></ol><p>在执行完 &#x2F;etc&#x2F;profile 内容后，如果用户运行 bash shell 的话，则就执行这个文件，当**每次一个新的bash shell 被打开时，该文件被读取**。****所以，如果每打开一个bash都执行某些操作，就可以在这个文件里面设置。</p><ol start="4"><li><code>~/.bashrc</code> （单个用户）</li></ol><p>该文件只包含专用于你的bash信息，<strong>当你登录时以及每次打开新的shell时，该文件就会自动被读取</strong>。</p><ol start="5"><li><code>~/.bash_logout</code><strong>每次在退出shell的时候会执行该文件</strong></li></ol><p><strong>每次在退出shell的时候会执行该文件</strong>，它提供了定制用户环境的功能，比如删除账号内的临时文件等命令就可以放在bash_logout 文件内，如果这个文件不存在的话则就执行其他的命令。</p><h2 id="管道"><a href="#管道" class="headerlink" title="管道"></a>管道</h2><h3 id="xargs"><a href="#xargs" class="headerlink" title="xargs"></a>xargs</h3><p><a target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-comm-xargs.html">https://www.runoob.com/linux/linux-comm-xargs.html</a></p><p>xargs 可以将管道或标准输入（stdin）数据转换成命令行参数，也能够从文件的输出中读取数据。</p><p><strong>命令格式：</strong></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">somecommand |xargs -<span class="hljs-keyword">item</span>  <span class="hljs-keyword">command</span><br></code></pre></td></tr></table></figure><ul><li>-a file 从文件中读入作为 stdin</li><li>-e flag ，注意有的时候可能会是-E，flag必须是一个以空格分隔的标志，当xargs分析到含有flag这个标志的时候就停止。</li><li>-p 当每次执行一个argument的时候询问一次用户。</li><li>-n num 后面加次数，表示命令在执行的时候一次用的argument的个数，默认是用所有的。</li><li>-t 表示先打印命令，然后再执行。</li><li>-i 或者是-I，这得看linux支持了，将xargs的每项名称，一般是一行一行赋值给 {}，可以用 {} 代替。</li><li>-r no-run-if-empty 当xargs的输入为空的时候则停止xargs，不用再去执行了。</li><li>-s num 命令行的最大字符数，指的是 xargs 后面那个命令的最大命令行字符数。</li><li>-L num 从标准输入一次读取 num 行送给 command 命令。</li><li>-l 同 -L。</li><li>-d delim 分隔符，默认的xargs分隔符是回车，argument的分隔符是空格，这里修改的是xargs的分隔符。</li><li>-x exit的意思，主要是配合-s使用。。</li><li>-P 修改最大的进程数，默认是1，为0时候为as many as it can ，这个例子我没有想到，应该平时都用不到的吧。</li></ul><p><strong>Example</strong></p><p>复制所有图片文件到 <code>/data/images</code> 目录下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> *.jpg | xargs -n1 -I &#123;&#125; <span class="hljs-built_in">cp</span> &#123;&#125; /data/images<br></code></pre></td></tr></table></figure><h2 id="inode"><a href="#inode" class="headerlink" title="inode"></a>inode</h2><p>参考:</p><ul><li><p>&lt;鸟哥的linux私房菜&gt; -&gt; 第七章、Linux 磁盘与文件系统管理 -&gt; 7.1.3 Linux 的 EXT2 文件系统（inode）</p></li><li><p><a target="_blank" rel="noopener" href="https://ty-chen.github.io/linux-kernel-fs/">Linux操作系统学习笔记（十一）文件系统</a></p></li></ul><blockquote><p><em>inode(index node)</em> 是 UNIX 操作系统中的一种数据结构，其本质是[<strong>结构体</strong>]，它包含了与文件系统中各个文件相关的一些重要信息。在 UNIX 中创建文件系统时，同时将会创建大量的 inode 。通常，文件系统磁盘空间中大约百分之一空间分配给了 inode 表。</p></blockquote><p><strong>inode主要是记录文件的元信息，比如文件权限信息、文件的大小、文件修改信息、文件位置信息(data block id)等等，我们可以理解为是文件的索引(index)。</strong></p><blockquote><p>如何通过inode找到文件数据的位置?</p><p>ext2文件系统中，inode存在<strong>12个直接指针</strong>，<strong>1个间接指针</strong>(可以理解为指针)，<strong>1个双重间接块指针</strong>(可以理解为指向指针的指针 两重指针)，<strong>1个三重间接块指针</strong>(可以理解为 三重指针)，通过这几个指针的索引我们就能找到对应的文件存放的位置。</p><p><strong>我们假定每个指针占用4Byte的空间，每个Blocks大小为4KB(SSD的4K对齐应该也是指的这个)。</strong></p><ul><li>直接块指针：<ul><li>前12个直接指针，直接指向存储数据的区域。blocks大小为4KB，前12个直接指针就可以保存<strong>48KB</strong>的文件</li></ul></li><li>间接块指针(一级间接快指针)：<ul><li>每个指针占用4Byte，则间接快指针指向的Blocks可以保存(4*1024)&#x2F;4&#x3D;1024个记录(或者称为直接指针)，也就是对应1024个Blocks，那么间接块指针可存储文件数据大小为1024*4KB&#x3D;<strong>4MB</strong></li></ul></li><li>双重间接块指针(二级间接快指针)：<ul><li>同理，双重间接块指针可以储存文件数据大小为1024*1024*4KB&#x3D;<strong>4GB</strong></li></ul></li><li>三重间接块指针(三级间接快指针)：<ul><li>同理，三重间接块指针可以储存文件数据大小为1024*1024*1024*4KB&#x3D;<strong>4TB</strong></li></ul></li></ul></blockquote><p><img src="/2020/d4436089/123.png" srcset="/img/loading.gif" lazyload alt="操作系统：文件系统- 掘金"></p><blockquote><p><strong>弊端</strong></p><p>该存储结构带来的问题是对于大型文件，我们需要多次调用才可以访问对应块的内容，因此访问速度较慢。为此，<strong>ext4</strong>提出了新的解决方案：<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Extent_(file_systems)">Extents</a>。简单的说，<strong>Extents以一个树形结构来连续存储文件块，从而提高访问速度，大致结构如下图所示。</strong></p><p><img src="/2020/d4436089/1-s2.0-S1742287617300270-gr2.jpg" srcset="/img/loading.gif" lazyload alt="AFEIC: Advanced forensic Ext4 inode carving - ScienceDirect"></p></blockquote><blockquote><p><strong>冷知识:</strong></p><p>同一个文件在磁盘上的物理位置可能不会是连续的, 大概率都是分散开的, 散落在磁盘的各个位置.</p><p><img src="/2020/d4436089/image-20230107231700676.png" srcset="/img/loading.gif" lazyload alt="image-20230107231700676"></p></blockquote><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><h4 id="df"><a href="#df" class="headerlink" title="df"></a>df</h4><p>我们可以通过<code>df</code>命令查看所有已挂载的文件系统中已使用的 inode 的数目，以及文件系统中总体使用情况的百分比。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">❯ df -i<br>Filesystem       Inodes   IUsed    IFree IUse% Mounted on<br>/dev/sdc       67108864  556871 66551993    1% /<br></code></pre></td></tr></table></figure><h4 id="stat"><a href="#stat" class="headerlink" title="stat"></a>stat</h4><p>我们可以通过stat命令查看文件(包括目录)的inode信息</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">❯ stat use_proxy.sh<br>  File: use_proxy.sh<br>  Size: 720             Blocks: 8          IO Block: 4096   regular file<br>Device: 820h/2080d      Inode: 552923      Links: 1<br>Access: (0644/-rw-r--r--)  Uid: ( 1000/   frank)   Gid: ( 1000/   frank)<br>Access: 2022-12-11 22:29:33.000000000 +0800<br>Modify: 2022-10-31 17:10:16.000000000 +0800<br>Change: 2022-12-11 22:31:28.141006225 +0800<br> Birth: -<br></code></pre></td></tr></table></figure><h4 id="find"><a href="#find" class="headerlink" title="find"></a>find</h4><p>我们可以通过find命令找特定inode号的文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">根目录的inode号为2</span><br>❯ find / -inum 2<br>/<br><br>❯ ll -li ~<br>total 16K<br>552923 -rw-r--r-- 1 frank frank  720 10月 31 17:10 xxx.sh<br>❯ find ~ -inum 552923<br>/home/frank/xxx.sh<br></code></pre></td></tr></table></figure><h2 id="硬链接-和-软连接-符号链接"><a href="#硬链接-和-软连接-符号链接" class="headerlink" title="硬链接 和 软连接(符号链接)"></a>硬链接 和 软连接(符号链接)</h2><p>参考:<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Peter2014/p/7594504.html">Linux硬链接和软连接的区别与总结</a>,<a target="_blank" rel="noopener" href="https://www.cnblogs.com/sanjun/p/9971993.html">硬链接和软连接（符号链接）的区别</a>,<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/443459832/answer/1723706381">linux中软链接和硬链接是什么意思？</a></p><p>硬链接（Hard Link） 和软链接（Symbolic Link）</p><p><img src="/2020/d4436089/1192583-20170925225909964-1496152149.png" srcset="/img/loading.gif" lazyload alt="img"></p><h3 id="硬链接（Hard-Link）"><a href="#硬链接（Hard-Link）" class="headerlink" title="硬链接（Hard Link）"></a>硬链接（Hard Link）</h3><p>硬链接是多个目录项中的「索引节点」指向一个文件，也就是<strong>指向同一个 inode</strong>，但是 inode 是不可能跨越文件系统的，每个文件系统都有各自的 inode 数据结构和列表，所以硬链接是不可用于跨文件系统的。由于多个目录项都是指向一个 inode，那么只有删除文件的所有硬链接以及源文件时，系统才会彻底删除该文件。</p><p><img src="/2020/d4436089/v2-7cf8cec396a66dca2dd1fcd6dadab537_720w.webp" srcset="/img/loading.gif" lazyload alt="img"></p><blockquote><h3 id="有关硬链接的总结"><a href="#有关硬链接的总结" class="headerlink" title="有关硬链接的总结"></a>有关硬链接的总结</h3><ol><li><strong>不可以在不同文件系统的文件间建立链接</strong>(Inode范围问题)</li><li>只有超级用户才可以为目录创建硬链接。</li><li>具有相同inode节点号的多个文件互为硬链接文件；</li><li>删除硬链接文件或者删除源文件任意之一，文件实体并未被删除；<strong>只有删除了源文件和所有对应的硬链接文件，文件实体才会被删除；</strong></li><li>硬链接文件是文件的另一个入口；</li><li>可以通过给文件设置硬链接文件来防止重要文件被误删；</li><li>创建硬链接命令 ln 源文件 硬链接文件；</li><li>硬链接文件是普通文件，可以用rm删除；</li><li>对于静态文件（没有进程正在调用），当硬链接数为0时文件就被删除。<em>注意：如果有进程正在调用，则无法删除或者即使文件名被删除但空间不会释放。</em></li></ol></blockquote><h3 id="软链接（Symbolic-Link）"><a href="#软链接（Symbolic-Link）" class="headerlink" title="软链接（Symbolic Link）"></a>软链接（Symbolic Link）</h3><p>软链接相当于重新创建一个文件，这个文件<strong>有独立的 inode</strong>，但是这个<strong>文件的内容是另外一个文件的路径</strong>，所以访问软链接的时候，<strong>实际上相当于访问到了另外一个文件</strong>，所以软链接是可以跨文件系统的，甚至目标文件被删除了，链接文件还是在的，只不过指向的文件找不到了而已。</p><p><img src="/2020/d4436089/v2-5606413e1b5d2c727399711d347617a2_720w.webp" srcset="/img/loading.gif" lazyload alt="img"></p><blockquote><h3 id="有关软链接的总结"><a href="#有关软链接的总结" class="headerlink" title="有关软链接的总结"></a>有关软链接的总结</h3><ol><li>软链接类似windows系统的快捷方式；</li><li><strong>软连接的目标文件建议使用绝对路径，否则软连接被移动后将会失效。</strong></li><li><strong>软链接里面存放的是源文件的<em>路径</em>，指向源文件；</strong></li><li>删除源文件，软链接依然存在，但无法访问源文件内容；</li><li>软链接失效时一般是白字红底闪烁；</li><li>软链接和源文件是不同的文件，文件类型也不同，inode号也不同 <strong>是两个不同的文件</strong>；</li><li>软链接的文件类型是“l”，可以用rm删除。</li></ol></blockquote><h3 id="两者区别"><a href="#两者区别" class="headerlink" title="两者区别"></a>两者区别</h3><blockquote><h3 id="硬链接和软链接的区别"><a href="#硬链接和软链接的区别" class="headerlink" title="硬链接和软链接的区别"></a>硬链接和软链接的区别</h3><p>原理上，硬链接和源文件的inode节点号相同，两者互为硬链接。软连接和源文件的inode节点号不同，进而指向的block也不同，软连接block中存放了源文件的路径名。</p><p>实际上，硬链接和源文件是同一份文件，而软连接是独立的文件，类似于快捷方式，存储着源文件的位置信息便于指向。</p><p>使用限制上，不能对目录创建硬链接，不能对不同文件系统创建硬链接，不能对不存在的文件创建硬链接；可以对目录创建软连接，可以跨文件系统创建软连接，可以对不存在的文件创建软连接。</p></blockquote><h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><p><strong>硬链接</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">ls</span> -lhi</span><br>1180598 -rw-rw-r-- 3 frank frank    5 2月  12 22:31 123.txt<br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">stat</span> *.txt</span><br>  文件：123.txt<br>  大小：5               块：8          IO 块：4096   普通文件<br>设备：805h/2053d        Inode：1180598     硬链接：1<br>...<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">使用 <span class="hljs-built_in">ln</span> 命令创建链接 先看看语法</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">ln</span> --<span class="hljs-built_in">help</span></span><br>用法：ln [选项]... 目标... 目录<br>在指定&lt;目录&gt;中创建指向指定&lt;目标&gt;的链接。<br>默认创建硬链接，当使用--symbolic 时创建符号链接。<br>默认情况下，创建每个目标时不应存在与新链接的名称相同的文件。<br>创建硬链接时，每个指定的&lt;目标&gt;都必须存在。符号链接可以指向任意的位置；<br>当链接解析正常时，将其解析为一个相对于其父目录的相对链接。<br>...<br><span class="hljs-meta prompt_"># </span><span class="language-bash">在当前目录下创建一个 硬链接 <span class="hljs-string">&#x27;123.ln.txt&#x27;</span>指向<span class="hljs-string">&#x27;123.txt&#x27;</span></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">ln</span> 123.txt ./123.ln.txt</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">ls</span> -lhi</span><br>1180598 -rw-rw-r-- 3 frank frank    5 2月  12 22:31 123.ln.txt<br>1180598 -rw-rw-r-- 3 frank frank    5 2月  12 22:31 123.txt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">我们可以看到 <span class="hljs-string">&#x27;123.txt&#x27;</span> 和 <span class="hljs-string">&#x27;123.ln.txt&#x27;</span> 的Inode指向同一个位置 自然他们的大小也是一致的</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">并且 <span class="hljs-string">&#x27;硬链接&#x27;</span> 的数目由1变成了2</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">如果 <span class="hljs-built_in">rm</span> 其中一个文件, 只是删除了文件指针文件内容并不会删除, 也就是说只有等到 硬链接 数目变成0了内核才会将文件内容删除</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">stat</span> *.txt</span><br>  文件：123.ln.txt<br>  大小：5               块：8          IO 块：4096   普通文件<br>设备：805h/2053d        Inode：1180598     硬链接：2<br>...<br>  文件：123.txt<br>  大小：5               块：8          IO 块：4096   普通文件<br>设备：805h/2053d        Inode：1180598     硬链接：2<br>...<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">加 -s 参数 创建一个 软链接</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">在当前目录下创建一个 软链接 <span class="hljs-string">&#x27;123.soft.txt&#x27;</span>指向<span class="hljs-string">&#x27;123.txt&#x27;</span></span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">ln</span> -s 123.txt ./123.soft.txt</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">注意看 软件链接 的类型是 l</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">ls</span> -hli</span><br>1180598 -rw-rw-r-- 3 frank frank    5 2月  12 22:31 123.ln.txt<br>1181799 lrwxrwxrwx 1 frank frank    7 2月  12 22:41 123.soft.txt -&gt; 123.txt<br>1180598 -rw-rw-r-- 3 frank frank    5 2月  12 22:31 123.txt<br><span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">stat</span> *.txt</span><br>  文件：123.ln.txt<br>  大小：5               块：8          IO 块：4096   普通文件<br>设备：805h/2053d        Inode：1180598     硬链接：3<br>...<br>  文件：123.soft.txt -&gt; 123.txt<br>  大小：7               块：0          IO 块：4096   符号链接<br>设备：805h/2053d        Inode：1181799     硬链接：1<br>...<br>  文件：123.txt<br>  大小：5               块：8          IO 块：4096   普通文件<br>设备：805h/2053d        Inode：1180598     硬链接：3<br>...<br></code></pre></td></tr></table></figure><h1 id="linux-常用命令"><a href="#linux-常用命令" class="headerlink" title="linux 常用命令"></a>linux 常用命令</h1><blockquote><p><span style="color:red">TODO 将这些命令进行分类！</span></p></blockquote><p>查看支持的shell</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">cat <span class="hljs-regexp">/etc/</span>shells<br></code></pre></td></tr></table></figure><p>查看当前使用哪个shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$SHELL</span><br></code></pre></td></tr></table></figure><p>更改用户的默认shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chsh -s /bin/zsh  [用户名:模认当前用户]<br></code></pre></td></tr></table></figure><h3 id="alias-起别名"><a href="#alias-起别名" class="headerlink" title="alias 起别名"></a>alias 起别名</h3><p><strong>命名别名</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">起别名</span><br>alias 别名=“路径” <br><span class="hljs-meta prompt_"># </span><span class="language-bash">取消别名</span><br>unalias 别名  <br><span class="hljs-meta prompt_"># </span><span class="language-bash">查看命令类型</span><br>type -a ls  <br></code></pre></td></tr></table></figure><p><strong>别名优先级最高</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">别名优先</span><br>ls<br><span class="hljs-meta prompt_"># </span><span class="language-bash">跳过别名</span><br>\ls<br>&quot;ls&quot;<br>&#x27;ls&#x27;<br></code></pre></td></tr></table></figure><h3 id="ls-list-file"><a href="#ls-list-file" class="headerlink" title="ls list file"></a>ls list file</h3><ul><li><p>ls -l 显示文件的详细信息，文件目录具有的权限，当前权限文件的数量，拥有者，所属的群组，文件目录的大小，创建或者修改时间，文件目录的名字。可以使用ls -la</p></li><li><p>ls -R 递归列出目录所有文件</p></li><li><p>ls -a 显示所有文件以及子目录，包括“.”开头的隐藏文件</p></li><li></li></ul><h3 id="cd"><a href="#cd" class="headerlink" title="cd"></a>cd</h3><ul><li>cd &#x2F; 进入根目录</li><li>cd .. 返回上一级</li><li>cd ~ 返回当前用户主目录</li></ul><h3 id="pwd显示路径"><a href="#pwd显示路径" class="headerlink" title="pwd显示路径"></a>pwd显示路径</h3><p>显示当前文件目录的绝对路径</p><h3 id="uname系统信息查看"><a href="#uname系统信息查看" class="headerlink" title="uname系统信息查看"></a>uname系统信息查看</h3><ul><li>-r 列出当前系统的具体内核版本号。</li><li>-s 列出系统内核名称。</li><li>-o 列出系统信息。</li></ul><ul><li><strong>ubuntu版本查看</strong></li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">cat <span class="hljs-regexp">/etc/</span>lsb-release<br>lsb_release -a<br></code></pre></td></tr></table></figure><h3 id="clear清屏"><a href="#clear清屏" class="headerlink" title="clear清屏"></a>clear清屏</h3><p>快捷键 <strong>Ctrl+l(小写的L)</strong> 同clear</p><h3 id="sudo"><a href="#sudo" class="headerlink" title="sudo"></a>sudo</h3><p>暂时提升到root权限</p><p>su可以直接变成管理员</p><ul><li>-h help</li><li>-p 改变询问密码的提示符（不知道是啥）</li></ul><h3 id="wc-WordCount"><a href="#wc-WordCount" class="headerlink" title="wc WordCount"></a>wc WordCount</h3><blockquote><p>用法</p><ul><li><code>wc -l &lt;文件名&gt;</code> 输出行数统计</li><li><code>wc -c &lt;文件名&gt;</code> 输出字节数统计</li><li><code>wc -m &lt;文件名&gt;</code> 输出字符数统计</li><li><code>wc -L &lt;文件名&gt;</code> 输出文件中最长一行的长度</li><li><code>wc -w &lt;file name&gt;</code> 显示一个文件的字数</li></ul></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-built_in">wc</span> 123.txt</span><br>   7   11   117  123.txt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">依次是</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">行数 单词数 字节数 文件名称。</span><br></code></pre></td></tr></table></figure><h3 id="cat-文本输出命令"><a href="#cat-文本输出命令" class="headerlink" title="cat  文本输出命令"></a>cat 文本输出命令</h3><p>-n 由1开始对所有行进行编号</p><p>-b 类似-n不对空行编号</p><p>-s 遇到两行空行以上时合并成一个空行</p><h3 id="ifconfig-显示网络配置"><a href="#ifconfig-显示网络配置" class="headerlink" title="ifconfig  显示网络配置"></a>ifconfig 显示网络配置</h3><ul><li>sudo ifconfig ens33 192.168.128.128 修改ip</li></ul><h3 id="man-系统帮助-查命令"><a href="#man-系统帮助-查命令" class="headerlink" title="man 系统帮助-查命令"></a>man 系统帮助-查命令</h3><h3 id="reboot-重启"><a href="#reboot-重启" class="headerlink" title="reboot  重启"></a>reboot 重启</h3><h3 id="poweroff-关机"><a href="#poweroff-关机" class="headerlink" title="poweroff 关机"></a>poweroff 关机</h3><h3 id="install-安装软件命令"><a href="#install-安装软件命令" class="headerlink" title="install 安装软件命令"></a>install 安装软件命令</h3><h3 id="apt-get"><a href="#apt-get" class="headerlink" title="apt-get"></a>apt-get</h3><p>APT工具可以实现软件的自动下载、配置、安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">查找有哪些版本</span><br>apt-cache madison &lt;&lt;package name&gt;&gt;<br><span class="hljs-meta prompt_"># </span><span class="language-bash">安装指定版本</span><br>apt-get install &lt;&lt;package name&gt;&gt;=&lt;&lt;version&gt;&gt;<br></code></pre></td></tr></table></figure><h3 id="fdisk-磁盘工具"><a href="#fdisk-磁盘工具" class="headerlink" title="fdisk 磁盘工具"></a>fdisk 磁盘工具</h3><p><a id="fdisk">linux  磁盘管理 fdisk</a></p><blockquote><p>Linux fdisk 是一个创建和维护分区表的程序，它兼容 DOS 类型的分区表、BSD 或者 SUN 类型的磁盘列表。</p><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">fdisk <span class="hljs-selector-attr">[必要参数]</span><span class="hljs-selector-attr">[选择参数]</span><br></code></pre></td></tr></table></figure><p><strong>必要参数：</strong></p><ul><li>-l 列出素所有分区表</li><li>-u 与 <strong>-l</strong> 搭配使用，显示分区数目</li></ul><p><strong>选择参数：</strong></p><ul><li>-s&lt;分区编号&gt; 指定分区</li><li>-v 版本信息</li></ul><p><strong>菜单操作说明</strong></p><ul><li>m ：显示菜单和帮助信息</li><li>a ：活动分区标记&#x2F;引导分区</li><li>d ：删除分区</li><li>l ：显示分区类型</li><li>n ：新建分区</li><li>p ：显示分区信息</li><li>q ：退出不保存</li><li>t ：设置分区号</li><li>v ：进行分区检查</li><li>w ：保存修改</li><li>x ：扩展应用，高级功能</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">sudo fdisk /dev/sdb</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">查看帮助</span><br><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">m</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">删除分区</span><br><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">d</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">新建分区</span><br><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">n</span> <br><span class="hljs-meta prompt_"># </span><span class="language-bash">写入分区表</span><br><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">w</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">这个时候虽然分区分好了但是还不能使用, 因为没有分配文件系统</span><br><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">mkfs</span><br></code></pre></td></tr></table></figure></blockquote><h3 id="mkfs-格式化-建立文件系统"><a href="#mkfs-格式化-建立文件系统" class="headerlink" title="mkfs 格式化(建立文件系统)"></a>mkfs 格式化(建立文件系统)</h3><p><a id="mkfs">linux 构造文件系统 mkfs</a></p><p>Linux mkfs（英文全拼：make file system）命令用于在特定的分区上建立 linux 文件系统。</p><blockquote><p><strong>使用方式</strong> :</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkfs [-V] [-t fstype] [fs-options] filesys [blocks]<br></code></pre></td></tr></table></figure><p><strong>参数</strong> ：</p><ul><li>选项：</li><li>-t, –type&#x3D;&lt;类型&gt; 文件系统类型；若不指定，将使用 ext2<br>fs-options 实际文件系统构建程序的参数<br>&lt;设备&gt; 要使用设备的路径<br>&lt;大小&gt; 要使用设备上的块数</li><li>-V, –verbose 解释正在进行的操作；<br>多次指定 -V 将导致空运行(dry-run)</li><li>-h, –help display this help</li><li>-V, –version display version</li></ul><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>将sda6分区格式化为ext3格式</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkfs -t ext3 /dev/sda6  <br></code></pre></td></tr></table></figure><p><strong>注意</strong>：这里的文件系统是要指定的，比如 ext3 ；reiserfs ；ext2 ；fat32 ；msdos 等。</p></blockquote><h3 id="df-磁盘信息"><a href="#df-磁盘信息" class="headerlink" title="df 磁盘信息"></a>df 磁盘信息</h3><p>disk free</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">df -h<br></code></pre></td></tr></table></figure><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>-h</td><td>可读显示</td></tr><tr><td>-a</td><td>all</td></tr><tr><td>-l</td><td>本地文件系统</td></tr><tr><td>-T</td><td>Type 文件系统类型</td></tr></tbody></table><h3 id="du-磁盘使用分析"><a href="#du-磁盘使用分析" class="headerlink" title="du 磁盘使用分析"></a>du 磁盘使用分析</h3><p>disk usaged</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">du</span> --max-depth=1 -BM | <span class="hljs-built_in">sort</span> -rn<br></code></pre></td></tr></table></figure><blockquote><p>-h：以人类可读的方式显示。<br>-a：显示目录占用的磁盘空间大小，还要显示其下目录和文件占用磁盘空间的大小。<br>-s：只显示<strong>目录占用的磁盘空间</strong>大小，<strong>不显示其子目录和文件</strong>占用的磁盘空间大小。<br>-c：显示几个<strong>目录或文件占用的磁盘</strong>空间大小，还要统计它们的总和。<br>–apparent-size：显示<strong>目录或文件自身的大小</strong>。<br>-l ：统计硬链接占用磁盘空间的大小。<br>-L：统计符号链接所指向的文件占用的磁盘空间大小。</p><p>-B: 单位修改 -BM &#x3D; 用MB -BG&#x3D;用GB</p><p>–max-depth: –max-depth&#x3D;1列出目录的深度为1</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ** du命令还可以对结果进行排序，以方便快速找出占用空间最多目录。 **</span><br><br><span class="hljs-built_in">du</span> -s 目录 | <span class="hljs-built_in">sort</span> -rn        <span class="hljs-comment">#这是按字节排序</span><br><span class="hljs-built_in">du</span> -sh 目录 | <span class="hljs-built_in">sort</span> -rn        <span class="hljs-comment">#这是按兆（M）来排序</span><br><span class="hljs-comment">#由于-sh大小显示看起来是乱的，因此建议使用du -s|sort -nr</span><br><span class="hljs-built_in">du</span> -s 目录 | <span class="hljs-built_in">sort</span> -rn | <span class="hljs-built_in">head</span>        <span class="hljs-comment">#选出排在前面的10个</span><br><span class="hljs-built_in">du</span> -s 目录 | <span class="hljs-built_in">sort</span> -rn | <span class="hljs-built_in">tail</span>        <span class="hljs-comment">#选出排在后面的10个</span><br><br><span class="hljs-comment"># ** 统计总数大小 **</span><br><span class="hljs-built_in">du</span> -sh xmldb/<br><span class="hljs-built_in">du</span> -sm * | <span class="hljs-built_in">sort</span> -n //统计当前目录大小 并安大小 排序<br><span class="hljs-built_in">du</span> -sk * | <span class="hljs-built_in">sort</span> -n<br><span class="hljs-built_in">du</span> -sk * | grep guojf //看一个人的大小<br><span class="hljs-built_in">du</span> -m | <span class="hljs-built_in">cut</span> -d <span class="hljs-string">&quot;/&quot;</span> -f 2 //看第二个/ 字符前的文字<br><br><span class="hljs-comment"># ** 查看此文件夹有多少文件 /*/*/* 有多少文件 **</span><br><span class="hljs-built_in">du</span> xmldb/<br><span class="hljs-built_in">du</span> xmldb/*/*/* |<span class="hljs-built_in">wc</span> -l<br><span class="hljs-comment"># wc [-lmw]说明</span><br><span class="hljs-comment"># 参数说明：-l :多少行;  -m:多少字符;　-w:多少字</span><br></code></pre></td></tr></table></figure><h3 id="touch-创建新文件"><a href="#touch-创建新文件" class="headerlink" title="touch 创建新文件"></a>touch 创建新文件</h3><h3 id="mkdir-创建文件夹"><a href="#mkdir-创建文件夹" class="headerlink" title="mkdir 创建文件夹"></a>mkdir 创建文件夹</h3><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>-p</td><td>递归创建, 前面的不存在, 就会创建</td></tr></tbody></table><h3 id="rmdir-删除文件夹"><a href="#rmdir-删除文件夹" class="headerlink" title="rmdir 删除文件夹"></a>rmdir 删除文件夹</h3><h3 id="rm-删除"><a href="#rm-删除" class="headerlink" title="rm 删除"></a>rm 删除</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 删除folder文件之外的所有文件</span><br><span class="hljs-built_in">rm</span> -rf !(folder)<br><span class="hljs-comment">#删除folder1和folder2文件之外的所有文件</span><br><span class="hljs-built_in">rm</span> -rf !(folder1 | folder2) <br><span class="hljs-comment">#删除keep文件之外的所有文件</span><br><span class="hljs-built_in">ls</span> | grep -v keep | xargs <span class="hljs-built_in">rm</span> <br><span class="hljs-comment"># 说明： ls先得到当前的所有文件和文件夹的名字， grep -v keep，进行grep正则匹配查找keep，-v参数决定了结果为匹配之外的结果，也就是的到了keep之外的所有文件名，然后 xargs用于从 标准输入获得参数 并且传递给后面的命令，这里使用的命令是 rm，然后由rm删除前面选择的文件。</span><br><br></code></pre></td></tr></table></figure><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>-d</td><td>直接把要删除的目录硬连数据成 0 ，删除该目录。</td></tr><tr><td>-f</td><td>直接把要删除的目录硬连数据成 0 ，删除该目录。</td></tr><tr><td>-i</td><td>删除文件或者夹 (目录 )之前先询问用户。</td></tr><tr><td>-r</td><td>递归删除，指定文件夹 (目录 )下的所有文件和子夹全部删除掉。</td></tr><tr><td>-v</td><td>显示删除过程。</td></tr></tbody></table><h3 id="cp-复制"><a href="#cp-复制" class="headerlink" title="cp 复制"></a>cp 复制</h3><p>cp [参数 ] [源地址 ] [目的地址 ]</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>-r</td><td>递归处理，指定目录下一并处理</td></tr><tr><td>-f</td><td>强行复制文件，不管要的是否已经存在于目标录。</td></tr></tbody></table><h3 id="mv-文件移动-重命名"><a href="#mv-文件移动-重命名" class="headerlink" title="mv 文件移动 重命名"></a>mv 文件移动 重命名</h3><p>mv [参数 ] [源地址 ] [目的地址 ]</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>-b</td><td>如果要覆盖文件的话前先进行备份。</td></tr><tr><td>-f</td><td>若目标文件或录与现在的重复，直接覆盖。</td></tr><tr><td>-I</td><td>在覆盖之前询问用户。</td></tr></tbody></table><h3 id="find-查找"><a href="#find-查找" class="headerlink" title="find 查找"></a>find 查找</h3><p>find [路径 ] [参数 ] [关键字 ]</p><ul><li>-name&lt;filename&gt; 按照文件名称查找，与 filename匹配的文件，可使用通符。</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">find /etc -name *.config<br></code></pre></td></tr></table></figure><h3 id="grep-文件中搜内容"><a href="#grep-文件中搜内容" class="headerlink" title="grep 文件中搜内容"></a>grep 文件中搜内容</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">grep -r -i code<br></code></pre></td></tr></table></figure><p>Linux grep 命令用于查找文件里符合条件的字符串。</p><p>grep 指令用于查找内容包含指定的范本样式的文件，如果发现某文件的内容符合所指定的范本样式，预设 grep 指令会把含有范本样式的那一列显示出来。若不指定任何文件名称，或是所给予的文件名为 **-**，则 grep 指令会从标准输入设备读取数据。</p><h4 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h4><ul><li><strong>-B&lt;显示行数&gt; 或 –before-context&#x3D;&lt;显示行数&gt;</strong> : 除了显示符合样式的那一行之外，并显示该行之前的内容。</li><li><strong>-C&lt;显示行数&gt; 或 –context&#x3D;&lt;显示行数&gt;或-&lt;显示行数&gt;</strong> : 除了显示符合样式的那一行之外，并显示该行之前后的内容。</li><li><strong>-d &lt;动作&gt; 或 –directories&#x3D;&lt;动作&gt;</strong> : 当指定要查找的是目录而非文件时，必须使用这项参数，否则grep指令将回报信息并停止动作。</li><li><strong>-n 或 –line-number</strong> : 在显示符合样式的那一行之前，标示出该行的列数编号。</li><li><strong>-r 或 –recursive</strong> : 此参数的效果和指定”-d recurse”参数相同。</li><li><strong>-i 或 –ignore-case</strong> : 忽略字符大小写的差别。</li><li><strong>-v 或 –invert-match</strong> : 显示不包含匹配文本的所有行。</li></ul><p>我们可以通过管道操作来让grep变得更强大，管道操作就是把前面一条命令的输出作为后面一条命令的输入，从而把很多简单的命令组合起来完成复杂的功能。例如，如果我们想查找包含apple的行，但又想过滤掉pineapple，可以用下面的命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">grep apple fruitlist.txt | grep -v pineapple<br></code></pre></td></tr></table></figure><p>如果我们想把搜索结果保存起来，那么可以把命令的标准输出重定向到文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">grep apple fruitlist.txt | grep -v pineapple &gt; apples.txt<br></code></pre></td></tr></table></figure><p>重定向符号&gt;和管道操作符号|的区别是，重定向后面接的是一个文件，它后面不能再接任何文件或命令了；而管道操作后面接的是命令，可以无限地接下去。如果想以追加方式写到文件，可以用&gt;&gt;。管道操作是Linux命令行的一种哲学，它是计算机技术中少有的能沿用几十年的技术之一。通过管道操作，一行命令可以完成Windows下上千行程序也不能完成的文本处理功能。</p><p>grep [参数 ] 关键字 文件列表</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>-i</td><td>无视大小写</td></tr><tr><td>-r</td><td>递归查找</td></tr><tr><td>-v</td><td>反转，只显示不匹配</td></tr><tr><td>-w</td><td>全匹配 match whole word</td></tr><tr><td>–exclude-dir</td><td>排除文件夹</td></tr><tr><td>–exclude</td><td>排除文件</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">grep -ir &quot;ubuntu&quot; /etc<br><span class="hljs-meta prompt_"># </span><span class="language-bash">注意 如果 <span class="hljs-string">&quot;双引号内带有--&quot;</span> 可能会有不可预知的情况</span> <br><span class="hljs-meta prompt_"># </span><span class="language-bash">grep -ir <span class="hljs-string">&quot;--ubuntu&quot;</span> /etc 这种写法会出问题</span><br><br>grep -ir &quot;Application_Initialize&quot; /a_usr/rosemaryCR/mikan/ --exclude-dir=out<br>grep -ir &quot;CARRIER_HOME_REVERSAL&quot; ./ --exclude=GRTAGS --exclude=mechapi.c<br></code></pre></td></tr></table></figure><h3 id="grep-搜索正则表达式并列出"><a href="#grep-搜索正则表达式并列出" class="headerlink" title="grep 搜索正则表达式并列出"></a>grep 搜索正则表达式并列出</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">| grep 22</span><br>sudo netstat -ntlp | grep 22<br>sudo apt list | grep php<br></code></pre></td></tr></table></figure><h3 id="pwd"><a href="#pwd" class="headerlink" title="pwd"></a>pwd</h3><p>print work directory 输出当前目录</p><h3 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h3><p>在当前命令窗口输出文件</p><h3 id="nano"><a href="#nano" class="headerlink" title="nano"></a>nano</h3><p>文本编辑器</p><h3 id="mount-unmount-挂载卸载"><a href="#mount-unmount-挂载卸载" class="headerlink" title="mount unmount 挂载卸载"></a>mount unmount 挂载卸载</h3><p><a id="mount">linux 挂载 mount</a></p><h4 id="mount-挂载"><a href="#mount-挂载" class="headerlink" title="mount 挂载"></a>mount 挂载</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">需要先创建一个挂载点</span><br>sudo mkdir /mnt/usb<br><span class="hljs-meta prompt_"># </span><span class="language-bash">挂载</span><br>sudo mount /dev/sda1 /mnt/usb<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">mount 中文乱码</span><br>sudo mount -o iocharset=utf8 /dev/sda1 /mnt/usb<br></code></pre></td></tr></table></figure><h4 id="umount-卸载"><a href="#umount-卸载" class="headerlink" title="umount 卸载"></a>umount 卸载</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">卸载</span><br>sudo umount /mnt/usb<br><span class="hljs-meta prompt_"># </span><span class="language-bash">卸载的时候出错注意是不是文件夹正在使用中</span><br></code></pre></td></tr></table></figure><h4 id="树莓派自动挂载"><a href="#树莓派自动挂载" class="headerlink" title="树莓派自动挂载"></a>树莓派自动挂载</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">打开文件 添加以下 这个带有超时,可以避免拔掉U盘开不了机</span><br>sudo nano /etc/fstab<br><span class="hljs-meta prompt_"># </span><span class="language-bash">/dev/sda1 /mnt/usb    auto     defaults,nofail,x-systemd.device-timeout=1,noatime  0   0</span><br></code></pre></td></tr></table></figure><h3 id="mkdir-创建文件夹-1"><a href="#mkdir-创建文件夹-1" class="headerlink" title="mkdir 创建文件夹"></a>mkdir 创建文件夹</h3><h3 id="rmdir-删除文件夹-1"><a href="#rmdir-删除文件夹-1" class="headerlink" title="rmdir 删除文件夹"></a>rmdir 删除文件夹</h3><h3 id="rm-rf"><a href="#rm-rf" class="headerlink" title="rm -rf"></a>rm -rf</h3><p><strong>功能说明：删除文件或目录。</strong></p><p>语法：rm [-dfirv][–help][–version][文件或目录]</p><p>补充说明：执行rm指令可删除文件或目录，如欲删除目录必须加上参数”-r”，否则预设仅会删除文件。</p><p>参数：</p><ul><li><p>-d 或 –directory 　直接把欲删除的目录的硬连接数据删成0，删除该目录。</p></li><li><p>-f 或 –force 　强制删除文件或目录。</p></li><li><p>-i 或 –interactive 　删除既有文件或目录之前先询问用户。</p></li><li><p>-r 或 -R 或 –recursive 　递归处理，将指定目录下的所有文件及子目录一并处理。</p></li><li><p>-v 或 –verbose 　显示指令执行过程。</p></li></ul><h3 id="netstat-列出网络"><a href="#netstat-列出网络" class="headerlink" title="netstat 列出网络"></a>netstat 列出网络</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">列出所有</span><br>sudo netstat -ntlp<br><span class="hljs-meta prompt_"># </span><span class="language-bash">查找</span><br>netstat -ntlp | grep 80<br></code></pre></td></tr></table></figure><h3 id="ln-文件夹链接"><a href="#ln-文件夹链接" class="headerlink" title="ln 文件夹链接"></a>ln 文件夹链接</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">软链接 现有a 链接到b(没有的,目标的)</span><br>ln -s a b<br></code></pre></td></tr></table></figure><h3 id="dd"><a href="#dd" class="headerlink" title="dd"></a>dd</h3><h4 id="dd-进行测速"><a href="#dd-进行测速" class="headerlink" title="dd 进行测速"></a>dd 进行测速</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">以下两条Shell分别测试写入和读取1G的文件从/mnt/usb/目录，就是U盘的挂载点（硬盘测试也可以这样）：</span><br><br>time dd if=/dev/zero of=/mnt/usb/1g bs=1024 count=1000000<br>time dd if=/mnt/usb/1g bs=128k | dd of=/dev/null<br></code></pre></td></tr></table></figure><h3 id="source-刷新环境变量"><a href="#source-刷新环境变量" class="headerlink" title="source 刷新环境变量"></a>source 刷新环境变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 刷新环境变量</span><br><span class="hljs-built_in">source</span> ~/.profile<br><span class="hljs-built_in">source</span> 后面接文件<br></code></pre></td></tr></table></figure><h3 id="tail-循环读取log"><a href="#tail-循环读取log" class="headerlink" title="tail 循环读取log"></a>tail 循环读取log</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">tail</span> -f filename<br></code></pre></td></tr></table></figure><h3 id="file-辨识文件类型"><a href="#file-辨识文件类型" class="headerlink" title="file 辨识文件类型"></a>file 辨识文件类型</h3><blockquote><h3 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">file <span class="hljs-selector-attr">[-bcLvz]</span><span class="hljs-selector-attr">[-f &lt;名称文件&gt;]</span><span class="hljs-selector-attr">[-m &lt;魔法数字文件&gt;...]</span><span class="hljs-selector-attr">[文件或目录...]</span><br></code></pre></td></tr></table></figure><p><strong>参数</strong>：</p><ul><li>-b 　列出辨识结果时，不显示文件名称。</li><li>-c 　详细显示指令执行过程，便于排错或分析程序执行的情形。</li><li>-f&lt;名称文件&gt; 　指定名称文件，其内容有一个或多个文件名称时，让file依序辨识这些文件，格式为每列一个文件名称。</li><li>-L 　直接显示符号连接所指向的文件的类别。</li><li>-m&lt;魔法数字文件&gt; 　指定魔法数字文件。</li><li>-v 　显示版本信息。</li><li>-z 　尝试去解读压缩文件的内容。</li><li>[文件或目录…] 要确定类型的文件列表，多个文件之间使用空格分开，可以使用shell通配符匹配多个文件。</li></ul></blockquote><h3 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h3><p><strong>-x</strong></p><p>每次访问时都需要写代理参数</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -x socks5://127.0.0.1:1024 http://www.google.com <span class="hljs-comment"># -x 参数等同于 --proxy</span><br></code></pre></td></tr></table></figure><p><strong>-v</strong></p><p><code>curl -v</code>参数会输出请求中访问的路由信息，方便确定是否设置成功，请求有没有代理</p><p><strong>-w</strong></p><p>[使用 curl 测试网站加载速度](##使用 curl 测试网站加载速度)</p><p>该选项在请求结束之后打印本次请求的统计数据到标准输出。</p><blockquote><p>首先，我们定义控制打印行为的格式化字符串。新建文本文件 <code>fmt.txt</code>，并填入下面的内容：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ruby">\n<br><span class="hljs-title class_">Response</span> <span class="hljs-title class_">Time</span> <span class="hljs-symbol">for:</span> <span class="hljs-string">%&#123;url_effective&#125;</span>\n\n<br><span class="hljs-variable constant_">DNS</span> <span class="hljs-title class_">Lookup</span> <span class="hljs-title class_">Time</span><span class="hljs-symbol">:</span>\t\t<span class="hljs-string">%&#123;time_namelookup&#125;</span>s\n<br><span class="hljs-title class_">Redirection</span> <span class="hljs-title class_">Time</span><span class="hljs-symbol">:</span>\t\t<span class="hljs-string">%&#123;time_redirect&#125;</span>s\n<br><span class="hljs-title class_">Connection</span> <span class="hljs-title class_">Time</span><span class="hljs-symbol">:</span>\t\t<span class="hljs-string">%&#123;time_connect&#125;</span>s\n<br><span class="hljs-title class_">App</span> <span class="hljs-title class_">Connection</span> <span class="hljs-title class_">Time</span><span class="hljs-symbol">:</span>\t\t<span class="hljs-string">%&#123;time_appconnect&#125;</span>s\n<br><span class="hljs-title class_">Pre</span>-transfer <span class="hljs-title class_">Time</span><span class="hljs-symbol">:</span>\t\t<span class="hljs-string">%&#123;time_pretransfer&#125;</span>s\n<br><span class="hljs-title class_">Start</span>-transfer <span class="hljs-title class_">Time</span><span class="hljs-symbol">:</span>\t\t<span class="hljs-string">%&#123;time_starttransfer&#125;</span>s\n\n<br><span class="hljs-title class_">Total</span> <span class="hljs-title class_">Time</span><span class="hljs-symbol">:</span>\t\t\t<span class="hljs-string">%&#123;time_total&#125;</span>s\n<br></code></pre></td></tr></table></figure><p>curl 提供了很多置换变量，可以在格式化字符串中通过 <code>%&#123;var&#125;</code> 的形式使用。完整的变量列表可以在 curl 的 manpage 中查看。简单介绍一下我们使用的这几个变量：</p><ul><li><code>url_effective</code>: 执行完地址重定向之后的最终 URL；</li><li><code>time_namelookup</code>: 从请求开始至完成名称解析所花的时间，单位为秒，下同；</li><li><code>time_redirect</code>: 执行所有重定向所花的时间；</li><li><code>time_connect</code>: 从请求开始至建立 TCP 连接所花的时间；</li><li><code>time_appconnect</code>: 从请求开始至完成 SSL&#x2F;SSH 握手所花的时间；</li><li><code>time_pretransfer</code>: 从请求开始至服务器准备传送文件所花的时间，包含了传送协商时间；</li><li><code>time_starttransfer</code>: 从请求开始至服务器准备传送第一个字节所花的时间；</li><li><code>time_total</code>: 完整耗时。</li></ul><p>然后执行请求，通过 <code>@filename</code> 指定保存了格式化字符串的文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">curl -L -s -w @fmt.txt -o /dev/null http://www.google.com</span><br></code></pre></td></tr></table></figure><p>输出：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp">Response Time <span class="hljs-keyword">for</span>: http:<span class="hljs-comment">//www.google.co.jp/?gfe_rd=cr&amp;dcr=0&amp;ei=cjIaWpTkHeiQ8QfnxYzoBA</span><br><br>DNS Lookup Time:        <span class="hljs-number">0.000038</span>s<br>Redirection Time:       <span class="hljs-number">0.207271</span>s<br>Connection Time:        <span class="hljs-number">0.000039</span>s<br>App Connection Time:    <span class="hljs-number">0.000039</span>s<br>Pre-transfer Time:      <span class="hljs-number">0.000067</span>s<br>Start-transfer Time:    <span class="hljs-number">0.260115</span>s<br><br>Total Time:             <span class="hljs-number">0.467691</span>s<br></code></pre></td></tr></table></figure></blockquote><h3 id="type"><a href="#type" class="headerlink" title="type"></a>type</h3><p>通过type 命令可以查看命令类型：</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim">$ <span class="hljs-built_in">type</span> <span class="hljs-keyword">echo</span><br><span class="hljs-keyword">echo</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">a</span> <span class="hljs-keyword">shell</span> builtin<br></code></pre></td></tr></table></figure><h3 id="whereis"><a href="#whereis" class="headerlink" title="whereis"></a>whereis</h3><blockquote><h1 id="Linux-whereis命令"><a href="#Linux-whereis命令" class="headerlink" title="Linux whereis命令"></a>Linux whereis命令</h1><p>Linux whereis命令用于查找文件。</p><p>该指令会在特定目录中查找符合条件的文件。这些文件应属于原始代码、二进制文件，或是帮助文件。</p><p>该指令只能用于查找二进制文件、源代码文件和man手册页，一般文件的定位需使用locate命令。</p><h3 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">whereis <span class="hljs-selector-attr">[-bfmsu]</span><span class="hljs-selector-attr">[-B &lt;目录&gt;...]</span><span class="hljs-selector-attr">[-M &lt;目录&gt;...]</span><span class="hljs-selector-attr">[-S &lt;目录&gt;...]</span><span class="hljs-selector-attr">[文件...]</span><br></code></pre></td></tr></table></figure><p><strong>参数</strong>：</p><p>-b 　只查找二进制文件。</p><p>-B&lt;目录&gt; 　只在设置的目录下查找二进制文件。</p><p>-f 　不显示文件名前的路径名称。</p><p>-m 　只查找说明文件。</p><p>-M&lt;目录&gt; 　只在设置的目录下查找说明文件。</p><p>-s 　只查找原始代码文件。</p><p>-S&lt;目录&gt; 　只在设置的目录下查找原始代码文件。</p><p>-u 　查找不包含指定类型的文件。</p><h3 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h3><p>使用指令”whereis”查看指令”bash”的位置，输入如下命令：</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><span class="hljs-variable">$ </span>whereis bash <br></code></pre></td></tr></table></figure><p>上面的指令执行后，输出信息如下所示：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">bash:<span class="hljs-regexp">/bin/</span>bash<span class="hljs-regexp">/etc/</span>bash.bashrc<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/man/m</span>an1/bash.<span class="hljs-number">1</span>.gz <br></code></pre></td></tr></table></figure><p>注意：以上输出信息从左至右分别为查询的程序名、bash路径、bash的man 手册页路径。</p><p>如果用户需要单独查询二进制文件或帮助文件，可使用如下命令：</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">$ whereis -<span class="hljs-keyword">b </span><span class="hljs-keyword">bash </span><br>$ whereis -m <span class="hljs-keyword">bash </span><br></code></pre></td></tr></table></figure><p>输出信息如下：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">$ whereis -b bash               <span class="hljs-comment">#显示bash 命令的二进制程序  </span><br>bash: <span class="hljs-regexp">/bin/</span>bash <span class="hljs-regexp">/etc/</span>bash.bashrc <span class="hljs-regexp">/usr/</span>share/bash    <span class="hljs-comment"># bash命令的二进制程序的地址  </span><br>$ whereis -m bash               <span class="hljs-comment">#显示bash 命令的帮助文件  </span><br>bash: <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/man/m</span>an1/bash.<span class="hljs-number">1</span>.gz  <span class="hljs-comment">#bash命令的帮助文件地址  </span><br></code></pre></td></tr></table></figure></blockquote><h3 id="systemctl"><a href="#systemctl" class="headerlink" title="systemctl"></a>systemctl</h3><ul><li>设置开机自启动 <code>systemctl enable</code></li><li>停止开机自启动 <code>systemctl disable</code></li><li>验证一下是否为开机启动 <code>systemctl is-enabled</code></li><li>启动服务 <code>systemctl start xxxxx.service</code></li><li>停止服务 <code>systemctl stop xxxxx.service</code></li><li>重启服务 <code>systemctl restart xxxxx.service</code></li><li>查看服务状态 <code>systemctl status xxxxx.service</code></li><li>查看所有已启动的服务 <code>systemctl list-units --type=service</code></li></ul><h3 id="sed-流编辑器"><a href="#sed-流编辑器" class="headerlink" title="sed 流编辑器"></a>sed 流编辑器</h3><p>UNIX 中的 SED 命令代表流编辑器，它可以对文件执行许多功能，如搜索、查找和替换、插入或删除。尽管 UNIX 中 SED 命令的最常见用途是用于替换或查找和替换。通过使用 SED，您甚至可以在不打开文件的情况下编辑文件，这是一种在文件中查找和替换某些内容的方法，比先在 VI 编辑器中打开该文件然后进行更改要快得多。</p><ul><li>SED 是一个强大的文本流编辑器。可以进行插入、删除、搜索和替换（替换）。</li><li>unix 中的 SED 命令支持正则表达式，允许它执行复杂的模式匹配。</li></ul><p><strong>Syntax:</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sed OPTIONS... [SCRIPT] [INPUTFILE...] <br></code></pre></td></tr></table></figure><table><thead><tr><th>OPTIONS</th><th></th></tr></thead><tbody><tr><td><strong><code>-b</code></strong>,<strong><code>--binary</code></strong></td><td>以二进制模式打开输入文件以考虑以换行符结束的行。</td></tr><tr><td><strong><code>--debug</code></strong></td><td>切换到调试模式以规范形式打印输入并注释程序执行。</td></tr><tr><td><strong><code>--follow-symlinks</code></strong></td><td>如果指定文件是符号链接，则编辑最终目标。它仅在与**<code>-i</code>**选项结合使用时才有效。</td></tr><tr><td><strong><code>--help</code></strong></td><td>显示使用信息。</td></tr><tr><td><strong><code>--i</code></strong>,<strong><code>--in-place [=SUFFIX]</code></strong></td><td>通过覆盖原始文件就地执行编辑。</td></tr><tr><td><strong><code>--posix</code></strong></td><td>禁用对 POSIX 的所有扩展**<code>sed</code>** 以简化编写可移植脚本。</td></tr><tr><td><strong><code>--version</code></strong></td><td>**<code>sed</code>**显示系统运行的版本。</td></tr><tr><td><strong><code>-E</code></strong>, <strong><code>-r</code></strong>,<strong><code>--regexp-extended</code></strong></td><td>使用扩展的正则表达式。</td></tr><tr><td><strong><code>-e script</code></strong>,<strong><code>--expression=script</code></strong></td><td>添加指定的脚本以与命令一起运行。</td></tr><tr><td><strong><code>-f script-file</code></strong></td><td>添加指定脚本文件的内容以与命令一起运行。</td></tr><tr><td><strong><code>-l N</code></strong>,<strong><code>--line-length=N</code></strong></td><td>为命令定义所需的换行长度**<code>l</code>**（默认值为 70）。</td></tr><tr><td><strong><code>-n</code></strong>, <strong><code>--quiet</code></strong>,<strong><code>--silent</code></strong></td><td>禁用输出打印。</td></tr><tr><td><strong><code>-s</code></strong>,<strong><code>--separate</code></strong></td><td>将指定的文件视为单独的文件，而不是作为单个连续的长流。</td></tr><tr><td><strong><code>--sandbox</code></strong></td><td>禁用运行外部程序并仅在命令行上对输入文件进行操作。</td></tr><tr><td><strong><code>-u</code></strong>,<strong><code>--unbuffered</code></strong></td><td>最小化输入和输出缓冲区。</td></tr><tr><td><strong><code>-z</code></strong>, <strong><code>--null-data</code></strong>,<strong><code>--zero-terminated</code></strong></td><td>将输入视为一组行，每行都以零字节结尾。</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">---------------------------- 替换 ----------------------------</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">使用 sed 命令替换字符串</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">语法</span><br>sed &#x27;s/old_string/new_string/&#x27; filename.txt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">将box 替换成bin</span><br>sed &#x27;s/box/bin/&#x27; foxinbox.txt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">将box 全部 替换成bin</span><br>sed &#x27;s/box/bin/g&#x27; foxinbox.txt<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">sed 命令替换字符串并忽略大小写</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">使用 i 指示忽略大小写</span><br>sed &#x27;s/fox/cow/i&#x27; foxinbox.txt<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">使用 sed 命令替换一行中的特定某次匹配</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">语法 “<span class="hljs-comment">#”代表数字例如1、2、</span></span><br>sed &#x27;s/old_string/new_string/#&#x27; filename.txt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">将在每行第2次出现的 box 替换成 bin</span><br>sed &#x27;s/box/bin/2&#x27; foxinbox.txt<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">使用 sed 命令替换特定行中的字符串</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">该sed命令允许您通过将行号作为前缀添加到子命令来替换特定行中的字符串：</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">语法</span><br>sed &#x27;# s/old_string/new_string/&#x27; filename.txt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">以下命令将文本第四行 中的socks替换为sandals</span><br>sed &#x27;4 s/socks/sandals/&#x27; foxinbox.txt<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">sed 命令仅替换特定行范围内的字符串</span><br>sed &#x27;#,# s/old_string/new_string/&#x27; filename.txt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">将 4-6 行的 socks 替换成 sandals</span> <br>sed &#x27;4,6 s/socks/sandals/&#x27; foxinbox.txt<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">---------------------------- 删除 ----------------------------</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">删除特定行</span><br>sed &#x27;#,#d&#x27; filename.txt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">删除第二行</span><br>sed &#x27;2d&#x27; foxinbox.txt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">删除 2-4行</span><br>sed &#x27;2,4d&#x27; foxinbox.txt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">从特定行删除到最后一行</span><br>sed &#x27;#,$d&#x27; filename.txt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">从第3行删除到末尾</span><br>sed &#x27;3,$d&#x27; foxinbox.txt<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">---------------------------- Misc ----------------------------</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">仅打印带有替换文本的行</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">-n选项禁用自动打印，而命令p指示sed打印发生替换的行。</span><br>sed -n &#x27;s/old_string/new_string/p&#x27; filename.txt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">实例</span><br>sed -n &#x27;s/box/bin/p&#x27; foxinbox.txt<br></code></pre></td></tr></table></figure><h1 id="linux-内核原理入土"><a href="#linux-内核原理入土" class="headerlink" title="linux 内核原理入土"></a>linux 内核原理入土</h1><h2 id="namespace"><a href="#namespace" class="headerlink" title="namespace"></a>namespace</h2><h2 id="cgroup"><a href="#cgroup" class="headerlink" title="cgroup"></a>cgroup</h2><h1 id="Editor"><a href="#Editor" class="headerlink" title="Editor"></a>Editor</h1><h2 id="VIM"><a href="#VIM" class="headerlink" title="VIM"></a>VIM</h2><ul><li>命令模式（Command mode）</li><li>插入模式（Insert mode）</li><li>底线命令模式（Last line mode）</li></ul><h3 id="指令模式"><a href="#指令模式" class="headerlink" title="指令模式"></a>指令模式</h3><p>(n)&#x3D;数字</p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td>i</td><td>前面插入</td></tr><tr><td></td><td>I</td><td>行首插入</td></tr><tr><td></td><td>a</td><td>后面插入</td></tr><tr><td></td><td>A</td><td>行尾插入</td></tr><tr><td></td><td>o</td><td>下方新建一行</td></tr><tr><td></td><td>O</td><td>上面新建一行</td></tr><tr><td></td><td>s</td><td>删除字符</td></tr><tr><td></td><td>r</td><td>替换字符</td></tr><tr><td>∆</td><td>hjkl</td><td>光标移动</td></tr><tr><td>∆</td><td>(n)G</td><td>光标移动到第n行 跳转到行</td></tr><tr><td></td><td>(n)+</td><td>下移n行</td></tr><tr><td></td><td>(n)-</td><td>上移n行</td></tr><tr><td></td><td>Ctrl+f</td><td>上一页</td></tr><tr><td></td><td>Ctrl+b</td><td>下一页</td></tr><tr><td></td><td>cc</td><td>删除整行，并修改</td></tr><tr><td>∆</td><td>dd</td><td>删除整行</td></tr><tr><td></td><td>(n)dd</td><td>删除n行</td></tr><tr><td></td><td>x</td><td>删除光标所在字符</td></tr><tr><td></td><td>X</td><td>删除光标前一个字符</td></tr><tr><td>∆</td><td>yy</td><td>复制整行</td></tr><tr><td></td><td>(n)yy</td><td>复制n行</td></tr><tr><td>∆</td><td>v</td><td>选择 开始<br>按下 <code>v</code> 来选择字符。<br>（也可以用 <code>V</code> 来选择整行，<code>Ctrl-v</code> 来选择矩形块）</td></tr><tr><td>∆</td><td>d</td><td>剪切 结束<br>光标移动到结束剪切的位置。<br>按下 <code>d</code> 来剪切。</td></tr><tr><td>∆</td><td>y</td><td>复制 结束<br>光标移动到结束复制的位置。<br>按下 <code>y</code> 来剪切。</td></tr><tr><td>∆</td><td>p</td><td>粘贴</td></tr><tr><td>∆</td><td>u</td><td>撤销</td></tr><tr><td></td><td>^r</td><td>重做</td></tr></tbody></table><h3 id="底行模式"><a href="#底行模式" class="headerlink" title="底行模式"></a>底行模式</h3><h4 id="指令"><a href="#指令" class="headerlink" title=": 指令"></a>: 指令</h4><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>x</td><td>保存退出</td></tr><tr><td>q!</td><td>不保存强制退出</td></tr><tr><td>(n)</td><td>跳转到行<code>:n 需要回车</code></td></tr></tbody></table><h4 id="x2F-搜索"><a href="#x2F-搜索" class="headerlink" title="&#x2F; 搜索"></a>&#x2F; 搜索</h4><ul><li>查看下一个匹配，按下n(小写n)</li><li>跳转到上一个匹配，按下N（大写N）</li><li>noh或者set noh 高亮</li></ul><h2 id="VIM-Note"><a href="#VIM-Note" class="headerlink" title="VIM Note"></a>VIM Note</h2><h3 id="跳转到行"><a href="#跳转到行" class="headerlink" title="跳转到行"></a>跳转到行</h3><ul><li>指令模式 <code>(n)G</code> 光标移动到第n行 跳转到行</li><li>底行模式 <code>:n</code> （跳转到文件第n行，需要回车）</li><li><code>vim +n filename</code> （在打开文件后，跳转到文件的第n行）</li></ul><h3 id="替换"><a href="#替换" class="headerlink" title="替换"></a>替换</h3><blockquote><p>:[range]s&#x2F;from&#x2F;to&#x2F;[flags]</p><p>range:搜索范围，如果没有指定范围，则作用于但前行。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">:<span class="hljs-number">1</span>,<span class="hljs-number">10</span>s<span class="hljs-regexp">/from/</span>to/ 表示在第<span class="hljs-number">1</span>到第<span class="hljs-number">10</span>行（包含第<span class="hljs-number">1</span>，第<span class="hljs-number">10</span>行）之间搜索替换；<br>:<span class="hljs-number">10</span>s<span class="hljs-regexp">/from/</span>to/ 表示只在第<span class="hljs-number">10</span>行搜索替换；<br>:%s<span class="hljs-regexp">/from/</span>to/ 表示在所有行中搜索替换；<br>:<span class="hljs-number">1</span>,<span class="hljs-variable">$s</span><span class="hljs-regexp">/from/</span>to/ 同上。<br></code></pre></td></tr></table></figure><p>flags 有如下四个选项：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">c</span> confirm，每次替换前询问；<br>e <span class="hljs-literal">error</span>， 不显示错误；<br>g globle，不询问，整行替换。如果不加g选项，则只替换每行的第一个匹配到的字符串；<br>i ignore，忽略大小写。<br></code></pre></td></tr></table></figure></blockquote><ol><li><p>vim 中可用 :s 命令来替换字符串，具体如下：</p><ul><li><code>:s/str1/str2/</code> 替换当前行第一个 str1 为 str2</li><li><code>:s/str1/str2/g</code> 替换当前行中所有 str1 为 str2</li><li><code>:m,ns/str1/str2/</code> 替换第 n 行开始到最后一行中每一行的第一个 str1 为 str2</li><li><code>:m,ns/str1/str2/g</code> 替换第 n 行开始到最后一行中所有的 str1 为 str2<br>(注：m和n 为数字，若m为 .，表示为当前行开始；若n为$，则表示到最后一行结束)<br>如果使用 # 作为分隔符，则中间出现的 &#x2F; 不会作为分隔符，比如：<br><code>:s#str1/#str2/#</code> 替换当前行第一个 str1&#x2F; 为 str2&#x2F;<br><code>:%s+/oradata/apras/+/user01/apras1+</code> (使用+ 来 替换 &#x2F; )： &#x2F;oradata&#x2F;apras&#x2F;替换成&#x2F;user01&#x2F;apras1&#x2F;</li></ul></li><li><p>其他:</p></li></ol><ul><li><code>%s/str1/str2/</code>（等同于 :g&#x2F;str1&#x2F;s&#x2F;&#x2F;str2&#x2F;） 替换每一行的第一个 str1 为 str2</li><li><code>:%s/str1/str2/g</code>（等同于 :g&#x2F;str1&#x2F;s&#x2F;&#x2F;str2&#x2F;g 和 :1,$ s&#x2F;str1&#x2F;str2&#x2F;g ） 替换文中所有 str1 为 str2<br>从替换命令可以看到，g 放在命令末尾，表示对搜索字符串的每次出现进行替换；不加 g，表示只对搜索</li></ul><h4 id="正则表达式替换"><a href="#正则表达式替换" class="headerlink" title="正则表达式替换"></a>正则表达式替换</h4><h5 id="元字符"><a href="#元字符" class="headerlink" title="元字符"></a>元字符</h5><table><thead><tr><th>元字符</th><th>说明</th></tr></thead><tbody><tr><td>.</td><td>匹配任意字符</td></tr><tr><td>[abc]</td><td>匹配方括号中的任意一个字符，可用-表示字符范围。如[a-z0-9]匹配小写字母和数字</td></tr><tr><td><code>[^abc]</code></td><td>匹配除方括号中字符之外的任意字符</td></tr><tr><td>\d</td><td>匹配阿拉伯数字，等同于[0-9]</td></tr><tr><td>\D</td><td><code>匹配阿拉伯数字之外的任意字符，等同于[^0-9]</code></td></tr><tr><td>\x</td><td>匹配十六进制数字，等同于[0-9A-Fa-f]</td></tr><tr><td>\X</td><td><code>匹配十六进制数字之外的任意字符，等同于[^0-9A-Fa-f]</code></td></tr><tr><td>\l</td><td>匹配[a-z]</td></tr><tr><td>\L</td><td><code>匹配[^a-z]</code></td></tr><tr><td>\u</td><td>匹配[A-Z]</td></tr><tr><td>\U</td><td><code>匹配[^A-Z]</code></td></tr><tr><td>\w</td><td>匹配单词字母，等同于[0-9A-Za-z_]</td></tr><tr><td>\W</td><td><code>匹配单词字母之外的任意字符，等同于[^0-9A-Za-z_]</code></td></tr><tr><td>\t</td><td>匹配字符</td></tr><tr><td>\s</td><td>匹配空白字符，等同于[\t]</td></tr><tr><td>\S</td><td><code>匹配非空白字符，等同于[^\t]</code></td></tr></tbody></table><h5 id="需转义的普通字符"><a href="#需转义的普通字符" class="headerlink" title="需转义的普通字符"></a>需转义的普通字符</h5><table><thead><tr><th>元字符</th><th>说明</th></tr></thead><tbody><tr><td>*</td><td>匹配 * 字符</td></tr><tr><td>.</td><td>匹配 . 字符</td></tr><tr><td>&#x2F;</td><td>匹配 &#x2F; 字符</td></tr><tr><td>\</td><td>匹配 \ 字符</td></tr><tr><td>[</td><td>匹配 [ 字符</td></tr><tr><td>]</td><td>匹配 ] 字符</td></tr></tbody></table><h5 id="表示数量的元字符"><a href="#表示数量的元字符" class="headerlink" title="表示数量的元字符"></a>表示数量的元字符</h5><table><thead><tr><th>元字符</th><th>说明</th></tr></thead><tbody><tr><td>*</td><td>匹配0-任意个</td></tr><tr><td>+</td><td>匹配1-任意个</td></tr><tr><td>?</td><td>匹配0-1个</td></tr><tr><td>{n,m}</td><td>匹配n-m个</td></tr><tr><td>{n}</td><td>匹配n个</td></tr><tr><td>{n,}</td><td>匹配n-任意个</td></tr><tr><td>{,m}</td><td>匹配0-m个</td></tr></tbody></table><h5 id="表示位置的元字符"><a href="#表示位置的元字符" class="headerlink" title="表示位置的元字符"></a>表示位置的元字符</h5><table><thead><tr><th>元字符</th><th>说明</th></tr></thead><tbody><tr><td>$</td><td>匹配行尾</td></tr><tr><td>^</td><td>匹配行首</td></tr><tr><td>&lt;</td><td>匹配单词词首</td></tr><tr><td>&gt;</td><td>匹配单词词尾</td></tr></tbody></table><hr><h5 id="替换变量"><a href="#替换变量" class="headerlink" title="替换变量"></a>替换变量</h5><p>在正则式中以“”以及“”以及“”括起来的正则表达式，在后面使用的时候可以用“\1”、“\2”等变量来访问“”以及“”以及“”中的内容。</p><p>例子</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">删除行尾空格：                         :%s/\s+$//g<br>删除行首多余空格：                      :%s/^\s*// 或者 %s/^ *//<br>删除沒有內容的空行：                    :%s/^$// 或者 g/^$/d<br>删除包含有空格组成的空行                 :%s/^\s*$// 或者 g/^\s*$/d<br>删除以空格或TAB开头到结尾的空行：         :%s/^[ |\t]*$// 或者 g/^[ |\t]*$/d<br><br>把文中的所有字符串“abc……xyz”替换为“xyz……abc”可以有下列写法<br>:%s/abc\(.*\)xyz/xyz\1abc/g<br>:%s/\(abc\)\(.*\)\(xyz\)/\3\2\1/g<br></code></pre></td></tr></table></figure><h3 id="vim-编辑二进制"><a href="#vim-编辑二进制" class="headerlink" title="vim 编辑二进制"></a>vim 编辑二进制</h3><ol><li><code>vim -b binary_file</code> <code>-b</code> 这个参数设定了 ‘binary’ 选项。</li><li>输入<code>:%!xxd</code>把文件内容以常见的字节偏移 十六进制 ASCII码的版面显示</li><li>然后输入<code>R</code>进入改写模式，即可按照版面格式进行编辑。<br>注意：只有十六进制部分的修改才会被采用。右边ASCII文本部分的修改无效。</li><li>编辑完成以后<code>:%!xxd -r</code>把刚才的编辑格式转换会原始文本格式。</li><li>输入<code>:wq</code>保存退出。</li></ol><h3 id="vim-复制-剪切-粘贴"><a href="#vim-复制-剪切-粘贴" class="headerlink" title="vim 复制 剪切 粘贴"></a>vim 复制 剪切 粘贴</h3><p><a target="_blank" rel="noopener" href="https://harttle.land/2022/03/19/vim-copy-paste.html">https://harttle.land/2022/03/19/vim-copy-paste.html</a></p><h3 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">设置 tab = 4 空格</span><br>set ts=4<br><span class="hljs-meta prompt_"># </span><span class="language-bash">显示行号</span><br>set nu<br></code></pre></td></tr></table></figure><h2 id="Nano"><a href="#Nano" class="headerlink" title="Nano"></a>Nano</h2><p>alt+6 复制</p><p>ctrl+u 粘贴</p><h2 id="gedit"><a href="#gedit" class="headerlink" title="gedit"></a>gedit</h2><h1 id="GCC"><a href="#GCC" class="headerlink" title="GCC"></a>GCC</h1><table><thead><tr><th>参数</th><th></th><th></th></tr></thead><tbody><tr><td>-o</td><td><code>gcc main.c -o main</code></td><td>指定输出文件名</td></tr><tr><td>-c</td><td><code>gcc main.c -c</code></td><td>只编译输出.o不生成.out可执行文件</td></tr><tr><td>-g</td><td></td><td>生成调试所需的符号信息</td></tr><tr><td>-O&amp;-O2</td><td></td><td>优化&amp;更优化</td></tr><tr><td>-Wall</td><td></td><td><strong>显示警告</strong></td></tr><tr><td>-std&#x3D;<standard></standard></td><td><code>-std=c99</code></td><td>使用C99标准</td></tr></tbody></table><h1 id="Makefile"><a href="#Makefile" class="headerlink" title="Makefile"></a>Makefile</h1><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-comment"># 依赖main.o input.o calcu.o生成 main ,如果依赖文件不存在就会根据规则生成相应的 *.o 文件</span><br><span class="hljs-section">main: main.o input.o calcu.o</span><br>	gcc -o main main.o input.o calcu.o<br><br><span class="hljs-section">main.o: main.c</span><br>	gcc -c main.c<br><span class="hljs-section">input.o: input.c</span><br>	gcc -c input.c<br><span class="hljs-section">calcu.o: calcu.c</span><br>	gcc -c calcu.c<br><br><span class="hljs-section">clean:</span><br>	rm *.o<br>	rm main<br></code></pre></td></tr></table></figure><h2 id="x3D"><a href="#x3D" class="headerlink" title="&#x3D;"></a>&#x3D;</h2><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs makefile">name = sss<br>cur = <span class="hljs-variable">$(name)</span><br>name = ppp<br><br><span class="hljs-section">print:</span><br>	@echo cur: <span class="hljs-variable">$(cur)</span><br><br><span class="hljs-comment"># 这里会输出 ppp</span><br></code></pre></td></tr></table></figure><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>&#x3D;</td><td>类似指针,值等于其真实值</td></tr><tr><td>:&#x3D;</td><td>类似赋值,等于其赋值时的值</td></tr><tr><td>?&#x3D;</td><td>如果变量没有赋值,就赋后面的值</td></tr><tr><td>+&#x3D;</td><td>类似字符串后面追加一个字符串</td></tr><tr><td>%</td><td>代表非空字符串,可用于匹配文件名</td></tr></tbody></table><h2 id="自动化变量"><a href="#自动化变量" class="headerlink" title="自动化变量"></a>自动化变量</h2><table><thead><tr><th></th><th>自动化变量</th></tr></thead><tbody><tr><td>$@</td><td>规则中的目标集合，在模式规则中，如果有多个目标的话，“ $@”表示匹配模式中定义的目标集合。</td></tr><tr><td>$&lt;</td><td>所有依赖文件的集合， 使用空格分开， 如果在依赖文件中有多个重复的文件，“$^”会去除重复的依赖文件，值保留一份。</td></tr><tr><td>$^</td><td>依赖文件集合中的第一个，如果依赖文件是以模式 (即“ %”)定义的，那么 “$&lt;”就是符合模式的一系列文件集。</td></tr><tr><td>$?</td><td>所有比目标新的依赖集合，以空格分开。</td></tr><tr><td>$%</td><td>当目标是函数库的时候表示规则中成员名， 如果目标不是函数库文件，那么其值为空。</td></tr><tr><td>$+</td><td>和“ $^”类似，但是当依赖文件存在重复的话不会去除重复的依赖文件。</td></tr><tr><td>$*</td><td>这个变量表示目标模式中”%”及其之前的部分，如果目标是 test&#x2F;a.test.c，目标模 ，目标模为 a.%.c，那么“ $*”就是test&#x2F;a.test。</td></tr><tr><td>$(XX)</td><td>类似替换成XX的值</td></tr></tbody></table><h2 id="伪目标"><a href="#伪目标" class="headerlink" title="伪目标"></a>伪目标</h2><p>例如，目录内存在clean文件运行 make clean 则运行的是clean文件的规则，如果将Makefile文件内的clean定义为伪目标则不管如何都是执行Makefile内的指令。</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs makefile">objects = main.o input.o calcu.o<br><span class="hljs-section">main: <span class="hljs-variable">$(objects)</span></span><br>	gcc -o main <span class="hljs-variable">$(objects)</span> <br><span class="hljs-comment"># 声明伪目标</span><br>.PHONY : clean<br><br>%.o : %.c<br>	gcc -c <span class="hljs-variable">$&lt;</span><br><br><span class="hljs-section">clean:</span><br>	rm *.o<br>	rm main<br></code></pre></td></tr></table></figure><h2 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h2><ul><li>ifeq 比较参数是否相等</li><li>ifneq</li><li>ifdef 判断变量是否为真</li><li>ifndef</li></ul><h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h3 id="subst-字符串替换"><a href="#subst-字符串替换" class="headerlink" title="subst 字符串替换"></a>subst 字符串替换</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs makefile">$(subst&lt;from&gt;,&lt;to&gt;,&lt;text&gt;)<br><span class="hljs-comment"># 字符串替换</span><br><span class="hljs-comment"># 将text中的from替换成to,函数返回替换以后的字符串</span><br><br><span class="hljs-comment">#例</span><br><span class="hljs-variable">$(<span class="hljs-built_in">subst</span> ppp,lll,my name is ppp)</span><br><span class="hljs-comment"># my name is lll</span><br></code></pre></td></tr></table></figure><h3 id="patsubst-模式字符串替换"><a href="#patsubst-模式字符串替换" class="headerlink" title="patsubst 模式字符串替换"></a>patsubst 模式字符串替换</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-variable">$(<span class="hljs-built_in">patsubst</span> &lt;pattern&gt;,&lt;replacement&gt;,&lt;text&gt;)</span><br><span class="hljs-comment"># 查找text单词是否符合模式pattern,符合就用replacement替换</span><br><br><span class="hljs-comment"># 例</span><br><span class="hljs-variable">$(<span class="hljs-built_in">patsubst</span> %.c,%.o,a.c b.c c.c)</span><br><span class="hljs-comment"># “a.o b.o c.o”</span><br></code></pre></td></tr></table></figure><h3 id="dir-获取目录"><a href="#dir-获取目录" class="headerlink" title="dir 获取目录"></a>dir 获取目录</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-variable">$(<span class="hljs-built_in">dir</span> &lt;names…&gt;)</span><br><span class="hljs-comment"># 此函数用来从文件名序列&lt;names&gt;中提取出目录部分</span><br><br><span class="hljs-comment"># 例</span><br><span class="hljs-variable">$(<span class="hljs-built_in">dir</span> &lt;/src/a.c&gt;)</span><br><span class="hljs-comment"># /src</span><br></code></pre></td></tr></table></figure><h3 id="notdir-去除文件中目录部分"><a href="#notdir-去除文件中目录部分" class="headerlink" title="notdir 去除文件中目录部分"></a>notdir 去除文件中目录部分</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-variable">$(<span class="hljs-built_in">notdir</span> &lt;names…&gt;)</span><br><span class="hljs-comment"># 此函数用与从文件名序列&lt;names&gt;中提取出文件名非目录部分</span><br><br><span class="hljs-comment"># 例</span><br><span class="hljs-variable">$(<span class="hljs-built_in">notdir</span> &lt;/src/a.c&gt;)</span><br><span class="hljs-comment"># a.c</span><br></code></pre></td></tr></table></figure><h3 id="freach-循环"><a href="#freach-循环" class="headerlink" title="freach 循环"></a>freach 循环</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-variable">$(<span class="hljs-built_in">foreach</span> &lt;var&gt;, &lt;list&gt;,&lt;text&gt;)</span><br><span class="hljs-comment"># foreach函数用来完成循环，用法如下</span><br><span class="hljs-comment"># 此函数的意思就是把参数&lt;list&gt;中的单词逐一取出来放到参数&lt;var&gt;中，然后再执行&lt;text&gt;所包含的表达式。每次&lt;text&gt;都会返回一个字符串，循环的过程中，&lt;text&gt;中所包含的每个字符串会以空格隔开,最后但整个循环结束时,&lt;text&gt;所返回的每个字符串所组成的整个字符串将会是函数foreach函数的返回值。</span><br></code></pre></td></tr></table></figure><h3 id="wildcard-函数"><a href="#wildcard-函数" class="headerlink" title="wildcard 函数"></a>wildcard 函数</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-variable">$(<span class="hljs-built_in">wildcard</span> PATTERN…)</span><br><span class="hljs-comment">#通配符“ 通配符“ %”只能用在规则中， 只有在规则中它才会展开，如果在变量定义和函数使用时通配符不会自动展开，这个时候就要用到函数wildcard</span><br><br><span class="hljs-comment"># 例</span><br><span class="hljs-variable">$(<span class="hljs-built_in">wildcard</span> *.c)</span><br><span class="hljs-comment">#上面的代码是用来获取当前目录下所有.c文件，类似“%”</span><br></code></pre></td></tr></table></figure><h1 id="一些包"><a href="#一些包" class="headerlink" title="一些包"></a>一些包</h1><h2 id="iperf-网络流量测试"><a href="#iperf-网络流量测试" class="headerlink" title="iperf 网络流量测试"></a>iperf 网络流量测试</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/bingyu9875/article/details/105700655/">https://blog.csdn.net/bingyu9875/article/details/105700655/</a></p><p><strong>官方网站：</strong><a target="_blank" rel="noopener" href="https://iperf.fr/">https://iperf.fr/</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs shell">Usage: iperf [-s|-c host] [options]<br>       iperf [-h|--help] [-v|--version]<br><br>Server or Client:<br>  -p, --port      #         server port to listen on/connect to<br>  -f, --format    [kmgKMG]  format to report: Kbits, Mbits, KBytes, MBytes<br>  -i, --interval  #         seconds between periodic bandwidth reports<br>  -F, --file name           xmit/recv the specified file<br>  -A, --affinity n/n,m      set CPU affinity<br>  -B, --bind      &lt;host&gt;    bind to a specific interface<br>  -V, --verbose             more detailed output<br>  -J, --json                output in JSON format<br>  -d, --debug               emit debugging output<br>  -v, --version             show version information and quit<br>  -h, --help                show this message and quit<br>Server specific:<br>  -s, --server              run in server mode<br>  -D, --daemon              run the server as a daemon<br>  -1, --one-off             handle one client connection then exit<br>Client specific:<br>  -c, --client    &lt;host&gt;    run in client mode, connecting to &lt;host&gt;<br>  -u, --udp                 use UDP rather than TCP<br>  -b, --bandwidth #[KMG][/#] target bandwidth in bits/sec (0 for unlimited)<br>                            (default 1 Mbit/sec for UDP, unlimited for TCP)<br>                            (optional slash and packet count for burst mode)<br>  -t, --time      #         time in seconds to transmit for (default 10 secs)<br>  -n, --bytes     #[KMG]    number of bytes to transmit (instead of -t)<br>  -k, --blockcount #[KMG]   number of blocks (packets) to transmit (instead of -t or -n)<br>  -l, --len       #[KMG]    length of buffer to read or write<br>                            (default 128 KB for TCP, 8 KB for UDP)<br>  -P, --parallel  #         number of parallel client streams to run<br>  -R, --reverse             run in reverse mode (server sends, client receives)<br>  -w, --window    #[KMG]    set window size / socket buffer size<br>  -C, --linux-congestion &lt;algo&gt;  set TCP congestion control algorithm (Linux only)<br>  -M, --set-mss   #         set TCP maximum segment size (MTU - 40 bytes)<br>  -N, --nodelay             set TCP no delay, disabling Nagle&#x27;s Algorithm<br>  -4, --version4            only use IPv4<br>  -6, --version6            only use IPv6<br>  -S, --tos N               set the IP &#x27;type of service&#x27;<br>  -L, --flowlabel N         set the IPv6 flow label (only supported on Linux)<br>  -Z, --zerocopy            use a &#x27;zero copy&#x27; method of sending data<br>  -O, --omit N              omit the first n seconds<br>  -T, --title str           prefix every output line with this string<br>  --get-server-output       get results from server<br><br>[KMG] indicates options that support a K/M/G suffix for kilo-, mega-, or giga-<br><br>iperf3 homepage at: http://software.es.net/iperf/<br>Report bugs to:     https://github.com/esnet/iperf<br></code></pre></td></tr></table></figure><p>​</p><h2 id="speedometer-网络监控工具"><a href="#speedometer-网络监控工具" class="headerlink" title="speedometer 网络监控工具"></a>speedometer 网络监控工具</h2><h2 id="s-tui-cpu温度使用监测"><a href="#s-tui-cpu温度使用监测" class="headerlink" title="s-tui cpu温度使用监测"></a>s-tui cpu温度使用监测</h2><h2 id="htop-进程查看器"><a href="#htop-进程查看器" class="headerlink" title="htop 进程查看器"></a>htop 进程查看器</h2><h2 id="sysbench-性能测试工具"><a href="#sysbench-性能测试工具" class="headerlink" title="sysbench 性能测试工具"></a>sysbench 性能测试工具</h2><p>Sysbench的测试主要包括以下几个方面：</p><p>1、磁盘io性能</p><p>2、cpu性能</p><p>3、内存分配及传输速度</p><p>4、POSIX线程性能</p><p>5、调度程序性能</p><p>6、数据库性能(OLTP基准测试).</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">4线程 测试cpu 找20000前的所有素数</span><br>sysbench --test=cpu --num-threads=4 --cpu-max-prime=20000 run<br></code></pre></td></tr></table></figure><h2 id="crontab-定期执行程序"><a href="#crontab-定期执行程序" class="headerlink" title="crontab 定期执行程序"></a>crontab 定期执行程序</h2><p><a target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-comm-crontab.html">https://www.runoob.com/linux/linux-comm-crontab.html</a></p><p><strong>注意：</strong>新创建的 cron 任务，不会马上执行，至少要过 2 分钟后才可以，当然你可以重启 cron 来马上执行。</p><h3 id="语法-3"><a href="#语法-3" class="headerlink" title="语法"></a>语法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">crontab [ -u user ] file<br></code></pre></td></tr></table></figure><p>或</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">crontab [ -u user ] &#123; -l | -r | -e &#125;<br></code></pre></td></tr></table></figure><p><strong>说明：</strong></p><p>crontab 是用来让使用者在固定时间或固定间隔执行程序之用，换句话说，也就是类似使用者的时程表。</p><p>-u user 是指设定指定 user 的时程表，这个前提是你必须要有其权限(比如说是 root)才能够指定他人的时程表。如果不使用 -u user 的话，就是表示设定自己的时程表。</p><p><strong>参数说明</strong>：</p><ul><li>-e : 执行文字编辑器来设定时程表，内定的文字编辑器是 VI，如果你想用别的文字编辑器，则请先设定 VISUAL 环境变数来指定使用那个文字编辑器(比如说 setenv VISUAL joe)</li><li>-r : 删除目前的时程表</li><li>-l : 列出目前的时程表</li></ul><p>时间格式如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">f1 f2 f3 f4 f5 program<br></code></pre></td></tr></table></figure><ul><li>其中 f1 是表示分钟，f2 表示小时，f3 表示一个月份中的第几日，f4 表示月份，f5 表示一个星期中的第几天。program 表示要执行的程序。</li><li>当 f1 为 * 时表示每分钟都要执行 program，f2 为 * 时表示每小时都要执行程序，其馀类推</li><li>当 f1 为 a-b 时表示从第 a 分钟到第 b 分钟这段时间内要执行，f2 为 a-b 时表示从第 a 到第 b 小时都要执行，其馀类推</li><li>当 f1 为 *&#x2F;n 时表示每 n 分钟个时间间隔执行一次，f2 为 *&#x2F;n 表示每 n 小时个时间间隔执行一次，其馀类推</li><li>当 f1 为 a, b, c,… 时表示第 a, b, c,… 分钟要执行，f2 为 a, b, c,… 时表示第 a, b, c…个小时要执行，其馀类推</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">*    *    *    *    *<br>-    -    -    -    -<br>|    |    |    |    |<br>|    |    |    |    +----- 星期中星期几 (0 - 6) (星期天 为0)<br>|    |    |    +---------- 月份 (1 - 12) <br>|    |    +--------------- 一个月中的第几天 (1 - 31)<br>|    +-------------------- 小时 (0 - 23)<br>+------------------------- 分钟 (0 - 59)<br></code></pre></td></tr></table></figure><h3 id="实例-2"><a href="#实例-2" class="headerlink" title="实例"></a>实例</h3><p>每一分钟执行一次 &#x2F;bin&#x2F;ls：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">* * * * * /bin/ls<br></code></pre></td></tr></table></figure><p>在 12 月内, 每天的早上 6 点到 12 点，每隔 3 个小时 0 分钟执行一次 &#x2F;usr&#x2F;bin&#x2F;backup：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">0 6-12/3 * 12 * /usr/bin/backup<br></code></pre></td></tr></table></figure><p>周一到周五每天下午 5:00 寄一封信给 <a href="mailto:&#x61;&#x6c;&#x65;&#120;&#64;&#x64;&#111;&#x6d;&#x61;&#x69;&#x6e;&#x2e;&#x6e;&#x61;&#x6d;&#101;">&#x61;&#x6c;&#x65;&#120;&#64;&#x64;&#111;&#x6d;&#x61;&#x69;&#x6e;&#x2e;&#x6e;&#x61;&#x6d;&#101;</a>：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">0 17 * * 1-5 mail -s &quot;hi&quot; alex@domain.name &lt; /tmp/maildata<br></code></pre></td></tr></table></figure><p>每月每天的午夜 0 点 20 分, 2 点 20 分, 4 点 20 分….执行 echo “haha”：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">20 0-23/2 * * * echo &quot;haha&quot;<br></code></pre></td></tr></table></figure><p>下面再看看几个具体的例子：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">0 */2 * * * /sbin/service httpd restart  意思是每两个小时重启一次apache <br><br>50 7 * * * /sbin/service sshd start  意思是每天7：50开启ssh服务 <br><br>50 22 * * * /sbin/service sshd stop  意思是每天22：50关闭ssh服务 <br></code></pre></td></tr></table></figure><h1 id="Note-1"><a href="#Note-1" class="headerlink" title="Note"></a>Note</h1><h2 id="增加开机启动项"><a href="#增加开机启动项" class="headerlink" title="增加开机启动项"></a>增加开机启动项</h2><h3 id="raspberry"><a href="#raspberry" class="headerlink" title="raspberry"></a>raspberry</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo nano /etc/rc.local<br><span class="hljs-meta prompt_"># </span><span class="language-bash">在打开的rc.local找到<span class="hljs-built_in">exit</span> 0，在<span class="hljs-built_in">exit</span> 0 之前添加即可</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">执行这段代码时是使用root用户权限的，注意当前的用户权限，以免因权限问题导致脚本执行失败。</span><br><br></code></pre></td></tr></table></figure><h3 id="Ubuntu"><a href="#Ubuntu" class="headerlink" title="Ubuntu"></a>Ubuntu</h3><h4 id="service-方式"><a href="#service-方式" class="headerlink" title="service 方式"></a>service 方式</h4><p>Ubuntu 20.04的服务管理是基于systemd的，因此设置服务自启动最推荐的方法是创建一个systemd服务文件，配置好要执行的服务。</p><ol><li>创建我们需要开机自启动的脚本，例如<code>start.sh</code>，其内容如下：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-built_in">cd</span> /tmp<br><span class="hljs-built_in">touch</span> 11111111111.txt<br></code></pre></td></tr></table></figure><ol start="2"><li>在<code>/etc/systemd/user</code>目录下创建一个systemd服务文件, 命名为<code>xxxxxx.service</code>, 内容如下：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">[Unit]<br>After=network.service		<span class="hljs-comment"># run after the network is up</span><br><br>[Service]<br>ExecStart=/home/hqc/test.sh <span class="hljs-comment"># absolute path</span><br><br>[Install]<br>WantedBy=default.target<br></code></pre></td></tr></table></figure><ul><li><p>After表示服务何时启动，After&#x3D;network.service 表示网络连接完成后，启动我们的服务；</p></li><li><p>ExecStart表示我们的脚本（步骤1中的test.sh)的路径；WantedBy默认填default.target。</p></li><li><p><strong>xxxxxx.service 内容释义</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">[Unit]:服务的说明<br>Description:描述服务<br>After:描述服务类别<br><br>[Service]服务运行参数的设置<br>Type=forking            是后台运行的形式<br>ExecStart               为服务的具体运行命令<br>ExecReload              为服务的重启命令<br>ExecStop                为服务的停止命令<br>PrivateTmp=True         表示给服务分配独立的临时空间<br>注意：启动、重启、停止命令全部要求使用绝对路径<br><br>[Install]               服务安装的相关设置，可设置为多用户<br>WantedBy=multi-user.target<br></code></pre></td></tr></table></figure></li></ul><ol start="3"><li>给systemd服务文件和我们的脚本增加运行权限</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> +x /etc/systemd/user/xxxxxx.service<br><span class="hljs-built_in">chmod</span> +x start.sh<br></code></pre></td></tr></table></figure><ol start="4"><li>重新加载系统的systemd服务文件，并启用我们自己写的<code>xxxxxx.service</code>文件。</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo systemctl daemon-reload<br>systemctl --user <span class="hljs-built_in">enable</span> xxxxxx.service <br><span class="hljs-comment"># sudo systemctl enable xxxxxx.service </span><br></code></pre></td></tr></table></figure><blockquote><p><em>用systemd启动的服务默认是root权限，放脚本很不安全，如果只需要登录用户的权限，改成user service (systemctl –user)更好，如果有桌面环境，还可以用XDG Autostart</em></p><p>改成 (systemctl –user) 似乎这个用户不登陆这个脚本就没法执行了</p></blockquote><h4 id="profile-d"><a href="#profile-d" class="headerlink" title="profile.d"></a>profile.d</h4><p>将写好的脚本（.sh文件）放到目录 &#x2F;etc&#x2F;profile.d&#x2F; 下，系统启动后就会自动执行该目录下的所有shell脚本。</p><blockquote><p>Ubuntu 20.04.4 LTS service</p><p>放在这个目录里面似乎要在用户登录了之后才会启动服务</p></blockquote><h2 id="zerotier"><a href="#zerotier" class="headerlink" title="zerotier"></a>zerotier</h2><p><strong>官方定义的名词</strong></p><ul><li>PLANET 行星服务器，Zerotier 根服务器</li><li>MOON 卫星服务器，用户自建的私有根服务器，起到代理加速的作用</li><li>LEAF 叶子节点，网络客户端，就是每台连接到网络节点。</li></ul><p><strong>下载安装</strong></p><p><a target="_blank" rel="noopener" href="https://www.zerotier.com/download/">https://www.zerotier.com/download/</a></p><p>查看安装zerotier版本<br><code>sudo zerotier-cli status</code></p><p>加入一个netWork<br><code>sudo zerotier-cli join ################（networkid）</code></p><p>查看加入的网络的信息，比如network<br><code>sudo zerotier-cli listnetworks</code></p><p>退出加入的network网段<br><code>sudo zerotier-cli leave ################（networkid）</code></p><h3 id="搭建moon节点"><a href="#搭建moon节点" class="headerlink" title="搭建moon节点"></a>搭建moon节点</h3><p><strong>搭建moon节点的需求</strong></p><ul><li>需要一台公网服务器</li><li>公网服务器需要加入网络</li></ul><p><strong>搭建步骤</strong></p><ol><li><p>生成moon模板</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /var/lib/zerotier-one<br>zerotier-idtool initmoon identity.public &gt; moon.json<br></code></pre></td></tr></table></figure></li><li><p>修改moon配置</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vi moon.json<br></code></pre></td></tr></table></figure><ul><li>修改”stableEndpoints”为 vps 的公网的 IP,例如”stableEndpoints”: [“1.1.1.1&#x2F;9993”]</li></ul></li><li><p>生成签名文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">zerotier-idtool genmoon moon.json<br></code></pre></td></tr></table></figure><ul><li>执行之后会生产一个000000xxxx.moon的文件，将这个文件用Winscp等工具从vps上下载下来。</li></ul></li><li><p>将moon节点加入网络, 这一步公网服务器和其他所有的主机都需要操作</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">zerotier-one目录下操作</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">Windows:</span> <br><span class="hljs-meta prompt_"># </span><span class="language-bash">C:\ProgramData\ZeroTier\One</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">Linux:</span> <br><span class="hljs-meta prompt_"># </span><span class="language-bash">/var/lib/zerotier-one</span><br>mkdir moons.d<br>mv ./*.moon ./moons.d/<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">重启服务</span><br>service zerotier-one restart<br></code></pre></td></tr></table></figure></li><li><p>检查是否成功连上节点</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">zerotier-cli listpeers<br></code></pre></td></tr></table></figure><ul><li><strong>&lt;role&gt;<strong>里面有出现</strong>MOON</strong>那就是<strong>成功加入了</strong></li></ul></li></ol><p><strong>OpenWrt加moon节点有所不同</strong></p><p>OpenWrt需要修改一个脚本，因为其var目录时一个内存虚拟的临时目录，重启后原有配置不会保留。通过ssh连接OpenWrt（ssh功能可在系统-&gt;管理权中开启）。</p><p>执行命令：<code>vi /etc/init.d/zerotier</code>，在“add_join() {”上方插入两行代码：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$CONFIG_PATH</span>/moons.d<br><span class="hljs-built_in">cp</span> /home/moons.d/* <span class="hljs-variable">$CONFIG_PATH</span>/moons.d/<br></code></pre></td></tr></table></figure><p><img src="/2020/d4436089/5e3e5278d08a31313.png_e1080.jpg" srcset="/img/loading.gif" lazyload alt="修改OpenWrt中ZeroTier的启动脚本"></p><p>脚本修改完成后，在&#x2F;home目录下新建一个moons.d文件夹，将000000xxxx.moon文件上传到该文件夹，在Web页面上重启ZeroTier即可。</p><h2 id="添加sudo管理员权限"><a href="#添加sudo管理员权限" class="headerlink" title="添加sudo管理员权限"></a>添加sudo管理员权限</h2><p>1.切换到root用户下<br>2.添加sudo文件的写权限,命令是:</p><p>sudo chmod u+w &#x2F;etc&#x2F;sudoers<br>3.编辑sudoers文件</p><p>sudo nano &#x2F;etc&#x2F;sudoers<br>找到这行 root ALL&#x3D;(ALL) ALL,在他下面添加</p><p>xxx ALL&#x3D;(ALL) ALL (这里的xxx是你的用户名)<br>4.撤销sudoers文件写权限,命令:</p><p>sudo chmod u-w &#x2F;etc&#x2F;sudoers</p><h2 id="允许root账号登录-并修改root密码"><a href="#允许root账号登录-并修改root密码" class="headerlink" title="允许root账号登录 并修改root密码"></a>允许root账号登录 并修改root密码</h2><ol><li>允许root登录</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/ssh/sshd_config<br></code></pre></td></tr></table></figure><p>将 <code>#PermitRootLogin prohibit password</code> 修改为 <code>PermitRootLogin yes</code></p><ol start="2"><li>修改root密码</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">synouser --setpw root password<br><br>reboot<br></code></pre></td></tr></table></figure><h2 id="查看端口被占用情况"><a href="#查看端口被占用情况" class="headerlink" title="查看端口被占用情况"></a>查看端口被占用情况</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">lsof</span> -i<br><span class="hljs-attribute">lsof</span> -i:<span class="hljs-number">80</span><br><br><span class="hljs-attribute">netstat</span> -tunlp<br><span class="hljs-attribute">netstat</span> -tunlp|grep <span class="hljs-number">80</span><br></code></pre></td></tr></table></figure><h2 id="windows远程"><a href="#windows远程" class="headerlink" title="windows远程"></a>windows远程</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sudo apt-<span class="hljs-built_in">get</span> install xrdp<br></code></pre></td></tr></table></figure><h2 id="route-路由"><a href="#route-路由" class="headerlink" title="route 路由"></a>route 路由</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">Note:</span><br>直接可达, 用 dev 配置路由, 标识符 U<br>间接可达, 用 gw 配置网关路由, 标识符 UG<br></code></pre></td></tr></table></figure><p><strong>route 输出结果解析：</strong></p><ul><li>Destination：目标网络或目标主机</li><li>Gateway：网关地址或 ‘*’ （如未设置）</li><li>Genmask：目标网络的子网掩码；’255.255.255.255’为主机，’0.0.0.0’为缺省路由</li><li>Flags：路由标志<ul><li>U (route is up) ：路由正常</li><li>H (target is a host) ：主机路由</li><li>G (use gateway) ：使用网关的间接路由</li><li>R (reinstate route for dynamic routing) ：为动态选路恢复路由</li><li>D (dynamically installed by daemon or redirect) ：该路由由选路进程或重定向动态创建</li><li>M (modified from routing daemon or rederict) ：该路由已由选路进程或重定向修改</li><li>! (reject route) ：阻塞路由</li></ul></li><li>Metric：通向目标的距离(通常以跳来计算)</li><li>Ref：使用此路由的活动进程个数(Linux内核并不使用)</li><li>Use：查找此路由的次数。根据-F 和 -C的使用，此数值是路由缓存的损失数或采样数</li><li>Iface：使用此路由发送分组的接口（网卡名字）</li><li>MSS：基于此路由的TCP连接的缺省最大报文段长度</li><li>Window：基于此路由的TCP连接的缺省窗口长度</li><li>irtt：初始往返时间。内核用它来猜测最佳TCP协议参数而无须等待(可能很慢的)应答</li><li>HH (cached only)：为缓存过的路由而访问硬件报头缓存的ARP记录和缓存路由的数量。如果缓存过路由的接口(如lo)无须硬件地址则值为-1</li><li>Arp (cached only)：无论缓存路由所用的硬件地址情况如何都进行更新</li></ul><p>route命令从<code>/proc/net/route</code>文件中取数据，设备名不变、目的地址从右到左每两位十六进制显示，标志位有1、3两种，分别是U和UG，掩码和目的地</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">frank@OIKIOU-PQ:~$ <span class="hljs-built_in">cat</span> /proc/net/route<br>Iface   Destination     Gateway         Flags   RefCnt  Use     Metric  Mask            MTU     Window  IRTT                                       <br>eth0    00000000        011015AC        0003    0       0       0       00000000        0       0       0                                          <br>docker0 000011AC        00000000        0001    0       0       0       0000FFFF        0       0       0                                          <br>eth0    001015AC        00000000        0001    0       0       0       00F0FFFF        0       0       0                                          <br>frank@OIKIOU-PQ:~$ route<br>Kernel IP routing table<br>Destination     Gateway         Genmask         Flags Metric Ref    Use Iface<br>default         OIKIOU-PQ.mshom 0.0.0.0         UG    0      0        0 eth0<br>172.17.0.0      0.0.0.0         255.255.0.0     U     0      0        0 docker0<br>172.21.16.0     0.0.0.0         255.255.240.0   U     0      0        0 eth0<br><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">删除默认路由</span><br>route del default<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">linux静态路由查看</span><br>route -n<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">设置指定网段路由</span><br>route add -net 192.168.3.0 netmask 255.255.255.0 gw 192.168.6.66<br><span class="hljs-meta prompt_"># </span><span class="language-bash">或者</span><br>route add -net 192.168.3.0/24 gw 192.168.6.66<br><span class="hljs-meta prompt_"># </span><span class="language-bash">或者 添加特定接口的路由</span><br>route add -net 10.1.1.0/24 dev ztrfyiymyx<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">删除指定网段路由</span><br>route del -net 192.168.3.0 netmask 255.255.255.0<br></code></pre></td></tr></table></figure><p>用电脑代替路由器，必须要启用电脑的IP转发功能，改&#x2F;proc&#x2F;sys&#x2F;net&#x2F;ipv4&#x2F;ip_forward里的内容为1（默认为0），用下面的命令完成<code>echo 1 &gt; /proc/sys/net/ipv4/ip_forward</code><br>网络重启后，上面的文件自动改为0</p><p><strong>永久修改路由：</strong><br>直接执行route命令来添加路由，是不会永久保存的，当网卡重启或者机器重启之后，该路由就失效了。要想永久保存，可以保存到配置文件。linux 默认只支持一条默认路由，当重新启动网口时，会把其他默认路由去掉，只剩下一条该网口生成的默认路由。</p><ol><li><code>/etc/sysconfig/static-routes</code>文件为路由固化文件，但是linux系统一般不会自动生成，需要手动创建。</li><li>在文件内编辑路由，路由格式是固定的：<ul><li>添加默认路由：any net 0.0.0.0 netmask 0.0.0.0 gw 10.60.60.1</li><li>添加网络路由：any net 1.1.1.0 netmask 255.255.255.0 gw 10.60.60.1</li></ul></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">添加到主机的路由：<br>any host 192.168.101.200 gw 192.168.101.1<br>添加到网络的路由：<br>any net 192.168.101.0/24 gw 192.168.101.1<br>any net 1.1.1.0 netmask 255.255.255.0 gw 10.60.60.1<br></code></pre></td></tr></table></figure><h2 id="samba-文件共享"><a href="#samba-文件共享" class="headerlink" title="samba 文件共享"></a>samba 文件共享</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">安装</span><br>sudo apt-get install samba<br><span class="hljs-meta prompt_"># </span><span class="language-bash">配置</span><br>sudo nano /etc/samba/smb.conf<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">在末尾加入如下内容</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">分享名称</span><br>[Pi]<br>    # 说明信息<br>    comment = PiStorage<br>    # 可以访问的用户<br>    valid users = pi,root<br>    # 共享文件的路径,raspberry pi 会自动将连接到其上的外接存储设备挂载到/media/pi/目录下。<br>    path = /media/pi/<br>    # 可被其他人看到资源名称（非内容）<br>    browseable = yes<br>    # 可写<br>    writable = yes<br>    # 新建文件的权限为 664<br>    create mask = 0664<br>    # 新建目录的权限为 775<br>    directory mask = 0775<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">测试配置文件是否有错误，根据提示做相应修改</span><br>testparm<br><span class="hljs-meta prompt_"># </span><span class="language-bash">添加登陆账户并创建密码，必须是 linux 已存在的用户</span><br>sudo smbpasswd -a pi<br><span class="hljs-meta prompt_"># </span><span class="language-bash">重启 samba 服务</span><br>sudo service smbd restart<br><br>sudo /etc/init.d/samba restart<br>sudo /etc/init.d/smbd restart<br>sudo /etc/init.d/nmbd restart<br></code></pre></td></tr></table></figure><h3 id="attention"><a href="#attention" class="headerlink" title="attention"></a>attention</h3><p>出现过win10无法访问，</p><p>“gpedit.msc” “计算机配置”“管理模板”“网络”“Lanman工作站”“启用不安全的来宾登录”&#x3D;“已启用”</p><h2 id="NFS-网络文件系统"><a href="#NFS-网络文件系统" class="headerlink" title="NFS 网络文件系统"></a>NFS 网络文件系统</h2><p>网络文件系统 (Network File System)</p><h2 id="TFTP-文件传输"><a href="#TFTP-文件传输" class="headerlink" title="TFTP 文件传输"></a>TFTP 文件传输</h2><p><em>TFTP</em>（Trivial File Transfer Protocol,简单文件传输协议）</p><h2 id="固定ip"><a href="#固定ip" class="headerlink" title="固定ip"></a>固定ip</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">ens33 是网卡名</span><br>vi /etc/sysconfig/network-scripts/ifcfg-eth0<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">将 BOOTPROTO=dhcp</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">改成</span><br>BOOTPROTO=static3<br><span class="hljs-meta prompt_"># </span><span class="language-bash">增加</span><br>IPADDR=192.168.2.2<br>NETMASK=255.255.255.0<br>GATEWAY=192.168.2.1<br>DNS1=223.5.5.5<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Raspberry</span><br>sudo nano /etc/dhcpcd.conf<br><br><span class="hljs-comment"># 找到如下内容 对应修改即可</span><br><span class="hljs-comment"># Example static IP configuration:</span><br><span class="hljs-comment">#interface eth0</span><br><span class="hljs-comment">#static ip_address=192.168.0.10/24</span><br><span class="hljs-comment">#static ip6_address=fd51:42f8:caae:d92e::ff/64</span><br><span class="hljs-comment">#static routers=192.168.0.1</span><br><span class="hljs-comment">#static domain_name_servers=192.168.0.1 8.8.8.8 fd51:42f8:caae:d92e::1</span><br><br><span class="hljs-comment"># eg.</span><br>interface wlan0<br>static ip_address=192.168.31.222/24<br>static routers=192.168.31.254<br>static domain_name_servers=223.5.5.5 192.168.31.254<br></code></pre></td></tr></table></figure><h2 id="后台执行程序"><a href="#后台执行程序" class="headerlink" title="后台执行程序"></a>后台执行程序</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">基本形式</span><br>nohup command &amp;<br><span class="hljs-meta prompt_"># </span><span class="language-bash">eg.</span><br>nohup ping 1.1.1.1 &amp;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">重定向输出</span><br>nohup command &gt; myout.file 2&gt;&amp;1 &amp;<br><span class="hljs-meta prompt_"># </span><span class="language-bash">eg.</span><br>nohup ping 1.1.1.1 &gt; \myout.file 2&gt;&amp;1 &amp;<br></code></pre></td></tr></table></figure><h2 id="开启路由转发"><a href="#开启路由转发" class="headerlink" title="开启路由转发"></a>开启路由转发</h2><p>临时生效：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">方法1</span><br>echo &quot;1&quot; &gt; /proc/sys/net/ipv4/ip_forward<br><span class="hljs-meta prompt_"># </span><span class="language-bash">方法2</span><br>sudo sh -c &#x27;echo &quot;1&quot; &gt; /proc/sys/net/ipv4/ip_forward&#x27;<br><span class="hljs-meta prompt_"># </span><span class="language-bash">马上生效</span><br>sysctl -p<br></code></pre></td></tr></table></figure><p>永久生效：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/sysctl.conf<br><span class="hljs-meta prompt_"># </span><span class="language-bash">修改设置</span><br>net.ipv4.ip_forward = 1<br></code></pre></td></tr></table></figure><h2 id="aria2-安装"><a href="#aria2-安装" class="headerlink" title="aria2 安装"></a>aria2 安装</h2><h3 id="aria2"><a href="#aria2" class="headerlink" title="aria2"></a>aria2</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">首先，安装：</span><br>sudo apt-get install aria2<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">创建 Aria2 的配置文件夹：</span><br>sudo mkdir /etc/aria2<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">创建 session 和配置文件：</span><br>sudo touch /etc/aria2/aria2.session<br>sudo touch /etc/aria2/aria2.conf<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">编辑 /etc/aria2/aria2.conf：</span><br>sudo nano /etc/aria2/aria2.conf<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># 文件保存相关 ##</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># 文件保存相关 ##</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># 文件保存相关 ##</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">文件保存目录 此处文件保存目录自行设定</span><br>dir=/mnt/usb/aria2<br><span class="hljs-meta prompt_"># </span><span class="language-bash">启用磁盘缓存, 0为禁用缓存, 需1.16以上版本, 默认:16M</span><br>disk-cache=32M<br><span class="hljs-meta prompt_"># </span><span class="language-bash">断点续传</span><br>continue=true<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">文件预分配方式, 能有效降低磁盘碎片, 默认:prealloc</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">预分配所需时间: none &lt; falloc ? trunc &lt; prealloc</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">falloc和trunc则需要文件系统和内核支持</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">NTFS建议使用falloc, EXT3/4建议trunc, MAC 下需要注释此项</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">file-allocation=falloc</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># 下载连接相关 ##</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># 下载连接相关 ##</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># 下载连接相关 ##</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">最大同时下载任务数, 运行时可修改, 默认:5</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">max-concurrent-downloads=5</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">同一服务器连接数, 添加时可指定, 默认:1</span><br>max-connection-per-server=15<br><span class="hljs-meta prompt_"># </span><span class="language-bash">整体下载速度限制, 运行时可修改, 默认:0（不限制）</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">max-overall-download-limit=0</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">单个任务下载速度限制, 默认:0（不限制）</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">max-download-limit=0</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">整体上传速度限制, 运行时可修改, 默认:0（不限制）</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">max-overall-upload-limit=0</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">单个任务上传速度限制, 默认:0（不限制）</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">max-upload-limit=0</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">禁用IPv6, 默认:<span class="hljs-literal">false</span></span><br>disable-ipv6=true<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">最小文件分片大小, 添加时可指定, 取值范围1M -1024M, 默认:20M</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">假定size=10M, 文件为20MiB 则使用两个来源下载; 文件为15MiB 则使用一个来源下载</span><br>min-split-size=10M<br><span class="hljs-meta prompt_"># </span><span class="language-bash">单个任务最大线程数, 添加时可指定, 默认:5</span><br>split=10<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># 进度保存相关 ##</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># 进度保存相关 ##</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># 进度保存相关 ##</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">从会话文件中读取下载任务</span><br>input-file=/etc/aria2/aria2.session<br><span class="hljs-meta prompt_"># </span><span class="language-bash">在Aria2退出时保存错误的、未完成的下载任务到会话文件</span><br>save-session=/etc/aria2/aria2.session<br><span class="hljs-meta prompt_"># </span><span class="language-bash">定时保存会话, 0为退出时才保存, 需1.16.1以上版本, 默认:0</span><br>save-session-interval=60<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># RPC相关设置 ##</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># RPC相关设置 ##</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># RPC相关设置 ##</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">启用RPC, 默认:<span class="hljs-literal">false</span></span><br>enable-rpc=true<br><span class="hljs-meta prompt_"># </span><span class="language-bash">允许所有来源, 默认:<span class="hljs-literal">false</span></span><br>rpc-allow-origin-all=true<br><span class="hljs-meta prompt_"># </span><span class="language-bash">允许外部访问, 默认:<span class="hljs-literal">false</span></span><br>rpc-listen-all=true<br><span class="hljs-meta prompt_"># </span><span class="language-bash">RPC端口, 仅当默认端口被占用时修改</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">rpc-listen-port=6800</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">设置的RPC授权令牌, v1.18.4新增功能, 取代 --rpc-user 和 --rpc-passwd 选项</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">rpc-secret=&lt;TOKEN&gt;</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># BT/PT下载相关 ##</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># BT/PT下载相关 ##</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># BT/PT下载相关 ##</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">当下载的是一个种子(以.torrent结尾)时, 自动开始BT任务, 默认:<span class="hljs-literal">true</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">follow-torrent=<span class="hljs-literal">true</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">客户端伪装, PT需要</span><br>peer-id-prefix=-TR2770-<br>user-agent=Transmission/2.77<br><span class="hljs-meta prompt_"># </span><span class="language-bash">强制保存会话, 即使任务已经完成, 默认:<span class="hljs-literal">false</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">较新的版本开启后会在任务完成后依然保留.aria2文件</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">force-save=<span class="hljs-literal">false</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">继续之前的BT任务时, 无需再次校验, 默认:<span class="hljs-literal">false</span></span><br>bt-seed-unverified=true<br><span class="hljs-meta prompt_"># </span><span class="language-bash">保存磁力链接元数据为种子文件(.torrent文件), 默认:<span class="hljs-literal">false</span></span><br>bt-save-metadata=true<br></code></pre></td></tr></table></figure><p>然后执行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo aria2c --conf-path=/etc/aria2/aria2.conf -D<br></code></pre></td></tr></table></figure><p>没有任何提示则表示成功。接下来添加开机自启：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo touch /etc/init.d/aria2c<br>sudo nano /etc/init.d/aria2c<br></code></pre></td></tr></table></figure><p>添加：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br><span class="hljs-comment">### BEGIN INIT INFO</span><br><span class="hljs-comment"># Provides:          aria2</span><br><span class="hljs-comment"># Required-Start:    remotefsnetwork</span><br><span class="hljs-comment"># Required-Stop:     remotefsnetwork</span><br><span class="hljs-comment"># Default-Start:     2 3 4 5</span><br><span class="hljs-comment"># Default-Stop:      0 1 6</span><br><span class="hljs-comment"># Short-Description: Aria2 Downloader</span><br><span class="hljs-comment">### END INIT INFO</span><br> <br><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> <span class="hljs-keyword">in</span><br>start)<br>    <span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;Starting aria2c&quot;</span><br>    sudo aria2c --conf-path=/etc/aria2/aria2.conf -D<br><br>;;<br>stop)<br>    <span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;Shutting down aria2c &quot;</span><br>    killall aria2c<br>;;<br>restart)<br>    <span class="hljs-comment"># killall aria2c</span><br>    sudo aria2c --conf-path=/etc/aria2/aria2.conf -D<br><br>;;<br><span class="hljs-keyword">esac</span><br><span class="hljs-built_in">exit</span><br></code></pre></td></tr></table></figure><p>执行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo chmod +x /etc/init.d/aria2c<br></code></pre></td></tr></table></figure><h3 id="安装aria2的web管理界面（AriaNg）"><a href="#安装aria2的web管理界面（AriaNg）" class="headerlink" title="安装aria2的web管理界面（AriaNg）"></a>安装aria2的web管理界面（AriaNg）</h3><p>这里需要用到一个第三方的工具，这个是通过rpc接口来管理aria2下载的工具。</p><p>安装git和nginx</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt install -y git nginx<br></code></pre></td></tr></table></figure><p>下载aira-ng</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">wget https://github.com/mayswind/AriaNg/releases/download/1.1.4/aria-ng-1.1.4.zip -O aira-ng.zip<br></code></pre></td></tr></table></figure><p>解压</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">unzip aira-ng.zip -d aira-ng<br></code></pre></td></tr></table></figure><p>将aira-ng放到nginx的&#x2F;var&#x2F;www&#x2F;html&#x2F;目录下，然后设置开机启动nginx</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo mv aira-ng /var/www/html/<br>sudo systemctl enable nginx<br></code></pre></td></tr></table></figure><p>用浏览器访问树莓派IP下的aira-ng，即：<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=http://ip/aira-ng">http://ip/aira-ng</a></p><p>然后在系统设置点击AriaNg设置 –&gt; 全局 –&gt; 设置语言为中文 –&gt; 点击RPC–&gt;修改为 rpc 密钥：secret</p><h3 id="aria2-自动更新tracker"><a href="#aria2-自动更新tracker" class="headerlink" title="aria2 自动更新tracker"></a>aria2 自动更新tracker</h3><p><a target="_blank" rel="noopener" href="https://www.moerats.com/archives/374/">https://www.moerats.com/archives/374/</a></p><h2 id="安装SSH服务端"><a href="#安装SSH服务端" class="headerlink" title="安装SSH服务端"></a>安装SSH服务端</h2><h3 id="WSL-Ubuntu"><a href="#WSL-Ubuntu" class="headerlink" title="WSL Ubuntu"></a>WSL Ubuntu</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">设置root的口令（密码），用作后续登陆使用</span><br>sudo passwd root<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">安装openssh-server（ubuntu自带已安装，但是我使用有问题，没找到原因）</span><br>sudo apt remove openssh-server<br>sudo apt install openssh-client openssh-server<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">备份原始的sshd_config</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ssh_config是针对客户端的配置文件</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">sshd_config是针对服务端的配置文件</span><br>sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak<br>sudo cp /etc/ssh/ssh_config /etc/ssh/ssh_config.bak<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">使用vim进行编辑，按i进入insert模式</span><br>sudo vim /etc/ssh/sshd_config<br><br>在vim中找到对应项并修改，ESC，输入`wq`保存退出：<br>Port 2222<br>ListenAddress 0.0.0.0        # 如果需要指定监听的IP则去除最左侧的井号，并配置对应IP，默认即监听PC所有IP<br>PermitRootLogin no           # 如果你需要用 root 直接登录系统则此处改为 yes<br>PasswordAuthentication yes    # 将 no 改为 yes 表示使用帐号密码方式登录<br>TCPKeepAlive yes             # <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">启动ssh，查看status</span><br>sudo service ssh start             #启动SSH服务<br>sudo service ssh status            #检查状态<br>sudo systemctl enable ssh          #开机自动启动ssh命令，WSL下无效<br></code></pre></td></tr></table></figure><h2 id="SSH主动断开连接"><a href="#SSH主动断开连接" class="headerlink" title="SSH主动断开连接"></a>SSH主动断开连接</h2><blockquote><p>network error: software caused connection abort</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash"></span><br><span class="language-bash">sudo vim /etc/ssh/sshd_config</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">找到TCPKeepAlive将其配置为<span class="hljs-built_in">yes</span> 保持TCP的连接</span><br>TCPKeepAlive yes<br><span class="hljs-meta prompt_"># </span><span class="language-bash">将 ‘ClientAliveInterval’ 设定成 60s</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ClientAliveInterval指定了服务器端向客户端请求消息的时间间隔, 默认是0，不发送。而ClientAliveInterval 60表示每分钟发送一次，然后客户端响应，这样就保持长连接了。</span><br>ClientAliveInterval 60<br><span class="hljs-meta prompt_"># </span><span class="language-bash">ClientAliveCountMax，使用默认值3即可。ClientAliveCountMax表示服务器发出请求后客户端没有响应的次数达到一定值，就自动断开</span><br>ClientAliveCountMax 3<br></code></pre></td></tr></table></figure><h2 id="SSH连接Linux时自动启动某个脚本"><a href="#SSH连接Linux时自动启动某个脚本" class="headerlink" title="SSH连接Linux时自动启动某个脚本"></a>SSH连接Linux时自动启动某个脚本</h2><p>etc目录下有一个profile文件，在文件末尾加上脚本命令，或者脚本目录地址。(切换root用户)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo vim /etc/profile<br></code></pre></td></tr></table></figure><p>在 <code>/etc/ssh/</code> 目录下面创建一个 <code>sshrc</code> 的文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br></code></pre></td></tr></table></figure><h2 id="配置-SSH-密钥登录-免密码"><a href="#配置-SSH-密钥登录-免密码" class="headerlink" title="配置 SSH 密钥登录(免密码)"></a>配置 SSH 密钥登录(免密码)</h2><blockquote><p><strong>一、第一次登录远程主机流程</strong></p><p>第一次ssh到远程主机时远程主机会发送它的公钥到客户端主机，客户机确认继续连接后会把远程主机的公钥保存到.ssh&#x2F;known_hosts文件，下次再连接此远程主机时会去.ssh&#x2F;known_hosts查看，如果是已经保存的公钥证明是信任主机，即不会告警并直接提示输入用户名密码登录。</p><ul><li>如果中途SSH提示你对方的密钥指纹发生了变化那这个时候你就要担心了, 可能存在MITM(Man-In-The-Middle-Attack 中间人攻击)<ul><li>远程主机的这些操作会导致密钥指纹发生变化</li><li>重新安装了操作系统</li><li>重新安装了openssh或者手动更新了&#x2F;etc&#x2F;ssh下的密钥对</li></ul></li></ul><blockquote><p>虽然有著名的DH密钥交换算法，但SSH<strong>原理上</strong>不能抵御中间人攻击。然而实际上，SSH使用<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Trust_on_first_use">TOFU</a>安全模型等同于做到了防中间人攻击。SSH的首次连接会下载服务端的公钥，用户确认后公钥将被保存并信任。下次访问时客户端将会核对服务端发来的公钥和本地保存的是否相同，不同就发出中间人攻击的警告拒绝连接，除非用户手动清除已保存的公钥。所以，<strong>如果首次连接没有中间人，之后的连接就无需担心中间人</strong>，因为中间人给出的公钥和服务端给出的公钥相同的可能性可以忽略。如果首次连接就有中间人攻击，那么恭喜你中奖了。</p></blockquote><p><strong>二、密码登录流程</strong></p><p>远程主机收到客户端请求后会把自己的公钥发送给客户端，客户端通过公钥加密之后将密码发送给远程主机，远程主机用密钥解密，密码如果正确则登录成功。</p><p><strong>三、公钥登录（免密登录）流程</strong></p><p>公钥登录原理就是客户端将自己的公钥存储到远程主机的.ssh&#x2F;authorized_keys中，客户端发起登录时，远程主机会发送一段随机字符串给客户端，客户端用自己的私钥加密后重新发回远程主机，远程主机用存储的客户端公钥解密之后对比之前发送给客户端的字符串，相同的话即认为客户机认证，不在需要输入密码直接登录系统。</p></blockquote><ol><li><p>client机器生成密钥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">ssh-keygen<br><span class="hljs-meta prompt_"># </span><span class="language-bash">或者</span> <br>ssh-keygen -t rsa<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">注意 RSA 现阶段不再建议使用了, 改成ed25519生成</span><br>ssh-keygen -t ed25519 -C &quot;your_email@example.com&quot;<br></code></pre></td></tr></table></figure><p><a target="_blank" rel="noopener" href="https://confluence.atlassian.com/bitbucketserverkb/ssh-rsa-key-rejected-with-message-no-mutual-signature-algorithm-1026057701.html">RSA 现阶段不再建议使用了</a></p></li><li><p>client查看<code>~/.ssh/id_rsa.pub</code>文件内容, 并复制</p></li><li><p>server编辑SSH的配置<code>vim /etc/ssh/sshd_config</code></p><ol><li>将<code>PubkeyAuthentication</code> 配置成<code>yes</code>, 允许密钥登录</li><li>重启ssh服务 <code>systemctl restart sshd</code></li></ol></li><li><p>server生成密钥</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">ssh-keygen</span><br></code></pre></td></tr></table></figure></li><li><p>server创建<code>~/.ssh/authorized_keys</code>文件, 并将client的公钥(<code>~/.ssh/id_rsa.pub</code>)内容粘贴进去</p><ul><li>需要注意的是<code>.ssh文件夹的权限应当为700，authorized_keys文件的权限应该为600</code></li><li>可以直接使用命令<code>cat .ssh/id_rsa.pub | ssh user_name@xxx.xxx.xxx.xx &#39;cat &gt;&gt; .ssh/authorized_keys&#39;</code></li></ul></li><li><p>client使用指定私钥登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh -i /root/.ssh/id_rsa user@ip_or_domain<br></code></pre></td></tr></table></figure></li><li><p>测试登录OK后建议关闭密码登录(不安全), 同时Root用户也建议禁止登录</p><p><code>PasswordAuthentication no</code>, <code>PermitRootLogin no</code></p></li></ol><h2 id="SSH-config"><a href="#SSH-config" class="headerlink" title="SSH config"></a>SSH config</h2><p>SSH 的配置文件有两个：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">~/.ssh/config            <span class="hljs-comment"># 用户配置文件</span><br>/etc/ssh/ssh_config      <span class="hljs-comment"># 系统配置文件</span><br></code></pre></td></tr></table></figure><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs crmsh"><span class="hljs-comment"># comment! </span><br>Host pq.github.com<br>  HostName github.com           <span class="hljs-comment"># 目标服务器地址</span><br>  <span class="hljs-keyword">User</span> <span class="hljs-title">git</span>                      <span class="hljs-comment"># 用户名</span><br>  Port <span class="hljs-number">22</span>                       <span class="hljs-comment"># 端口</span><br>  IdentityFile ~/.ssh/id_rsa    <span class="hljs-comment"># 密钥-&gt;私钥</span><br></code></pre></td></tr></table></figure><blockquote><h3 id="配置项说明"><a href="#配置项说明" class="headerlink" title="配置项说明"></a>配置项说明</h3><p>SSH 的配置文件有两个：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-variable">$ </span>~<span class="hljs-regexp">/.ssh/config</span>            <span class="hljs-comment"># 用户配置文件</span><br><span class="hljs-variable">$ </span>/etc/ssh/ssh_config      <span class="hljs-comment"># 系统配置文件</span><br></code></pre></td></tr></table></figure><p>下面来看看常用的配置参数。</p><p><strong>Host</strong><br>用于我们执行 SSH 命令的时候如何匹配到该配置。</p><ul><li><code>*</code>，匹配所有主机名。</li><li><code>*.example.com</code>，匹配以 .example.com 结尾。</li><li><code>!*.dialup.example.com,*.example.com</code>，以 ! 开头是排除的意思。</li><li><code>192.168.0.?</code>，匹配 192.168.0.[0-9] 的 IP。</li></ul><p><strong>AddKeysToAgent</strong><br>是否自动将 key 加入到 <code>ssh-agent</code>，值可以为 no(default)&#x2F;confirm&#x2F;ask&#x2F;yes。</p><p>如果是 yes，key 和密码都将读取文件并以加入到 agent ，就像 <code>ssh-add</code>。其他分别是询问、确认、不加入的意思。添加到 ssh-agent 意味着将私钥和密码交给它管理，让它来进行身份认证。</p><p><strong>AddressFamily</strong><br>指定连接的时候使用的地址族，值可以为 any(default)&#x2F;inet(IPv4)&#x2F;inet6(IPv6)。</p><p><strong>BindAddress</strong><br>指定连接的时候使用的本地主机地址，只在系统有多个地址的时候有用。在 UsePrivilegedPort 值为 yes 的时候无效。</p><p><strong>ChallengeResponseAuthentication</strong><br>是否响应支持的身份验证 chanllenge，yes(default)&#x2F;no。</p><p><strong>Compression</strong><br>是否压缩，值可以为 no(default)&#x2F;yes。</p><p><strong>CompressionLevel</strong><br>压缩等级，值可以为 1(fast)-9(slow)。6(default)，相当于 gzip。</p><p><strong>ConnectionAttempts</strong><br>退出前尝试连接的次数，值必须为整数，1(default)。</p><p><strong>ConnectTimeout</strong><br>连接 SSH 服务器超时时间，单位 s，默认系统 TCP 超时时间。</p><p><strong>ControlMaster</strong><br>是否开启单一网络共享多个 session，值可以为 no(default)&#x2F;yes&#x2F;ask&#x2F;auto。需要和 ControlPath 配合使用，当值为 yes 时，ssh 会监听该路径下的 control socket，多个 session 会去连接该 socket，它们会尽可能的复用该网络连接而不是重新建立新的。</p><p><strong>ControlPath</strong><br>指定 control socket 的路径，值可以直接指定也可以用一下参数代替：</p><ul><li>%L 本地主机名的第一个组件</li><li>%l 本地主机名（包括域名）</li><li>%h 远程主机名（命令行输入）</li><li>%n 远程原始主机名</li><li>%p 远程主机端口</li><li>%r 远程登录用户名</li><li>%u 本地 ssh 正在使用的用户名</li><li>%i 本地 ssh 正在使用 uid</li><li>%C 值为 %l%h%p%r 的 hash</li></ul><p>请最大限度的保持 ControlPath 的唯一。至少包含 %h，%p，%r（或者 %C）。</p><p><strong>ControlPersist</strong><br>结合 ControlMaster 使用，指定连接打开后后台保持的时间。值可以为 no&#x2F;yes&#x2F;整数，单位 s。如果为 no，最初的客户端关闭就关闭。如果 yes&#x2F;0，无限期的，直到杀死或通过其它机制，如：ssh -O exit。</p><p><strong>GatewayPorts</strong><br>指定是否允许远程主机连接到本地转发端口，值可以为 no(default)&#x2F;yes。默认情况，ssh 为本地回环地址绑定了端口转发器。</p><p><strong>HostName</strong><br>真实的主机名，默认值为命令行输入的值（允许 IP）。你也可以使用 %h，它将自动替换，只要替换后的地址是完整的就 ok。</p><p><strong>IdentitiesOnly</strong><br>指定 ssh 只能使用配置文件指定的 identity 和 certificate 文件或通过 ssh 命令行通过身份验证，即使 ssh-agent 或 PKCS11Provider 提供了多个 identities。值可以为 no(default)&#x2F;yes。</p><p><strong>IdentityFile</strong><br>指定读取的认证文件路径，允许 DSA，ECDSA，Ed25519 或 RSA。值可以直接指定也可以用一下参数代替：</p><ul><li>%d，本地用户目录 ~</li><li>%u，本地用户</li><li>%l，本地主机名</li><li>%h，远程主机名</li><li>%r，远程用户名</li></ul><p><strong>LocalCommand</strong><br>指定在连接成功后，本地主机执行的命令（单纯的本地命令）。可使用 %d，%h，%l，%n，%p，%r，%u，%C 替换部分参数。只在 PermitLocalCommand 开启的情况下有效。</p><p><strong>LocalForward</strong><br>指定本地主机的端口通过 ssh 转发到指定远程主机。格式：LocalForward [bind_address:]post host:hostport，支持 IPv6。</p><p><strong>PasswordAuthentication</strong><br>是否使用密码进行身份验证，yes(default)&#x2F;no。</p><p><strong>PermitLocalCommand</strong><br>是否允许指定 LocalCommand，值可以为 no(default)&#x2F;yes。</p><p><strong>Port</strong><br>指定连接远程主机的哪个端口，22(default)。</p><p><strong>ProxyCommand</strong><br>指定连接的服务器需要执行的命令。%h，%p，%r</p><p>如：ProxyCommand &#x2F;usr&#x2F;bin&#x2F;nc -X connect -x 192.0.2.0:8080 %h %p</p><p><strong>User</strong><br>登录用户名</p></blockquote><h2 id="查看ssh登录失败记录"><a href="#查看ssh登录失败记录" class="headerlink" title="查看ssh登录失败记录"></a>查看ssh登录失败记录</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">查看并筛选 失败次数大于3次的 ip</span><br>sudo lastb |awk &#x27;&#123;print $3&#125;&#x27;|sort |uniq -c|awk &#x27;&#123;if ($1 &gt; 3) print $2&#125;&#x27;<br>sudo lastb |awk &#x27;&#123;print $3&#125;&#x27;|sort |uniq -c|sort -bn|awk &#x27;&#123;if ($1 &gt; 3) print&#125;&#x27;<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">写一个脚本 统计一下ip 将这些ip禁止</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">-------------------------------</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br>list=$( sudo lastb |awk &#x27;&#123;print $3&#125;&#x27;|sort |uniq -c|awk &#x27;&#123;if ($1 &gt; 3) print $2&#125;&#x27; )<br>for ip in $&#123;list&#125;<br>do<br><span class="hljs-meta prompt_">	# </span><span class="language-bash"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;ip&#125;</span></span><br><span class="hljs-meta prompt_">	# </span><span class="language-bash">下面这个是加入黑名单</span><br><span class="hljs-meta prompt_">	# </span><span class="language-bash"><span class="hljs-built_in">echo</span> ALL: <span class="hljs-variable">$&#123;ip&#125;</span> &gt;&gt; /etc/hosts.deny <span class="hljs-comment">#加入黑名单</span></span><br><span class="hljs-meta prompt_">	# </span><span class="language-bash">这个是加入防火墙的禁止规则</span><br>	ufw deny from $&#123;ip&#125;<br>done<br>echo &gt; /var/log/btmp    #清空失败记录，防止脚本下次执行重复统计IP<br><span class="hljs-meta prompt_"># </span><span class="language-bash">-------------------------------</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">定时执行 ssh密码错误没找到回调函数, 这里要是有回调函数处理起来就很及时了</span><br><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">crontab -e</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">内容为每天12:12执行一次脚本</span><br>12 12 * * * /bin/bash /home/xx/xx.sh<br></code></pre></td></tr></table></figure><h2 id="hosts文件"><a href="#hosts文件" class="headerlink" title="hosts文件"></a>hosts文件</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/ets/</span>hosts<br></code></pre></td></tr></table></figure><h2 id="服务器测试工具"><a href="#服务器测试工具" class="headerlink" title="服务器测试工具"></a>服务器测试工具</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget -qO- --no-check-certificate https://raw.githubusercontent.com/oooldking/script/master/superbench.sh | bash<br></code></pre></td></tr></table></figure><p>或者</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -Lso- -no-check-certificate https://raw.githubusercontent.com/oooldking/script/master/superbench.sh | bash<br></code></pre></td></tr></table></figure><h2 id="搭建简易文件服务器http-server-wget下载"><a href="#搭建简易文件服务器http-server-wget下载" class="headerlink" title="搭建简易文件服务器http server wget下载"></a>搭建简易文件服务器http server wget下载</h2><p>两台服务器之间传递文件，可以使用http server，参考文章：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/f61151abb7a5">python开启http服务传输文件</a>.<br>在需要提供服务的主机中运行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Python &lt;= 2.3</span><br>python -c <span class="hljs-string">&quot;import SimpleHTTPServer as s; s.test();&quot;</span> 8000<br><br><span class="hljs-comment"># Python &gt;= 2.4</span><br>python -m SimpleHTTPServer 8000<br><br><span class="hljs-comment"># Python 3.x</span><br>python -m http.server 8000<br></code></pre></td></tr></table></figure><blockquote><p>如果目录有一个名为index.html的文件，该文件将作为初始文件。如果没有index.html，则将列出目录中的文件。</p></blockquote><p>访问：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget ip:8080/filename<br></code></pre></td></tr></table></figure><h2 id="查看支持的shell"><a href="#查看支持的shell" class="headerlink" title="查看支持的shell"></a>查看支持的shell</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">cat <span class="hljs-regexp">/etc/</span>shells<br></code></pre></td></tr></table></figure><h2 id="uninx-资源管理器"><a href="#uninx-资源管理器" class="headerlink" title="uninx 资源管理器"></a>uninx 资源管理器</h2><h3 id="Glances"><a href="#Glances" class="headerlink" title="Glances"></a>Glances</h3><p>适合运维、云端开发人员或命令行爱好者</p><p><img src="/2020/d4436089/webp.webp" srcset="/img/loading.gif" lazyload alt="img"></p><p>安装：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-variable">$ </span>sudo pip3 install glances<br></code></pre></td></tr></table></figure><p>启动：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-variable">$ </span>sudo glances<br></code></pre></td></tr></table></figure><h3 id="Sysmontask"><a href="#Sysmontask" class="headerlink" title="Sysmontask"></a>Sysmontask</h3><p>适合桌面端用户，界面仿照 <code>Win10</code> 资源管理器，提供更多信息更直观</p><p><img src="/2020/d4436089/webp-16552860429952.webp" srcset="/img/loading.gif" lazyload alt="img"></p><p>安装：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-variable">$ </span>sudo pip3 install sysmontask<br></code></pre></td></tr></table></figure><p>启动:</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-variable">$ </span>sudo sysmontask<br></code></pre></td></tr></table></figure><h3 id="bpytop"><a href="#bpytop" class="headerlink" title="bpytop"></a>bpytop</h3><p>github: <a target="_blank" rel="noopener" href="https://github.com/aristocratos/bpytop">https://github.com/aristocratos/bpytop</a></p><p><img src="/2020/d4436089/main-16552870928465.png" srcset="/img/loading.gif" lazyload alt="main"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 安装</span><br>git <span class="hljs-built_in">clone</span> https://github.com/aristocratos/bpytop.git<br><span class="hljs-built_in">cd</span> bpytop<br>sudo make install<br></code></pre></td></tr></table></figure><h2 id="清理RAM-Cache"><a href="#清理RAM-Cache" class="headerlink" title="清理RAM Cache"></a>清理RAM Cache</h2><hr><p><em><strong>Sync</strong></em></p><blockquote><p>操作系统在运行过程中,会把访问到的文件放到buffer中。为了避免断电,等故障造成数据丢失,我们需要把buffer中的缓存数据写入到磁盘</p></blockquote><hr><p><em><strong>手动释放内存的命令</strong></em></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> 3 &gt; /proc/sys/vm/drop_caches<br></code></pre></td></tr></table></figure><blockquote><p>drop_caches的值可以是0-3之间的数字，代表不同的含义：</p></blockquote><ul><li>0：不释放（系统默认值）</li><li>1：释放页缓存</li><li>2：释放dentries和inodes</li></ul><hr><h2 id="设置代理"><a href="#设置代理" class="headerlink" title="设置代理"></a>设置代理</h2><p>编辑文件&#x2F;etc&#x2F;profile，增加如下两行, 临时使用直接export即可</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">http_proxy</span>=http://proxy.com:8080/<br><span class="hljs-built_in">export</span> <span class="hljs-attribute">https_proxy</span>=http://proxy.com:8080/<br></code></pre></td></tr></table></figure><p>然后更新一下环境文件：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">source</span> <span class="hljs-regexp">/etc/</span>profile<br></code></pre></td></tr></table></figure><table><thead><tr><th align="left">环境变量</th><th align="left">描述</th><th align="left">值示例</th></tr></thead><tbody><tr><td align="left">http_proxy</td><td align="left">为http变量设置代理；默认不填开头以http协议传输</td><td align="left">10.0.0.51:8080 user:<a href="mailto:&#112;&#x61;&#115;&#115;&#x40;&#x31;&#x30;&#x2e;&#48;&#46;&#x30;&#46;&#49;&#x30;">&#112;&#x61;&#115;&#115;&#x40;&#x31;&#x30;&#x2e;&#48;&#46;&#x30;&#46;&#49;&#x30;</a>:8080 socks4:&#x2F;&#x2F;10.0.0.51:1080 socks5:&#x2F;&#x2F;192.168.1.1:1080</td></tr><tr><td align="left">https_proxy</td><td align="left">为https变量设置代理；</td><td align="left">同上</td></tr><tr><td align="left">ftp_proxy</td><td align="left">为ftp变量设置代理；</td><td align="left">同上</td></tr><tr><td align="left">all_proxy</td><td align="left">全部变量设置代理，设置了这个时候上面的不用设置</td><td align="left">同上</td></tr><tr><td align="left">no_proxy</td><td align="left">无需代理的主机或域名； 可以使用通配符； 多个时使用“,”号分隔；</td><td align="left"><em>.aiezu.com,10.</em>.<em>.</em>,192.168.<em>.</em>, *.local,localhost,127.0.0.1</td></tr></tbody></table><h3 id="脚本为WSL设置代理"><a href="#脚本为WSL设置代理" class="headerlink" title="脚本为WSL设置代理"></a>脚本为WSL设置代理</h3><p><strong>WSL 中获取宿主机 IP</strong></p><p>WSL 每次启动的时候都会有不同的 IP 地址，所以并不能直接用静态的方式来设置代理。WSL2 会把 IP 写在 <code>/etc/resolv.conf</code>中，因此可以用 <code>cat /etc/resolv.conf | grep nameserver | awk &#39;&#123; print $2 &#125;&#39;</code> 这条指令获得宿主机 IP 。</p><p><strong>设置代理</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br>hostip=$(<span class="hljs-built_in">cat</span> /etc/resolv.conf | grep nameserver | awk <span class="hljs-string">&#x27;&#123; print $2 &#125;&#x27;</span>)<br>wslip=$(hostname -I | awk <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span>)<br>http_port=&lt;PORT&gt;<br>socks5_port=&lt;PORT&gt;<br><br>PROXY_HTTP=<span class="hljs-string">&quot;http://<span class="hljs-variable">$&#123;hostip&#125;</span>:<span class="hljs-variable">$&#123;http_port&#125;</span>&quot;</span><br>PROXY_SOCKS5=<span class="hljs-string">&quot;socks5://<span class="hljs-variable">$&#123;hostip&#125;</span>:<span class="hljs-variable">$&#123;socks5_port&#125;</span>&quot;</span><br><br><span class="hljs-function"><span class="hljs-title">set_proxy</span></span>()&#123;<br>    <span class="hljs-built_in">export</span> http_proxy=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;PROXY_HTTP&#125;</span>&quot;</span><br>    <span class="hljs-built_in">export</span> HTTP_PROXY=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;PROXY_HTTP&#125;</span>&quot;</span><br><br>    <span class="hljs-built_in">export</span> https_proxy=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;PROXY_HTTP&#125;</span>&quot;</span><br>    <span class="hljs-built_in">export</span> HTTPS_PROXY=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;PROXY_HTTP&#125;</span>&quot;</span><br><br>    <span class="hljs-built_in">export</span> all_proxy=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;PROXY_SOCKS5&#125;</span>&quot;</span><br>    <span class="hljs-built_in">export</span> ALL_PROXY=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;PROXY_SOCKS5&#125;</span>&quot;</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">unset_proxy</span></span>()&#123;<br>    <span class="hljs-built_in">unset</span> http_proxy<br>    <span class="hljs-built_in">unset</span> HTTP_PROXY<br>    <span class="hljs-built_in">unset</span> https_proxy<br>    <span class="hljs-built_in">unset</span> HTTPS_PROXY<br>    <span class="hljs-built_in">unset</span> all_proxy<br>    <span class="hljs-built_in">unset</span> ALL_PROXY<br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">test_setting</span></span>()&#123;<br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Host ip:&quot;</span> <span class="hljs-variable">$&#123;hostip&#125;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;WSL ip:&quot;</span> <span class="hljs-variable">$&#123;wslip&#125;</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Current https_proxy:&quot;</span> <span class="hljs-variable">$https_proxy</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Current all_proxy:&quot;</span> <span class="hljs-variable">$all_proxy</span><br>&#125;<br><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> = <span class="hljs-string">&quot;set&quot;</span> ]<br><span class="hljs-keyword">then</span><br>    set_proxy<br><br><span class="hljs-keyword">elif</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> = <span class="hljs-string">&quot;unset&quot;</span> ]<br><span class="hljs-keyword">then</span><br>    unset_proxy<br><br><span class="hljs-keyword">elif</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$1</span>&quot;</span> = <span class="hljs-string">&quot;test&quot;</span> ]<br><span class="hljs-keyword">then</span><br>    test_setting<br><span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Unsupported arguments.&quot;</span><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><p><strong>!!注意!!</strong></p><p>之后运行 <code>. ./proxy.sh set</code> 就可以自动设置代理了。<code>unset</code> 可以取消代理，test 可以查看代理状态，能够用来检查环境变量是否被正确修改。</p><p>运行的时候不要忘记之前的 <code>.</code>，或者使用 <code>source ./proxy.sh set</code>，只有这样才能够修改环境变量</p><p>直接运行例如 <code>./proxy.sh set</code> 或者 <code>sh proxy.sh set</code>，这样会是运行在一个子 shell 中，对当前 shell 没有效果</p><p>另外可以在 <code>~/.bashrc</code> 中选择性的加上下面两句话，记得将里面的路径修改成你放这个脚本的路径。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">alias proxy=&quot;source /path/to/proxy.sh&quot;<br>. /path/to/proxy.sh set<br></code></pre></td></tr></table></figure><p>第一句话可以为这个脚本设置别名 proxy，这样在任何路径下都可以通过 proxy 命令使用这个脚本了，之后在任何路径下，都可以随时都可以通过输入<code>proxy unset</code> 来暂时取消代理。</p><p>第二句话就是在每次 shell 启动的时候运行该脚本实现自动设置代理，这样以后不用额外操作就默认设置好代理啦~</p><h2 id="获取IP归属地"><a href="#获取IP归属地" class="headerlink" title="获取IP归属地"></a>获取IP归属地</h2><blockquote><p><a href="http://ip-[api](https://so.csdn.net/so/search?q=api&spm=1001.2101.3001.7020).com/json/">http://ip-[api](https://so.csdn.net/so/search?q=api&amp;spm=1001.2101.3001.7020).com/json/</a> # 国际化英文显示</p><p><a target="_blank" rel="noopener" href="http://ip-api.com/json/?lang=zh-CN">http://ip-api.com/json/?lang=zh-CN</a>　　# 中文显示</p><p><a target="_blank" rel="noopener" href="http://ip-api.com/json/8.8.8.8?lang=zh-CN">http://ip-api.com/json/8.8.8.8?lang=zh-CN</a> #查询某个ip的信息</p></blockquote><h2 id="使用-curl-测试网站加载速度"><a href="#使用-curl-测试网站加载速度" class="headerlink" title="使用 curl 测试网站加载速度"></a>使用 curl 测试网站加载速度</h2><p><a href="###curl">参考Curl章节-w参数</a></p><h2 id="rsync-同步工具"><a href="#rsync-同步工具" class="headerlink" title="rsync 同步工具"></a>rsync 同步工具</h2><p><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Rsync#Full_system_backup">Full system backup</a></p><p><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2020/08/rsync.html">rsync 用法教程_阮一峰</a></p><p>备份远程主机 <code>192.168.1.1</code> 的 <code>/</code>目录, 到本地<code>./xx_backup/</code> , 并排除一些文件, 生成日志</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">rsync -a -e &quot;ssh -p 22&quot; --exclude=&#123;&quot;/dev/*&quot;,&quot;/proc/*&quot;,&quot;/sys/*&quot;,&quot;/tmp/*&quot;,&quot;/run/*&quot;,&quot;/mnt/*&quot;,&quot;/media/*&quot;,&quot;/lost+found&quot;&#125; user@192.168.1.1:/ ./xx_backup | tee ./xx_backup.log<br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">&quot;ssh -p 22&quot;</span>         22 = port = 端口号</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">user@192.168.1.1  user = user = 用户名</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">192.168.1.1       = ip</span><br></code></pre></td></tr></table></figure><h3 id="r-参数"><a href="#r-参数" class="headerlink" title="-r 参数"></a><code>-r</code> 参数</h3><p>本机使用 rsync 命令时，可以作为<code>cp</code>和<code>mv</code>命令的替代方法，将源目录同步到目标目录。</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ rsync -r <span class="hljs-built_in">source</span> destination<br></code></pre></td></tr></table></figure></blockquote><p>上面命令中，<code>-r</code>表示递归，即包含子目录。注意，<code>-r</code>是必须的，否则 rsync 运行不会成功。<code>source</code>目录表示源目录，<code>destination</code>表示目标目录。</p><p>如果有多个文件或目录需要同步，可以写成下面这样。</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ rsync -r source1 source2 destination<br></code></pre></td></tr></table></figure></blockquote><p>上面命令中，<code>source1</code>、<code>source2</code>都会被同步到<code>destination</code>目录。</p><h3 id="a-参数"><a href="#a-参数" class="headerlink" title="-a 参数"></a><code>-a</code> 参数</h3><p><code>-a</code>参数可以替代<code>-r</code>，除了可以递归同步以外，还可以同步元信息（比如修改时间、权限等）。由于 rsync 默认使用文件大小和修改时间决定文件是否需要更新，所以<code>-a</code>比<code>-r</code>更有用。下面的用法才是常见的写法。</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ rsync -a <span class="hljs-built_in">source</span> destination<br></code></pre></td></tr></table></figure></blockquote><p>目标目录<code>destination</code>如果不存在，rsync 会自动创建。执行上面的命令后，源目录<code>source</code>被完整地复制到了目标目录<code>destination</code>下面，即形成了<code>destination/source</code>的目录结构。</p><p>如果只想同步源目录<code>source</code>里面的内容到目标目录<code>destination</code>，则需要在源目录后面加上斜杠。</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ rsync -a <span class="hljs-built_in">source</span>/ destination<br></code></pre></td></tr></table></figure></blockquote><p>上面命令执行后，<code>source</code>目录里面的内容，就都被复制到了<code>destination</code>目录里面，并不会在<code>destination</code>下面创建一个<code>source</code>子目录。</p><h3 id="n-参数"><a href="#n-参数" class="headerlink" title="-n 参数"></a><code>-n</code> 参数</h3><p>对比两个目录下文件，想知道目标目录下哪些文件被修改或增加删除了，rsync提供了一个只校验文件但不实际同步目录内容的参数 <code>--dry-run</code>或<code>-n</code>.</p><p>如果不确定 rsync 执行后会产生什么结果，可以先用<code>-n</code>或<code>--dry-run</code>参数模拟执行的结果。</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ rsync -anv <span class="hljs-built_in">source</span>/ destination<br></code></pre></td></tr></table></figure></blockquote><p>上面命令中，<code>-n</code>参数模拟命令执行的结果，并不真的执行命令。<code>-v</code>参数则是将结果输出到终端，这样就可以看到哪些内容会被同步。</p><h3 id="delete-参数"><a href="#delete-参数" class="headerlink" title="--delete 参数"></a><code>--delete</code> 参数</h3><p>默认情况下，rsync 只确保源目录的所有内容（明确排除的文件除外）都复制到目标目录。它不会使两个目录保持相同，并且不会删除文件。如果要使得目标目录成为源目录的镜像副本，则必须使用<code>--delete</code>参数，这将删除只存在于目标目录、不存在于源目录的文件。</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ rsync -av --delete <span class="hljs-built_in">source</span>/ destination<br></code></pre></td></tr></table></figure></blockquote><p>上面命令中，<code>--delete</code>参数会使得<code>destination</code>成为<code>source</code>的一个镜像。</p><h2 id="ufw-ubuntu防火墙"><a href="#ufw-ubuntu防火墙" class="headerlink" title="ufw ubuntu防火墙"></a>ufw ubuntu防火墙</h2><p>UFW 只是 iptables 的前端，因此这些日志条目实际上来自 iptables。</p><p>第 1 行：<code>Feb 6 16:27:08 jonasgroenbek kernel: [71910.873115]</code></p><p>日期和时间、您的计算机名称和自引导以来的内核时间。</p><p>第 2 行：<code>[UFW BLOCK] IN=eth0 OUT=</code></p><p>每当 iptables 执行日志条目时，都会有一个可选的<code>--log-prefix</code>，在这种情况下<code>[UFW BLOCK]</code>。UFW 最烦人的一点是，它对每种类型的日志条目都使用相同的前缀，因此很难关联回 iptables 规则集。<code>IN</code>是数据包到达的网络接口名称。是空白的<code>OUT</code>，因为数据包没有被重新传输，如果这是一个路由器应用程序可能就是这种情况。</p><p>第 3 行：<code>MAC=a6:8d:e2:51:62:4c:f0:4b:3a:4f:80:30:08:00</code></p><p>这些是本地目标 (a6:8d:e2:51:62:4c (eth0)) 和源 (f0:4b:3a:4f:80:30) 网络接口卡的机器地址代码。在您的情况下，源可能是您的 ISP 网关 NIC 的 MAC。每个 6 个字节。末尾额外的 2 个字节（08:00）是帧类型，在这种情况下，它表示“以太网帧携带 IPv4 数据报”。</p><p>第 4 行：<code>SRC=77.72.85.26 DST=157.230.26.180</code></p><p>这些是数据包来自哪里的IP地址，SRC，它应该去哪里，DST，应该是你的IP地址。</p><p>第 5 行：<code>LEN=40 TOS=0x00 PREC=0x00 TTL=251 ID=62215 PROTO=TCP</code></p><p>原始数据包的有效载荷部分的长度；服务类型、存在时间、生存时间（在数据包因跳数过多而死亡之前还剩下多少跳）；鉴别; 协议（在本例中为 TCP）。</p><p>第 6 行：<code>SPT=42772 DPT=3194 WINDOW=1024</code></p><p>源端口；探测端口；TCP 窗口大小</p><p>第 7 行：<code>RES=0x00 SYN URGP=0</code></p><p>TCP 标志，这里重要的是“SYN”，意思是它试图建立一个新的连接。此日志条目表示尝试已被阻止。</p><h2 id="linux-gt-和-gt-gt-的区别-lt-号使用"><a href="#linux-gt-和-gt-gt-的区别-lt-号使用" class="headerlink" title="linux &gt;和&gt;&gt;的区别,&lt;号使用"></a>linux &gt;和&gt;&gt;的区别,&lt;号使用</h2><p><code>&gt;</code>：将一条命令执行结果（标准输出，或者错误输出，本来都要打印到屏幕上面的）重定向其它输出设备（文件，打开文件操作符，或打印机等等）</p><ul><li><p><code>&gt;&gt;</code>：追加内容（原有内容保留）</p></li><li><p><code>&gt;</code>：覆盖内容</p></li></ul><p><code>&lt;</code>：命令默认从键盘获得的输入，改成从文件，或者其它打开文件以及设备输入</p><h2 id="访问samba"><a href="#访问samba" class="headerlink" title="访问samba"></a>访问samba</h2><blockquote><p>Linux用户可以从命令行访问samba共享，使用文件管理器或挂载samba共享。</p><p><code>smbclient</code>是一个允许您从命令行访问Samba共享资源的工具。大绝大部分的Linux发行版中，<code>smbclient</code>软件包并不是预先安装的，所以需要在您的发行版软件包管理器中安装它。</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt install smbclient<br></code></pre></td></tr></table></figure><p>访问Samba共享资源</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">smbclient //samba_hostname_or_server_ip/share_name -U username<br></code></pre></td></tr></table></figure><p>看到这个提示符就表示成功登录了</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">Try &quot;help&quot; to get a list of possible commands.<br>smb: \&gt;<br></code></pre></td></tr></table></figure><p>还有一种用的比较多的方法就是直接将<strong>Samba文件夹挂载到系统文件夹</strong>下.</p><h3 id="挂载"><a href="#挂载" class="headerlink" title="挂载"></a>挂载</h3><p>我们需要先安装包<code>cifs-utils</code>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt install cifs-utils<br></code></pre></td></tr></table></figure><p>创建挂载点：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo <span class="hljs-built_in">mkdir</span> /mnt/smbmount<br></code></pre></td></tr></table></figure><p>挂载远程共享目录到本地目录&#x2F;mnt&#x2F;smbmount</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo mount -t cifs -o username=my_username //samba_hostname_or_server_ip/sharePath /mnt/smbmount<br></code></pre></td></tr></table></figure><p>把远程服务器192.168.20.245上的共享目录<code>share</code>，用户名为<code>frank</code>，挂载到本地目录<code>/mnt/smbmount</code>上：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo mount -t cifs -o username=frank //192.168.20.245/share /mnt/smbmount<br></code></pre></td></tr></table></figure><p>系统将提示需要输入密码验证：</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">Password <span class="hljs-keyword">for</span> <span class="hljs-symbol">frank@</span><span class="hljs-comment">//192.168.20.245/share:  ********</span><br></code></pre></td></tr></table></figure><p>查看挂载情况 可以看到已经成功挂载了</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">df -h<br></code></pre></td></tr></table></figure><blockquote><p>Note:如果提示文件系统错误, 或者远程文件只读错误可以看看是不是没安装<code>cifs-utils</code></p></blockquote><h3 id="开机挂载"><a href="#开机挂载" class="headerlink" title="开机挂载"></a>开机挂载</h3><p>先卸载刚刚挂载的目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">umount /mnt/smbmount<br></code></pre></td></tr></table></figure><p>我们要实现开机自动挂载，需要修改配置文件<code>/etc/fstab</code>，假设服务器IP地址为192.168.20.245，共享目录名为share，本地目录为<code>/mnt/smbmount</code>，用户名为<code>frank</code>，密码为123，在配置文件的最后一行添加以下内容：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span><span class="hljs-number">192.168</span>.<span class="hljs-number">20.245</span><span class="hljs-regexp">/share /m</span>nt/smbmount  cifs  username=frank,password=<span class="hljs-number">123</span>,soft,rw  <span class="hljs-number">0</span> <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>测试挂载：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mount -a<br></code></pre></td></tr></table></figure><p>验证：看看挂载情况：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">df</span> -h<br></code></pre></td></tr></table></figure><p>接下来查看文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ll /mnt/smbmount<br></code></pre></td></tr></table></figure><h2 id="查看文件占用"><a href="#查看文件占用" class="headerlink" title="查看文件占用"></a>查看文件占用</h2><p>ADD ME</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt install ncdu<br><br>ncdu<br><span class="hljs-meta prompt_"># </span><span class="language-bash">排除/mnt</span><br>ncdu --exclude /mnt <br><br><br><br>du -h -d 1<br></code></pre></td></tr></table></figure><h2 id="修改语言"><a href="#修改语言" class="headerlink" title="修改语言"></a>修改语言</h2><h3 id="CentOS-更改系统语言"><a href="#CentOS-更改系统语言" class="headerlink" title="CentOS 更改系统语言"></a>CentOS 更改系统语言</h3><p>使用 <code>localectl list-locales</code> 查看已有语言环境。例如切换简中只需运行下面命令，重启系统生效。</p><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dsconfig"><span class="hljs-string">localectl</span> <span class="hljs-built_in">set-locale</span> <span class="hljs-string">LANG</span>=<span class="hljs-string">zh_CN</span>.<span class="hljs-string">UTF-8</span><br></code></pre></td></tr></table></figure><p>也可以手动修改语言配置文件 <code>/etc/locale.conf</code> 设置，效果是一样的。</p><p>某些场景可能只要临时切换语言，仅对当前登录会话生效，这时可用 <code>LANG=zh_CN.UTF-8</code> 命令设置。</p><h3 id="Ubuntu-更改系统语言"><a href="#Ubuntu-更改系统语言" class="headerlink" title="Ubuntu 更改系统语言"></a>Ubuntu 更改系统语言</h3><p>先用 <code>locale -a</code> 查看系统语言环境。按下面命令格式更改语言，注销重新登录生效。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">update-locale <span class="hljs-attribute">LANG</span>=zh_CN.UTF-8<br></code></pre></td></tr></table></figure><p>如果系统没有所需语言，先使用下面命令添加，以添加简中语言为例。</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">locale-gen zh_CN.UTF-8 <span class="hljs-variable">&amp;&amp;</span> <span class="hljs-keyword">update</span>-locale<br></code></pre></td></tr></table></figure><h3 id="Debian-更改系统语言"><a href="#Debian-更改系统语言" class="headerlink" title="Debian 更改系统语言"></a>Debian 更改系统语言</h3><p>用要添加语言的国家地区代码，相应修改如下命令运行，以简中为例。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">LANG</span>=zh_CN.UTF-8<br></code></pre></td></tr></table></figure><p>再执行 <code>dpkg-reconfigure locales</code> 命令重新配置语言，用空格键选择，之后重启系统生效。</p><h3 id="Docker-内-ubuntu"><a href="#Docker-内-ubuntu" class="headerlink" title="Docker 内 ubuntu"></a>Docker 内 ubuntu</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">apt-get install language-pack-zh-hans<br>locale-gen zh_CN.UTF-8<br>locale -a<br>echo &quot;export LC_ALL=zh_CN.UTF-8&quot;&gt;&gt; /etc/profile<br>source /etc/profile<br>locale<br></code></pre></td></tr></table></figure><h2 id="date日期时间和Unix时间戳互转"><a href="#date日期时间和Unix时间戳互转" class="headerlink" title="date日期时间和Unix时间戳互转"></a>date日期时间和Unix时间戳互转</h2><h3 id="将日期转换为Unix时间戳"><a href="#将日期转换为Unix时间戳" class="headerlink" title="将日期转换为Unix时间戳"></a>将日期转换为Unix时间戳</h3><p>将当前时间以Unix时间戳表示：</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel"><span class="hljs-keyword">date</span> +%s<br></code></pre></td></tr></table></figure><p>输出如下：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">1361542433</span><br></code></pre></td></tr></table></figure><p>转换指定日期为Unix时间戳：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">date</span> -d &#x27;<span class="hljs-number">2013</span>-<span class="hljs-number">2</span>-<span class="hljs-number">22</span> <span class="hljs-number">22</span>:<span class="hljs-number">14</span>&#x27; +%s<br></code></pre></td></tr></table></figure><p>输出如下：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-number">1361542440</span><br></code></pre></td></tr></table></figure><h3 id="将Unix时间戳转换为日期时间"><a href="#将Unix时间戳转换为日期时间" class="headerlink" title="将Unix时间戳转换为日期时间"></a>将Unix时间戳转换为日期时间</h3><p>不指定日期时间的格式：</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel"><span class="hljs-keyword">date</span> -d @1361542596<br></code></pre></td></tr></table></figure><p>输出如下：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Fri</span> Feb <span class="hljs-number">22</span> <span class="hljs-number">22</span>:<span class="hljs-number">16</span>:<span class="hljs-number">36</span> CST <span class="hljs-number">2013</span><br></code></pre></td></tr></table></figure><p>指定日期格式的转换：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl">date -d @1361542596 +<span class="hljs-string">&quot;%Y-%m-%d %H:%M:%S&quot;</span><br></code></pre></td></tr></table></figure><p>输出如下：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2013</span>-<span class="hljs-number">02</span>-<span class="hljs-number">22</span> <span class="hljs-number">22</span>:<span class="hljs-number">16</span>:<span class="hljs-number">36</span><br></code></pre></td></tr></table></figure><h2 id="固定IP"><a href="#固定IP" class="headerlink" title="固定IP"></a>固定IP</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">临时 固定ip 重启后失效</span><br>ifconfig eth0 192.168.2.20 netmask 255.255.255.0 up<br><span class="hljs-meta prompt_"># </span><span class="language-bash">添加 路由表</span><br>route add gw 192.168.2.254<br></code></pre></td></tr></table></figure><h2 id="Swap-分区大小调整"><a href="#Swap-分区大小调整" class="headerlink" title="Swap 分区大小调整"></a>Swap 分区大小调整</h2><p>vps磁盘空间比较小，<code>var/swapfile</code>占用空间比较大，调整swap的大小，减小这个文件占用的空间</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell">检查 swap 大小<br>free -m<br>关闭swap<br>swapoff -a<br>1.创建交换分区的文件:增加2G大小的交换分区<br>dd if=/dev/zero of=/var/swapfile bs=1M count=2048<br>2.设置交换文件<br>mkswap /var/swapfile<br>3.启用交换分区文件<br>swapon /var/swapfile<br>4.在/etc/fstab添加<br>echo &#x27;/var/swapfile swap swap defaults 0 0&#x27;&gt;&gt;/etc/fstab<br>5.检查<br>free -m<br></code></pre></td></tr></table></figure><h1 id="RaspberryPI"><a href="#RaspberryPI" class="headerlink" title="RaspberryPI"></a>RaspberryPI</h1><h2 id="密码"><a href="#密码" class="headerlink" title="密码"></a>密码</h2><h3 id="树莓派OS-默认"><a href="#树莓派OS-默认" class="headerlink" title="树莓派OS 默认"></a>树莓派OS 默认</h3><blockquote><p>pi<br>raspberry</p></blockquote><p>注意！！</p><blockquote><p>新版树莓派的镜像将没有默认密码</p><p><a target="_blank" rel="noopener" href="https://www.raspberrypi.com/news/raspberry-pi-bullseye-update-april-2022/">参考</a></p><p>我们只需要将存储卡插入到PC在<code>boot</code>盘下新建文件<code>userconf</code>或者<code>userconf.txt</code></p><p>文件内容是<code>username:encrypted-password</code></p><p><code>encrypted-password</code>是通过这个命令运算来的</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo &#x27;mypassword&#x27; | openssl passwd -6 -stdin<br></code></pre></td></tr></table></figure><p>用户名是<code>pi</code>密码是<code>raspberry</code> 那么文件内容形如下面这样</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">pi:$6$LXbLeu63.T9FIeWq$rdm2RMzZQLjs1nDI7wiPEx8UKrVWpcEuhSvjFTR4smGXqO9bMow5Imkdgzk.PKdxf.sjxy.dKYDIXneJ0INst/<br></code></pre></td></tr></table></figure></blockquote><h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2><h3 id="WiFi-网络配置"><a href="#WiFi-网络配置" class="headerlink" title="WiFi 网络配置"></a>WiFi 网络配置</h3><p>用户可以在未启动树莓派的状态下单独修改 &#x2F;boot&#x2F;wpa_supplicant.conf 文件配置 WiFi 的 SSID 和密码，这样树莓派启动后会自行读取 wpa_supplicant.conf 配置文件连接 WiFi 设备。</p><p>操作方法简单：将刷好 Raspbian 系统的 SD 卡用电脑读取。在 boot 分区，也就是树莓派的 &#x2F;boot 目录下新建 wpa_supplicant.conf 文件，按照下面的参考格式填入内容并保存 <code>wpa_supplicant.conf</code> 文件。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs shell">country=CN<br>ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev<br>update_config=1<br> <br>network=&#123;<br>ssid=&quot;WiFi-A&quot;			#ssid:网络的ssid<br>psk=&quot;12345678&quot;			#psk:密码<br>key_mgmt=WPA-PSK<br>priority=1				#priority:连接优先级，数字越大优先级越高（不可以是负数）<br>&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">隐藏WiFi</span><br>network=&#123;<br>ssid=&quot;WiFi-B&quot;<br>psk=&quot;12345678&quot;<br>key_mgmt=WPA-PSK<br>priority=2<br>scan_ssid=1				#scan_ssid:连接隐藏WiFi时需要指定该值为1<br>&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">WiFi 没有密码</span><br>network=&#123;<br>ssid=&quot;你的无线网络名称（ssid）&quot;<br>key_mgmt=NONE<br>&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">如果你的 WiFi 使用WEP加密</span><br>network=&#123;<br>ssid=&quot;你的无线网络名称（ssid）&quot;<br>key_mgmt=NONE<br>wep_key0=&quot;你的wifi密码&quot;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="开启-SSH-服务"><a href="#开启-SSH-服务" class="headerlink" title="开启 SSH 服务"></a>开启 SSH 服务</h3><ul><li>在boot盘下新建<code>ssh</code>文件即可开启ssh</li></ul><h3 id="其他配置"><a href="#其他配置" class="headerlink" title="其他配置"></a>其他配置</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-comment"># 树莓派相关配置</span><br>sudo raspi-<span class="hljs-built_in">config</span><br></code></pre></td></tr></table></figure><h2 id="开关机"><a href="#开关机" class="headerlink" title="开关机"></a>开关机</h2><h3 id="安全关机："><a href="#安全关机：" class="headerlink" title="安全关机："></a>安全关机：</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo shutdown -h now<br>sudo halt<br>sudo poweroff<br>sudo init 0<br></code></pre></td></tr></table></figure><h3 id="安全重启："><a href="#安全重启：" class="headerlink" title="安全重启："></a>安全重启：</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo reboot<br>shutdown -r now<br></code></pre></td></tr></table></figure><h2 id="GPIO"><a href="#GPIO" class="headerlink" title="GPIO"></a>GPIO</h2><p><img src="/2020/d4436089/GPIO1.png" srcset="/img/loading.gif" lazyload alt="GPIO1"></p><p><img src="/2020/d4436089/image-20210801204738591.png" srcset="/img/loading.gif" lazyload alt="image-20210801204738591"></p><h1 id="RaspberryPI-Note"><a href="#RaspberryPI-Note" class="headerlink" title="RaspberryPI Note"></a>RaspberryPI Note</h1><h2 id="wiringPi-GPIO库"><a href="#wiringPi-GPIO库" class="headerlink" title="wiringPi GPIO库"></a>wiringPi GPIO库</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /tmp<br>wget https://project-downloads.drogon.net/wiringpi-latest.deb<br>sudo dpkg -i wiringpi-latest.deb<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">查看GPIO编码</span><br>gpio readall<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">树莓派4b 需要版本大于2.52</span><br>gpio -v<br><br></code></pre></td></tr></table></figure><h3 id="shell操作"><a href="#shell操作" class="headerlink" title="shell操作"></a>shell操作</h3><h4 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h4><p>进入<code>/sys/class/gpio/</code>目录并查看文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /sys/class/gpio/<br>ls<br></code></pre></td></tr></table></figure><p><img src="/2020/d4436089/1889022-20200410121643886-1233996502.png" srcset="/img/loading.gif" lazyload alt="img"></p><p>目录<code>export</code>为创建，<code>unexport</code>为删除</p><p>将gpio18重定向用户定义设备，生成gpio18目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo echo 18 &gt; export<br></code></pre></td></tr></table></figure><p><img src="/2020/d4436089/1889022-20200410132825370-786913267.png" srcset="/img/loading.gif" lazyload alt="img"></p><p>进入<code>gpio18</code>目录并查看文件</p><p><img src="/2020/d4436089/1889022-20200410134354086-537662427.png" srcset="/img/loading.gif" lazyload alt="img"></p><p><code>direction</code>设置引脚方向，输入还是输出</p><p><code>value</code>设置引脚状态，高电平还是低电平</p><h4 id="输入状态"><a href="#输入状态" class="headerlink" title="输入状态"></a>输入状态</h4><p>设置引脚状态为输入状态</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo echo in &gt; direction<br></code></pre></td></tr></table></figure><p><img src="/2020/d4436089/1889022-20200410134655161-2081521744.png" srcset="/img/loading.gif" lazyload alt="img"></p><p>查看引脚高低电平</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat value <br></code></pre></td></tr></table></figure><h4 id="输出状态"><a href="#输出状态" class="headerlink" title="输出状态"></a>输出状态</h4><p>设置引脚状态为输出状态</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo echo out &gt; direction<br></code></pre></td></tr></table></figure><p><img src="/2020/d4436089/1889022-20200410134856417-744239525.png" srcset="/img/loading.gif" lazyload alt="img"></p><p>设置输出高电平</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo echo 1 &gt; value<br></code></pre></td></tr></table></figure><p>设置输出低电平</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo echo 0 &gt; value<br></code></pre></td></tr></table></figure><h4 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h4><p>测试完毕之后返回<code>/sys/class/gpio/</code>目录，并将gpio注销</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /sys/class/gpio/<br>sudo echo 18 &gt; /sys/class/gpio/unexport<br></code></pre></td></tr></table></figure><h2 id="增加开机启动项-1"><a href="#增加开机启动项-1" class="headerlink" title="增加开机启动项"></a>增加开机启动项</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo nano /etc/rc.local<br><span class="hljs-meta prompt_"># </span><span class="language-bash">在打开的rc.local找到<span class="hljs-built_in">exit</span> 0，在<span class="hljs-built_in">exit</span> 0 之前添加即可</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">执行这段代码时是使用root用户权限的，注意当前的用户权限，以免因权限问题导致脚本执行失败。</span><br><br></code></pre></td></tr></table></figure><h2 id="树莓派自动挂载U盘"><a href="#树莓派自动挂载U盘" class="headerlink" title="树莓派自动挂载U盘"></a>树莓派自动挂载U盘</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">打开文件 添加以下 这个带有超时,可以避免拔掉U盘开不了机</span><br>sudo nano /etc/fstab<br><span class="hljs-meta prompt_"># </span><span class="language-bash">/dev/sda1 /mnt/usb    auto     defaults,nofail,x-systemd.device-timeout=1,noatime  0   0</span><br></code></pre></td></tr></table></figure><h2 id="查看温度"><a href="#查看温度" class="headerlink" title="查看温度"></a>查看温度</h2><p>使用watch命令每秒打印一次cpu温度信息</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">watch -n 1 cat /sys/class/thermal/thermal_zone0/temp<br></code></pre></td></tr></table></figure><p>由于 Raspberry Pi 系列上使用的 SoC 的架构，以及在 Raspberry Pi OS 发行版中使用上游温度监控代码，基于 Linux 的温度测量可能不准确。但是，该<code>vcgencmd</code>命令在直接与 GPU 通信时提供了当前 SoC 温度的准确和即时读数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vcgencmd measure_temp<br></code></pre></td></tr></table></figure><h2 id="远程桌面"><a href="#远程桌面" class="headerlink" title="远程桌面"></a>远程桌面</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt-get install xrdp<br></code></pre></td></tr></table></figure><h2 id="固定IP-1"><a href="#固定IP-1" class="headerlink" title="固定IP"></a>固定IP</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo nano /etc/dhcpcd.conf<br><br><span class="hljs-comment"># 找到如下内容 对应修改即可</span><br><span class="hljs-comment"># Example static IP configuration:</span><br><span class="hljs-comment">#interface eth0</span><br><span class="hljs-comment">#static ip_address=192.168.0.10/24</span><br><span class="hljs-comment">#static ip6_address=fd51:42f8:caae:d92e::ff/64</span><br><span class="hljs-comment">#static routers=192.168.0.1</span><br><span class="hljs-comment">#static domain_name_servers=192.168.0.1 8.8.8.8 fd51:42f8:caae:d92e::1</span><br><br><span class="hljs-comment"># eg.</span><br>interface wlan0<br>static ip_address=192.168.31.222/24<br>static routers=192.168.31.254<br>static domain_name_servers=223.5.5.5 192.168.31.254<br></code></pre></td></tr></table></figure><h2 id="I2C相关"><a href="#I2C相关" class="headerlink" title="I2C相关"></a>I2C相关</h2><h3 id="修改I2C总线速度"><a href="#修改I2C总线速度" class="headerlink" title="修改I2C总线速度"></a>修改I2C总线速度</h3><p><strong>启用I2C接口</strong></p><p><code>sudo raspi-config</code></p><p>命令将启动raspi-config实用程序。选择“Interfacing Options”:</p><p>将光标移动到“P5 I2C”，选中，然后“select”。</p><p><strong>编辑Config.txt文件设置I2C总线速度</strong></p><p><code>sudo nano /boot/config.txt</code></p><p>查找包含“<code>dtparam=i2c_arm=on</code>”的行，添加“<code>i2c_arm_baudrate=400000</code>”，其中<code>400000</code>是新设置的速度(400kbit &#x2F;s)，注意i2c前面的逗号。完整代码如下：</p><p><code>dtparam=i2c_arm=on,i2c_arm_baudrate=400000</code></p><p>这样可以启用I2C总线的同时，也完成了新波特率的设置。编辑完成后，使用CTRL-X，然后选择Y，保存文件并退出，<strong>并重新启动</strong>。</p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/linux/" class="category-chain-item">linux</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/linux/" class="print-no-link">#linux</a></div></div><div class="license-box my-3"><div class="license-title"><div>Linux 杂乱学习笔记</div><div>https://www.oikiou.top/2020/d4436089/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Oikiou</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2020年10月29日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i> </span></a><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="NC - 非商业性使用"><i class="iconfont icon-nc"></i> </span></a><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="SA - 相同方式共享"><i class="iconfont icon-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2020/2651f4ca/" title="Cortex-M3基础"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">Cortex-M3基础</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2020/2b1e625a/" title="RTX"><span class="hidden-mobile">RTX</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><div id="twikoo"></div><script type="text/javascript">Fluid.utils.loadComments("#comments",function(){Fluid.utils.createScript("https://lib.baomitu.com/twikoo/1.6.10/twikoo.all.min.js",function(){var o=Object.assign({envId:"https://twikoo.oikiou.top/",region:"ap-shanghai",path:"window.location.pathname"},{el:"#twikoo",path:"window.location.pathname",onCommentLoaded:function(){Fluid.utils.listenDOMLoaded(function(){var o="#twikoo .tk-content img:not(.tk-owo-emotion)";Fluid.plugins.imageCaption(o),Fluid.plugins.fancyBox(o)})}});twikoo.init(o)})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar category-bar" style="margin-left:-1rem"><div class="category-list"><div class="category row nomargin-x"><a class="category-item list-group-item category-item-action col-10 col-md-11 col-xm-11" title="linux" id="heading-e206a54e97690cce50cc872dd70ee896" role="tab" data-toggle="collapse" href="#collapse-e206a54e97690cce50cc872dd70ee896" aria-expanded="true">linux <span class="list-group-count">(6)</span> <i class="iconfont icon-arrowright"></i></a><div class="category-collapse collapse show" id="collapse-e206a54e97690cce50cc872dd70ee896" role="tabpanel" aria-labelledby="heading-e206a54e97690cce50cc872dd70ee896"><div class="category-post-list"><a href="/2020/d4436089/" title="Linux 杂乱学习笔记" class="list-group-item list-group-item-action active"><span class="category-post">Linux 杂乱学习笔记</span> </a><a href="/2021/9b4105ad/" title="LinuxAlphaMini" class="list-group-item list-group-item-action"><span class="category-post">LinuxAlphaMini</span> </a><a href="/2021/784ee20b/" title="WSL" class="list-group-item list-group-item-action"><span class="category-post">WSL</span> </a><a href="/2023/52593829/" title="Linux 应用编程 Curl Libcurl" class="list-group-item list-group-item-action"><span class="category-post">Linux 应用编程 Curl Libcurl</span> </a><a href="/2023/bb8e62be/" title="Linux 应用编程 Zlib Minizip" class="list-group-item list-group-item-action"><span class="category-post">Linux 应用编程 Zlib Minizip</span> </a><a href="/2023/47a3870e/" title="Linux 应用编程" class="list-group-item list-group-item-action"><span class="category-post">Linux 应用编程</span></a></div></div></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><span>如果你有任何反馈请联系oikiou@outlook.com</span></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">总访问量 <span id="busuanzi_value_site_pv"></span> 次 </span><span id="busuanzi_container_site_uv" style="display:none">总访客数 <span id="busuanzi_value_site_uv"></span> 人</span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t){var e=Fluid.plugins.typing,i=t.getElementById("subtitle");i&&e&&e(i.getAttribute("data-typed-text"))}((window,document))</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;0<t.find(".toc-list-item").length&&t.css("visibility","visible")}}))})</script><script>var relativeDate=function(){var t,e,i,n,m=document.getElementById("updated-time");m&&(e=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|[+-]\d{2}:\d{2})/,(i=(t=m.textContent).match(e))&&(n=moment(i[0]).fromNow(),m.textContent=t.replace(e,n)),m.style.display="")};Fluid.utils.createScript("https://lib.baomitu.com/moment.js/2.29.4/moment.min.js",function(){"zh-cn".startsWith("en")?relativeDate():Fluid.utils.createScript("https://lib.baomitu.com/moment.js/2.29.4/locale/zh-cn.min.js",function(){relativeDate()})})</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/custom.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>