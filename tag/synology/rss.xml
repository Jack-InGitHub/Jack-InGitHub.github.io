<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Oikiou&#39;s Blog • Posts by &#34;synology&#34; tag</title>
        <link>https://www.oikiou.top</link>
        <description>Blog</description>
        <language>zh-CN</language>
        <pubDate>Mon, 18 Oct 2021 22:57:15 +0800</pubDate>
        <lastBuildDate>Mon, 18 Oct 2021 22:57:15 +0800</lastBuildDate>
        <category>embedded</category>
        <category>note</category>
        <category>micropython</category>
        <category>python</category>
        <category>ms-dos</category>
        <category>windows</category>
        <category>c</category>
        <category>c/c++</category>
        <category>pid</category>
        <category>qt</category>
        <category>pyqt</category>
        <category>c++</category>
        <category>数据结构</category>
        <category>堆栈</category>
        <category>队列</category>
        <category>链表</category>
        <category>树</category>
        <category>二叉树</category>
        <category>正则表达式</category>
        <category>hp</category>
        <category>chrome</category>
        <category>cc2530</category>
        <category>zigbee</category>
        <category>sscanf</category>
        <category>hex</category>
        <category>jpeg</category>
        <category>webp</category>
        <category>jpeg2000</category>
        <category>image</category>
        <category>osi</category>
        <category>markdown</category>
        <category>md5</category>
        <category>tags</category>
        <category>label</category>
        <category>category</category>
        <category>typora</category>
        <category>iap</category>
        <category>bootloader</category>
        <category>stm32</category>
        <category>usart</category>
        <category>rts</category>
        <category>cts</category>
        <category>dtr</category>
        <category>dsr</category>
        <category>ws2812</category>
        <category>spi</category>
        <category>dma</category>
        <category>makefile</category>
        <category>xip</category>
        <category>nor</category>
        <category>nand</category>
        <category>ip</category>
        <category>location</category>
        <category>api</category>
        <category>机智云</category>
        <category>android</category>
        <category>mtp</category>
        <category>pc</category>
        <category>driver</category>
        <category>kms</category>
        <category>office</category>
        <category>volume</category>
        <category>DS_Store</category>
        <category>rtf</category>
        <category>后缀</category>
        <category>character encoding</category>
        <category>gb2312</category>
        <category>utf-8</category>
        <category>蓝桥杯</category>
        <category>国赛</category>
        <category>ct117e</category>
        <category>超声波</category>
        <category>zsh</category>
        <category>shell</category>
        <category>linux</category>
        <category>ssl</category>
        <category>https</category>
        <category>ct117e-ex</category>
        <category>zip</category>
        <category>gzip</category>
        <category>bzip</category>
        <category>tar</category>
        <category>life</category>
        <category>workflow</category>
        <category>人生</category>
        <category>github</category>
        <category>hosts</category>
        <category>cad</category>
        <category>心理学</category>
        <category>cat_drive</category>
        <category>hardware</category>
        <category>lenovo</category>
        <category>disk</category>
        <category>switch</category>
        <category>nintendo</category>
        <category>game</category>
        <category>software</category>
        <category>synology</category>
        <category>dslogic</category>
        <category>逻辑分析仪</category>
        <category>pyhton</category>
        <category>decoder</category>
        <category>docker</category>
        <category>dockerfile</category>
        <category>namespace</category>
        <category>cgroup</category>
        <category>dockerhub</category>
        <category>摄影</category>
        <category>git</category>
        <category>j-link</category>
        <category>rtt</category>
        <category>serial</category>
        <category>debug</category>
        <category>jlink</category>
        <category>ps</category>
        <category>powershell</category>
        <category>rdpwrap</category>
        <category>rdp</category>
        <category>sourceinsigh</category>
        <category>si</category>
        <category>ide</category>
        <category>spacedesk</category>
        <category>投屏</category>
        <category>vscode</category>
        <category>flash</category>
        <category>j-tag</category>
        <category>commenttranslate</category>
        <category>wsl</category>
        <category>wordpress</category>
        <category>web</category>
        <category>mysql</category>
        <category>nginx</category>
        <category>tmux</category>
        <category>unit</category>
        <category>m</category>
        <category>cm</category>
        <category>mm</category>
        <category>s</category>
        <category>us</category>
        <category>cortex-a7</category>
        <category>hexo</category>
        <category>jekyll</category>
        <category>fluid</category>
        <category>cusdis</category>
        <category>twikoo</category>
        <category>blog</category>
        <category>gravatar</category>
        <category>cravatar</category>
        <category>cortex-m3</category>
        <category>alpha_mini</category>
        <category>正点原子</category>
        <category>rtx</category>
        <category>rtos</category>
        <category>keil</category>
        <category>bluetooth</category>
        <category>蓝牙</category>
        <category>modbus</category>
        <category>ucos</category>
        <category>raspberry</category>
        <category>wiringpi</category>
        <category>pwm</category>
        <category>rt-thread</category>
        <category>ap</category>
        <category>wifi</category>
        <item>
            <guid isPermalink="true">https://www.oikiou.top/2021/ee60585b/</guid>
            <title>Synology 群晖</title>
            <link>https://www.oikiou.top/2021/ee60585b/</link>
            <category>linux</category>
            <category>synology</category>
            <pubDate>Mon, 18 Oct 2021 22:57:15 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;群晖&#34;&gt;&lt;a href=&#34;#群晖&#34; class=&#34;headerlink&#34; title=&#34;群晖&#34;&gt;&lt;/a&gt;群晖&lt;/h1&gt;&lt;h1 id=&#34;安装&#34;&gt;&lt;a href=&#34;#安装&#34; class=&#34;headerlink&#34; title=&#34;安装&#34;&gt;&lt;/a&gt;安装&lt;/h1&gt;&lt;h2 id=&#34;资源及参考链接&#34;&gt;&lt;a href=&#34;#资源及参考链接&#34; class=&#34;headerlink&#34; title=&#34;资源及参考链接&#34;&gt;&lt;/a&gt;资源及参考链接&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://www.openos.org/threads/dsm-6-2-3-2020-12-27.29/&#34;&gt;https://www.openos.org/threads/dsm-6-2-3-2020-12-27.29/&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;准备工作&#34;&gt;&lt;a href=&#34;#准备工作&#34; class=&#34;headerlink&#34; title=&#34;准备工作&#34;&gt;&lt;/a&gt;准备工作&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;引导系统装哪里？&lt;/strong&gt;&lt;br&gt;非常关键的问题，DSM采用系统和数据相分离的结构，也就是说引导系统需要独立安装在一个设备上，通常是U盘&amp;#x2F;SD&amp;#x2F;TF卡、或者SSD硬盘上。数据需要额外安装独立的硬盘上。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;引导系统安装盘 (U盘&amp;#x2F;USB flash drive&amp;#x2F;随身碟)&lt;/strong&gt;&lt;br&gt;无论是U盘还是TF卡，其实128MB或以上就足够了，USB 2.0&amp;#x2F;3.0都可以。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;数据存储硬盘 (硬盘)&lt;/strong&gt;&lt;br&gt;机械硬盘或者固态硬盘都可以，这个没有限制，容量当然越大越好。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一般来说安装黑群晖至少需要两个文件, 一个是黑群晖的引导文件, 一个是群晖DSM的系统文件.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;步骤&#34;&gt;&lt;a href=&#34;#步骤&#34; class=&#34;headerlink&#34; title=&#34;步骤&#34;&gt;&lt;/a&gt;步骤&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;  黑群晖系统: DSM 6.2.0–6.2.3&lt;br&gt;  引导版本: 1.04b (首选推荐版本)&lt;br&gt;  针对机型: DS918+&lt;br&gt;  引导方式: 传统BIOS和UEFI&lt;br&gt;  引导下载地址&lt;br&gt;  &lt;a href=&#34;https://www.openos.org/downloads/synology-dsm-6-2-1-loader-v1-04b.15/&#34;&gt;https://www.openos.org/downloads/synology-dsm-6-2-1-loader-v1-04b.15/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;  DS918+ DSM 6.2.3-25426 Update2 系统&lt;br&gt;  &lt;a href=&#34;https://global.download.synology.com/download/DSM/release/6.2.3/25426/DSM_DS918+_25426.pat&#34;&gt;https://global.download.synology.com/download/DSM/release/6.2.3/25426/DSM_DS918+_25426.pat&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;  其他DSM系统版本请看这里&lt;br&gt;  &lt;a href=&#34;https://archive.synology.com/download&#34;&gt;https://archive.synology.com/download&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;下载群晖的引导文件, 推荐下载&lt;code&gt;v1.04b.for.dms.6.2.1.synoboot-ds918.zip&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;http://down.nas2x.com/synology/dsm/6.2/synoboot/&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 里面有三个文件&lt;/span&gt;&lt;br&gt;dsm.6.2.synoboot_ds3615xs.1.03b.zip                02-Aug-2018 10:43     17M&lt;br&gt;dsm.6.2.synoboot_ds3617xs.1.03b.zip                02-Aug-2018 10:42     20M&lt;br&gt;v1.04b.for.dms.6.2.1.synoboot-ds918.zip            25-Jan-2019 18:30     21M&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;下载群晖的系统, 根据上面的引导下载系统, 上面选的是&lt;code&gt;DS918+&lt;/code&gt;的话, 这里下载&lt;code&gt;DS918+&lt;/code&gt;就好.&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# DS918+&lt;/span&gt;&lt;br&gt;https://global.download.synology.com/download/DSM/release/6.2.3/25426/DSM_DS918+_25426.pat&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 其他DSM系统&lt;/span&gt;&lt;br&gt;https://archive.synology.com/download&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;修改引导程序配置文件,&lt;/p&gt;
&lt;p&gt;使用&lt;code&gt;ChipEasy&lt;/code&gt;或者&lt;code&gt;ChipGenius&lt;/code&gt;查找到U盘的VID和PID。&lt;/p&gt;
&lt;p&gt;以下图为例，这个U盘的VID是0930，PID是6544。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;请记录好这两个值。下面修改配置文件需要用到。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/07.png&#34; alt=&#34;[IMG]&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;编辑配置文件grub.cfg.&lt;/p&gt;
&lt;p&gt;打开DiskGenius, 在顶部选择硬盘-打开虚拟硬盘文件, 选择刚刚下载的&lt;code&gt;.img&lt;/code&gt;引导文件并打开.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/kc6jjxmd.png&#34; alt=&#34;[IMG]&#34;&gt;&lt;/p&gt;
&lt;p&gt;在左边找到刚刚打开的img文件, 点击展开&lt;code&gt;ESP-&amp;gt;grub&lt;/code&gt;, 在右边找到&lt;code&gt;grub.cfg&lt;/code&gt;, 选择复制到桌面.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/kccTMt.md.png&#34; alt=&#34;[IMG]&#34;&gt;&lt;/p&gt;
&lt;p&gt;使用文本编辑器修改&lt;code&gt;line22-line25&lt;/code&gt;的数据,&lt;/p&gt;
&lt;p&gt;需要注意的是&lt;code&gt;VID&lt;/code&gt;和&lt;code&gt;PID&lt;/code&gt;必须要和U盘的数值匹配好.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;SN&lt;/code&gt;和&lt;code&gt;MAC1&lt;/code&gt;是在洗半白的时候需要修改的数值, 是非必须修改的.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;set vid&amp;#x3D;0x058f U盘的VID 实体机必须修改，虚拟机无需修改&lt;br&gt;set pid&amp;#x3D;0x6387 U盘的PID 实体机必须修改，虚拟机无需修改&lt;br&gt;set sn&amp;#x3D;A8ODN02468 序列号 可以不修改&lt;br&gt;set mac1&amp;#x3D;0011322CA603 mac地址 可以不修改&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;注意:vid和pid的0x是十六进制的意思是不要删除掉的，只需要修改后面的4位.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/06.png&#34; alt=&#34;[IMG]&#34;&gt;&lt;/p&gt;
&lt;p&gt;回到DiskGenius内将原来的&lt;code&gt;grub.cfg&lt;/code&gt;文件替换掉, 我这里是先将&lt;code&gt;img&lt;/code&gt;镜像里面的&lt;code&gt;grub.cfg&lt;/code&gt;文件删除, 再右键选择新增文件将编辑好的&lt;code&gt;grub.cfg&lt;/code&gt;文件放入其中.&lt;/p&gt;
&lt;p&gt;关闭DiskGenius完成&lt;code&gt;img&lt;/code&gt;引导的修改.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;制作引导U盘&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;使用&lt;code&gt;Win32 Disk Imager&lt;/code&gt;磁盘映像工具将&lt;code&gt;img&lt;/code&gt;引导文件写入U盘内.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;  下载地址:&lt;a href=&#34;https://sourceforge.net/projects/win32diskimager/&#34;&gt;https://sourceforge.net/projects/win32diskimager/&lt;/a&gt;&lt;br&gt;  中文版:&lt;a href=&#34;https://www.openos.org/downloads/win32-disk-imager.2/&#34;&gt;https://www.openos.org/downloads/win32-disk-imager.2/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;先在软件界面右侧设备(Device) 部分选择U盘的盘符。&lt;br&gt;（建议在操作前移除所有其他的USB存储设备，以防选择错误导致其他U盘或移动硬盘数据丢失）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;再点击软件界面 映像文件(Image File)右侧蓝色文件夹图标，选择之前下载的synoboot.img文件。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;最后再点击写入(Write)。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/w11.png&#34; alt=&#34;[IMG]&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;安装群晖系统&lt;/p&gt;
&lt;p&gt;插入U盘，并且在主板上设置默认从U盘启动&lt;/p&gt;
&lt;p&gt;默认选择从U盘启动后选择第1个选项&lt;code&gt;DS3617xs 6.1 Baremetal with Jun&amp;#39;s Mod v1.02-alpha&lt;/code&gt;按回车。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/2017041711.png&#34; alt=&#34;[IMG]&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;找到设备IP地址&lt;/p&gt;
&lt;p&gt;这里需要稍微等一等提示&lt;code&gt;Please open [http://find.synology.com](http://find.synology.com/) to continue&lt;/code&gt;后等个1-2分钟在浏览器里面输入&lt;a href=&#34;http://find.synology.com/&#34;&gt;http://find.synology.com/&lt;/a&gt; ，搜索DSM，如果没有找到，那么使用SynologyAssistant查找. &lt;a href=&#34;https://cndl.synology.cn/download/Tools/Assistant/6.1-15030/Windows/synology-assistant-6.1-15030.exe&#34;&gt;点击下载Windows版本&lt;/a&gt; &lt;/p&gt;
&lt;p&gt;能进路由器管理页面的, 较好的方案是看一下群晖获取的IP是多少, 浏览器直接进去这个&lt;code&gt;IP:5000&lt;/code&gt;的网页即可, 免去搜寻的麻烦.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;  若多次测试还是无法搜索到群晖，那可能是网卡不支持,&lt;br&gt;  详情请查看DSM黑群晖网卡支持列表&lt;br&gt;  &lt;a href=&#34;https://www.openos.org/threads/dsm-6-1-supported-drivers.42/&#34;&gt;https://www.openos.org/threads/dsm-6-1-supported-drivers.42/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/201704zoz.png&#34; alt=&#34;[IMG]&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;上传系统文件.&lt;/p&gt;
&lt;p&gt;根据提示继续，点击&lt;code&gt;手动安装&lt;/code&gt;后选择之前下载的pat文件，然后再点击&lt;code&gt;立即安装&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/201704opo.png&#34; alt=&#34;[IMG]&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/201704ada.png&#34; alt=&#34;[IMG]&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;安装之后完成一些配置后就可以进入系统界面了.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;安装后的注意事项&#34;&gt;&lt;a href=&#34;#安装后的注意事项&#34; class=&#34;headerlink&#34; title=&#34;安装后的注意事项&#34;&gt;&lt;/a&gt;安装后的注意事项&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;  &lt;strong&gt;安装完成后的基本设置和注意事项&lt;/strong&gt;&lt;br&gt;  1,不要升级，不要升级，不要升级。可以去控制面板下面的-更新和还原里面设置。&lt;br&gt;  2,还是不要升级，去计划任何里面关闭DSM自动更新选项。&lt;br&gt;  3,在存储空间管理员里面设置存储空间后才可以进行其他的操作，如共享文件夹或安装其他套件。&lt;br&gt;  4,DSM 6.x配置文件grub.cfg修改: &lt;a href=&#34;https://www.openos.org/threads/dsm-6-x-grub-cfg-mac-sn.36/&#34;&gt;https://www.openos.org/threads/dsm-6-x-grub-cfg-mac-sn.36/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;  群辉Synology DSM 添加硬盘&amp;#x2F;存储空间的方法&lt;br&gt;  &lt;a href=&#34;https://www.openos.org/threads/synology-dsm-hdd.30/&#34;&gt;https://www.openos.org/threads/synology-dsm-hdd.30/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;  6.1驱动支持列表&lt;br&gt;  &lt;a href=&#34;https://www.openos.org/threads/dsm-6-1-supported-drivers.42/&#34;&gt;https://www.openos.org/threads/dsm-6-1-supported-drivers.42/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;  经过测试，引导文件支持DSM 6.1.1-15101&lt;br&gt;  但是不支持从老版本升级升级，仅限全新安装&lt;br&gt;  安装后更新到update 2没有问题&lt;br&gt;  &lt;a href=&#34;https://www.openos.org/downloads/xpenology-dsm-6-1-1.8/history&#34;&gt;https://www.openos.org/downloads/xpenology-dsm-6-1-1.8/history&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;  安装完成后可以下载一些相关的手机端应用&lt;br&gt;  DS Finder&lt;br&gt;  DS File&lt;br&gt;  DS photo&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;Note&#34;&gt;&lt;a href=&#34;#Note&#34; class=&#34;headerlink&#34; title=&#34;Note&#34;&gt;&lt;/a&gt;Note&lt;/h1&gt;&lt;h2 id=&#34;SSH访问启动盘&#34;&gt;&lt;a href=&#34;#SSH访问启动盘&#34; class=&#34;headerlink&#34; title=&#34;SSH访问启动盘&#34;&gt;&lt;/a&gt;SSH访问启动盘&lt;/h2&gt;&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs shell&#34;&gt;mkdir /mnt/boot&lt;br&gt;cd /dev&lt;br&gt;sudo mount -t vfat synoboot1 /mnt/boot&lt;br&gt;cd /mnt/boot&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;半洗白-SN&#34;&gt;&lt;a href=&#34;#半洗白-SN&#34; class=&#34;headerlink&#34; title=&#34;半洗白 SN&#34;&gt;&lt;/a&gt;半洗白 SN&lt;/h2&gt;&lt;h3 id=&#34;前言&#34;&gt;&lt;a href=&#34;#前言&#34; class=&#34;headerlink&#34; title=&#34;前言&#34;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;全黑版本的群晖VideoStation不能离线转码，PhotoStation和Moments的略缩图和人像识别也会有问题&lt;/li&gt;
&lt;li&gt;半洗白就是转码和缩略图一类的可用&lt;/li&gt;
&lt;li&gt;全白就是多了QC，这个就没必要了(白嫖个系统就好了,就不要去嫖别人的服务器了)&lt;/li&gt;
&lt;li&gt;主要通过Docker+DDSM来获得SN&lt;/li&gt;
&lt;li&gt;群辉新版的Docker 18.09.0-0506已经关闭了DDSM安装，可下载17.05.0版本的Docker&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;步骤-1&#34;&gt;&lt;a href=&#34;#步骤-1&#34; class=&#34;headerlink&#34; title=&#34;步骤&#34;&gt;&lt;/a&gt;步骤&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;下载17.05.0的Docker，可以在&lt;a href=&#34;https://archive.synology.com/download/Package/Docker/17.05.0-0401&#34;&gt;群晖官网下载&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;下载DDSM，可在&lt;a href=&#34;https://archive.synology.com/download/Os/DSM/6.2.3-25426&#34;&gt;群晖官网下载&lt;/a&gt;，注意要对应自己DSM的版本。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;首先在套件中心点手动安装把第一步下载的17.05.0的Docker放进去。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;打开Docker-左侧DSM-点击新增-下一步-下一步-下一步-手动上传，把刚刚下载的DDSM放进去，等待他安装完成。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;安装完成后，进入DDSM群晖的控制面板。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在信息栏可看到SN和MAC，复制DDSM的SN和MAC保存下来。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;SSH接入DSM群晖，挂载启动盘BOOT，修改&lt;code&gt;/grub/grub.cfg&lt;/code&gt;文件。&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs shell&#34;&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;挂载启动盘BOOT&lt;/span&gt;&lt;br&gt;mkdir /mnt/boot&lt;br&gt;cd /dev&lt;br&gt;sudo mount -t vfat synoboot1 /mnt/boot&lt;br&gt;cd /mnt/boot&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;重启。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/image-20211018141146176.png&#34; alt=&#34;image-20211018141146176&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;半洗白后moments人脸识别不出来&#34;&gt;&lt;a href=&#34;#半洗白后moments人脸识别不出来&#34; class=&#34;headerlink&#34; title=&#34;半洗白后moments人脸识别不出来&#34;&gt;&lt;/a&gt;半洗白后moments人脸识别不出来&lt;/h2&gt;&lt;h3 id=&#34;原因&#34;&gt;&lt;a href=&#34;#原因&#34; class=&#34;headerlink&#34; title=&#34;原因&#34;&gt;&lt;/a&gt;原因&lt;/h3&gt;&lt;p&gt;当群晖系统升级到6.22-24922以后，Moments也升级到了1.3.X，新的bug也随着版本升级来了”人物或者主题经常识别不出来“，经查日志后发现是Moments1.3插件有bug引导的，有问题的插件为“&lt;strong&gt;libsynophoto-plugin-detection.so&lt;/strong&gt;”，经测试该插件在Moments1.2版本中是正常的。&lt;/p&gt;
&lt;h3 id=&#34;步骤-2&#34;&gt;&lt;a href=&#34;#步骤-2&#34; class=&#34;headerlink&#34; title=&#34;步骤&#34;&gt;&lt;/a&gt;步骤&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;群晖上启用SSH，并将moments停用&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MobaXterm连接群晖，启用root登录&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;sudo -i&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vi /etc/ssh/sshd_config&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;找到#PermitRootLogin prohibit password，这一行最后，按回车，然后输入 &lt;code&gt;PermitRootLogin yes&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;修改root密码&lt;code&gt;synouser --setpw root 你的密码&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;重启&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;用root重新登录，将libsynophoto-plugin-detection.so插件替换掉&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;找到目录：&amp;#x2F;var&amp;#x2F;packages&amp;#x2F;SynologyMoments&amp;#x2F;target&amp;#x2F;usr&amp;#x2F;lib&amp;#x2F;libsynophoto-plugin-detection.so&lt;/li&gt;
&lt;li&gt;将原文件先备份一下&lt;/li&gt;
&lt;li&gt;用现有新文件将他替换掉&lt;/li&gt;
&lt;li&gt;新文件权限修改一下&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;将moments启用，问题解决&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;&lt;a href=&#34;#参考资料&#34; class=&#34;headerlink&#34; title=&#34;参考资料&#34;&gt;&lt;/a&gt;参考资料&lt;/h3&gt;&lt;p&gt;&lt;a href=&#34;https://www.zhihu.com/question/428454266/answer/1681110862?ivk_sa=1024320u&#34;&gt;https://www.zhihu.com/question/428454266/answer/1681110862?ivk_sa=1024320u&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/weixin_36059505/article/details/112766321&#34;&gt;https://blog.csdn.net/weixin_36059505/article/details/112766321&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;群晖安装-ipkg-包管理&#34;&gt;&lt;a href=&#34;#群晖安装-ipkg-包管理&#34; class=&#34;headerlink&#34; title=&#34;群晖安装 ipkg 包管理&#34;&gt;&lt;/a&gt;群晖安装 ipkg 包管理&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;仅适用于x86平台，ARM平台需要修改链接&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs shell&#34;&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;以 root 用户执行&lt;/span&gt;&lt;br&gt;sudo -i&lt;br&gt;cd /volume1/@tmp&lt;br&gt;wget http://ipkg.nslu2-linux.org/feeds/optware/syno-i686/cross/unstable/syno-i686-bootstrap_1.2-7_i686.xsh&lt;br&gt;chmod +x syno-i686-bootstrap_1.2-7_i686.xsh&lt;br&gt;sh syno-i686-bootstrap_1.2-7_i686.xsh&lt;br&gt;rm syno-i686-bootstrap_1.2-7_i686.xsh&lt;br&gt;ipkg update&lt;br&gt;reboot&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;



&lt;h2 id=&#34;CPU频率调整&#34;&gt;&lt;a href=&#34;#CPU频率调整&#34; class=&#34;headerlink&#34; title=&#34;CPU频率调整&#34;&gt;&lt;/a&gt;CPU频率调整&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Linux的&amp;#x2F;sys&amp;#x2F;devices&amp;#x2F;system&amp;#x2F;cpu&amp;#x2F;cpu*&amp;#x2F;cpufreq目录存储着第*个CPU的一些参数，例如最小最大平均频率，bios限制频率。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;使用如下命令可以查看支持的工作模式：&lt;/p&gt;
 &lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;cat &lt;span class=&#34;hljs-regexp&#34;&gt;/sys/&lt;/span&gt;devices&lt;span class=&#34;hljs-regexp&#34;&gt;/system/&lt;/span&gt;cpu&lt;span class=&#34;hljs-regexp&#34;&gt;/cpu0/&lt;/span&gt;cpufreq/scaling_available_governors&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;模式&lt;/th&gt;
&lt;th&gt;介绍&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;powersave&lt;/td&gt;
&lt;td&gt;只会保持最低频率，节能省电&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;userspace&lt;/td&gt;
&lt;td&gt;自定义频率&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ondemand&lt;/td&gt;
&lt;td&gt;一有cpu计算量的任务，就会立即达到最大频率运行，等执行完毕就立即回到最低频率&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;conservative&lt;/td&gt;
&lt;td&gt;根据负载状态自动在频率上下限调整&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;performance&lt;/td&gt;
&lt;td&gt;保持以最大频率运行&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;通过下面指令可以看第*个CPU核心的工作状态，&lt;/p&gt;
 &lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;cat &lt;span class=&#34;hljs-regexp&#34;&gt;/sys/&lt;/span&gt;devices&lt;span class=&#34;hljs-regexp&#34;&gt;/system/&lt;/span&gt;cpu&lt;span class=&#34;hljs-regexp&#34;&gt;/cpu*/&lt;/span&gt;cpufreq/scaling_governor&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;安装cpufreq-info：&lt;/p&gt;
&lt;figure class=&#34;highlight cmake&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs cmake&#34;&gt;ipkg update&lt;br&gt;ipkg &lt;span class=&#34;hljs-keyword&#34;&gt;install&lt;/span&gt; cpufrequtils&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;查看CPU频率和模式&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs shell&#34;&gt;cpufreq-info&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;修改模式：&lt;/p&gt;
&lt;figure class=&#34;highlight dos&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs dos&#34;&gt;cpufreq-&lt;span class=&#34;hljs-built_in&#34;&gt;set&lt;/span&gt; -c * -g &lt;span class=&#34;hljs-built_in&#34;&gt;MODE&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;例如将四个核心全部ondemand：&lt;/p&gt;
&lt;figure class=&#34;highlight gams&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs gams&#34;&gt;cpufreq-&lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; -c &lt;span class=&#34;hljs-comment&#34;&gt;0 -g ondemand&lt;/span&gt;&lt;br&gt;cpufreq-&lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;-c 1 -g ondemand&lt;/span&gt;&lt;br&gt;cpufreq-&lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;-c 2 -g ondemand&lt;/span&gt;&lt;br&gt;cpufreq-&lt;span class=&#34;hljs-keyword&#34;&gt;set&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;-c 3 -g ondemand&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;为了下次开机也自动生效，可以手动添加启动脚本。将其存成.sh，开启启动即可&lt;/p&gt;
&lt;figure class=&#34;highlight gradle&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs gradle&#34;&gt;#&lt;span class=&#34;hljs-regexp&#34;&gt;/bin/&lt;/span&gt;bash&lt;br&gt;&lt;span class=&#34;hljs-regexp&#34;&gt;/opt/&lt;/span&gt;bin/cpufreq-set -c &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt; -g ondemand&lt;br&gt;&lt;span class=&#34;hljs-regexp&#34;&gt;/opt/&lt;/span&gt;bin/cpufreq-set -c &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; -g ondemand&lt;br&gt;&lt;span class=&#34;hljs-regexp&#34;&gt;/opt/&lt;/span&gt;bin/cpufreq-set -c &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt; -g ondemand&lt;br&gt;&lt;span class=&#34;hljs-regexp&#34;&gt;/opt/&lt;/span&gt;bin/cpufreq-set -c &lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt; -g ondemand&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;



&lt;h2 id=&#34;lm-sensors-风扇控制&#34;&gt;&lt;a href=&#34;#lm-sensors-风扇控制&#34; class=&#34;headerlink&#34; title=&#34;lm-sensors 风扇控制&#34;&gt;&lt;/a&gt;lm-sensors 风扇控制&lt;/h2&gt;&lt;p&gt;执行安装命令&lt;/p&gt;
&lt;figure class=&#34;highlight cmake&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs cmake&#34;&gt;ipkg &lt;span class=&#34;hljs-keyword&#34;&gt;install&lt;/span&gt; lm-sensors&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;查看温度&lt;/p&gt;
&lt;figure class=&#34;highlight ebnf&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs ebnf&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;sensors&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;配置风扇控制，这块主要的目的只检测风扇在那一路，一般主板会涉及到多个风扇，但不一定都会安装，所以通过pwmconfig来检测与测试风扇的转速控制。&lt;/p&gt;
&lt;figure class=&#34;highlight ebnf&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs ebnf&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;sudo pwmconfig&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;使用fancontrol自动控制风扇转速，他的原理就是定时执行脚本，监控CPU温度、根据不同的温度区间控制PWM值，从而改变风扇的转速。&lt;br&gt;当转速降低了后，噪音自然就解决了。&lt;/p&gt;
&lt;p&gt;fancontrol会依赖pwmconfig命令生成的配置文件。&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;&lt;span class=&#34;hljs-regexp&#34;&gt;/etc/&lt;/span&gt;fancontrol&lt;br&gt;&lt;br&gt;-----------配置内容如下--------------&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# Configuration file generated by pwmconfig, changes will be lost&lt;/span&gt;&lt;br&gt;INTERVAL=&lt;span class=&#34;hljs-number&#34;&gt;10&lt;/span&gt;&lt;br&gt;DEVPATH=hwmon0=devices&lt;span class=&#34;hljs-regexp&#34;&gt;/platform/&lt;/span&gt;coretemp.&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt; hwmon1=devices&lt;span class=&#34;hljs-regexp&#34;&gt;/platform/i&lt;/span&gt;t87.&lt;span class=&#34;hljs-number&#34;&gt;2624&lt;/span&gt;&lt;br&gt;DEVNAME=hwmon0=coretemp hwmon1=it8772&lt;br&gt;FCTEMPS=hwmon1&lt;span class=&#34;hljs-regexp&#34;&gt;/device/&lt;/span&gt;pwm2=hwmon0&lt;span class=&#34;hljs-regexp&#34;&gt;/device/&lt;/span&gt;temp3_input&lt;br&gt;FCFANS= hwmon1&lt;span class=&#34;hljs-regexp&#34;&gt;/device/&lt;/span&gt;pwm2=hwmon1&lt;span class=&#34;hljs-regexp&#34;&gt;/device/&lt;/span&gt;fan2_input&lt;br&gt;MINTEMP=hwmon1&lt;span class=&#34;hljs-regexp&#34;&gt;/device/&lt;/span&gt;pwm2=&lt;span class=&#34;hljs-number&#34;&gt;20&lt;/span&gt;&lt;br&gt;MAXTEMP=hwmon1&lt;span class=&#34;hljs-regexp&#34;&gt;/device/&lt;/span&gt;pwm2=&lt;span class=&#34;hljs-number&#34;&gt;60&lt;/span&gt;&lt;br&gt;MINSTART=hwmon1&lt;span class=&#34;hljs-regexp&#34;&gt;/device/&lt;/span&gt;pwm2=&lt;span class=&#34;hljs-number&#34;&gt;150&lt;/span&gt;&lt;br&gt;MINSTOP=hwmon1&lt;span class=&#34;hljs-regexp&#34;&gt;/device/&lt;/span&gt;pwm2=&lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;默认生成的配置基本能够满足需求，经过测试风扇在2000转左右噪音相对能够接受。&lt;/p&gt;
&lt;h2 id=&#34;VideoStation&#34;&gt;&lt;a href=&#34;#VideoStation&#34; class=&#34;headerlink&#34; title=&#34;VideoStation&#34;&gt;&lt;/a&gt;VideoStation&lt;/h2&gt;&lt;p&gt;参考：&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://zhuanlan.zhihu.com/p/357332211&#34;&gt;关于群晖NAS video station TMDB连接测试失败及搜刮结果下载失败的解决方案&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://zhuanlan.zhihu.com/p/152351243&#34;&gt;（群晖）关于Video Station内电影及电视剧封面简介为空白的处理方法&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;步骤-3&#34;&gt;&lt;a href=&#34;#步骤-3&#34; class=&#34;headerlink&#34; title=&#34;步骤&#34;&gt;&lt;/a&gt;步骤&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;TMDB的图片服务器被屏蔽需要修改hosts 加上 api.themoviedb.org 的ip&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;修改hosts后即可测试，已经连通&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;搜刮信息会出现下载失败，主要是下载图片的url需要切换一下&lt;/p&gt;
&lt;p&gt;  编辑 util_themoviedb.php 文件&lt;/p&gt;
  &lt;figure class=&#34;highlight text&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs text&#34;&gt;cd /var/packages/VideoStation/target/plugins&lt;br&gt;vi util_themoviedb.php&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
  &lt;figure class=&#34;highlight text&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs text&#34;&gt;# 找到下面的语句&lt;br&gt;define(&amp;#x27;API_URL&amp;#x27;, &amp;#x27;https://api.themoviedb.org/3/&amp;#x27;);&lt;br&gt;define(&amp;#x27;BANNER_URL&amp;#x27;, &amp;#x27;https://image.tmdb.org/t/p/w500&amp;#x27;);&lt;br&gt;define(&amp;#x27;BACKDROUP_URL&amp;#x27;, &amp;#x27;https://image.tmdb.org/t/p/original&amp;#x27;);&lt;br&gt;&lt;br&gt;# 我们只需要把改为&lt;br&gt;image.tmdb.org&lt;br&gt;# 改为&lt;br&gt;www.themoviedb.org&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;Gogs&#34;&gt;&lt;a href=&#34;#Gogs&#34; class=&#34;headerlink&#34; title=&#34;Gogs&#34;&gt;&lt;/a&gt;Gogs&lt;/h2&gt;&lt;h3 id=&#34;参考&#34;&gt;&lt;a href=&#34;#参考&#34; class=&#34;headerlink&#34; title=&#34;参考&#34;&gt;&lt;/a&gt;参考&lt;/h3&gt;&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/cfan927/article/details/100862989&#34;&gt;【工具】群晖利用docker安装Gogs代码管理平台&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;步骤-4&#34;&gt;&lt;a href=&#34;#步骤-4&#34; class=&#34;headerlink&#34; title=&#34;步骤&#34;&gt;&lt;/a&gt;步骤&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;打开“Docker”-&amp;gt;”注册表”，搜索Gogs并“右键”-&amp;gt;“下载此映像”&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/watermark.png&#34; alt=&#34;在这里插入图片描述&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在”映像“页面中安装Gogs容器后，切换到”容器“页面，然后双击打开Gogs详情页&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;设定容器的本地端口&lt;/li&gt;
&lt;li&gt;设定桌面快捷方式&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Gogs配置&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Windows中用ssh登录群晖服务器，cd到mariaDB目录下：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;cd /volume1/@appstore/MariaDB10/usr/local/mariadb10/bin/&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;输入命令 &lt;code&gt;./mysql -u root -p&lt;/code&gt;，然后输入密码，连接数据库&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;输入命令 &lt;code&gt;use mysql&lt;/code&gt;切换到mysql数据库&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;创建数据库gogs&lt;br&gt; &lt;code&gt;CREATE DATABASE IF NOT EXISTS gogs;&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;输入下面的命令获取数据库远程访问权限 ：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;GRANT ALL PRIVILEGES ON gogs.* TO &amp;#39;user&amp;#39;@&amp;#39;%&amp;#39; IDENTIFIED BY &amp;#39;password&amp;#39; WITH GRANT OPTION;&lt;/code&gt;&lt;br&gt;其中user为用户名&lt;br&gt;password为用户密码&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;然后用&lt;code&gt;show databases;&lt;/code&gt;命令查看一下结果&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;gogs:port 设定相关参数即可&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;着重需要说明的是：&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;tips&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;删除数据库  &lt;code&gt;DROP DATABASE gogs;&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;Note-1&#34;&gt;&lt;a href=&#34;#Note-1&#34; class=&#34;headerlink&#34; title=&#34;Note&#34;&gt;&lt;/a&gt;Note&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;gogs 的配置保存在&lt;code&gt;/data/gogs/conf/app.ini&lt;/code&gt; 参考下图&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/image-20211103161058734.png&#34; alt=&#34;image-20211103161058734&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;注意&lt;/strong&gt; MariaDB的port默认是不开的，需要去套件里面打开。&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Domain&lt;/strong&gt; 填写Docker宿主机的物理IP地址，或者域名地址,注意这里是不带 http的 如： 192.168.137.140 或 git.mydomain.com&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SSH port&lt;/strong&gt; 假如Docker映射的端口是 10022:22 那么这里就填写宿主机开放的端口 10022&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;HTTP port&lt;/strong&gt; 假如Docker映射的端口是 10080:3000 这里要填容器内的监听端口 3000&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Application URL&lt;/strong&gt; 这里要填写的格式为 http(s)?&amp;#x2F; + Domain + HTTP port ，比如：&lt;a href=&#34;http://git.mydomain.com/10080&#34;&gt;http://git.mydomain.com/10080&lt;/a&gt; 。还需要注意的一点是，如果你用了nginx来映射宿主机的 10080 端口，这里要去掉后面的端口，即 &lt;a href=&#34;http://git.mydomain.com/%EF%BC%8C%E8%AF%B4%E7%99%BD%E4%BA%86%E5%B0%B1%E6%98%AF%E4%BD%A0%E5%9C%A8%E5%A4%96%E9%83%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8A%E8%AE%BF%E9%97%AE%E7%9A%84%E5%9C%B0%E5%9D%80%E3%80%82&#34;&gt;http://git.mydomain.com/，说白了就是你在外部浏览器上访问的地址。&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;注意&lt;/strong&gt;非标准port的ssh需要注意clone地址是否正确&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;备份&#34;&gt;&lt;a href=&#34;#备份&#34; class=&#34;headerlink&#34; title=&#34;备份&#34;&gt;&lt;/a&gt;备份&lt;/h4&gt;&lt;p&gt;&lt;a href=&#34;https://github.com/gogs/gogs/discussions/6876&#34;&gt;https://github.com/gogs/gogs/discussions/6876&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;数据备份&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;因为容器内的 &lt;code&gt;/data&lt;/code&gt; 目录是直接挂载到宿主机的，我们把容器内备份目录设置为 &lt;code&gt;/data&lt;/code&gt; ， 方便宿主机将备份文件同步到远程备份服务器。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs shell&#34;&gt;docker container exec gogs su - git -s /bin/ash \&lt;br&gt;-c &amp;quot;/app/gogs/gogs backup \&lt;br&gt;--config=/data/gogs/conf/app.ini \&lt;br&gt;--target=/gogs&amp;quot;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;注意挂载目录的权限&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;数据恢复&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;用docker完成gogs部署之后，进入容器，执行下面命令&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs shell&#34;&gt;docker container exec -it gogs su - git -s /bin/ash \&lt;br&gt;-c &amp;quot;/app/gogs/gogs restore \&lt;br&gt;--config=/data/gogs/conf/app.ini \&lt;br&gt;--tempdir=/data \&lt;br&gt;--from=/data/gogs-backup-20211230091744.zip&amp;quot;&lt;br&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;注意：&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;备份和恢复时，使用的 gogs 版本必须是一致的&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;备份和恢复时，使用的 mysql 版本必须是一致的&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;自述文档&#34;&gt;&lt;a href=&#34;#自述文档&#34; class=&#34;headerlink&#34; title=&#34;自述文档&#34;&gt;&lt;/a&gt;自述文档&lt;/h4&gt;&lt;p&gt;Create a plain text file then move to directory &lt;code&gt;custom/conf/readme/README&lt;/code&gt; and &lt;strong&gt;restart Gogs.&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;&amp;#123;Name&amp;#125;&lt;/code&gt;: Repository name&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;#123;Description&amp;#125;&lt;/code&gt;: Repository description&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;#123;CloneURL.SSH&amp;#125;&lt;/code&gt;: Repository SSH clone address&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;#123;CloneURL.HTTPS&amp;#125;&lt;/code&gt;: Repository HTTP&amp;#x2F;HTTPS clone address&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs shell&#34;&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;&amp;#123;Name&amp;#125;&lt;/span&gt;&lt;br&gt;&amp;#123;Name&amp;#125; Repository&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# Tip&lt;/span&gt;&lt;/span&gt;&lt;br&gt;You can get the development version of this repo via&lt;br&gt;**git clone &amp;#123;CloneURL.SSH&amp;#125;**&lt;br&gt;or&lt;br&gt;**git clone &amp;#123;CloneURL.HTTPS&amp;#125;**&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# Bref&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;#123;Description&amp;#125;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# Details&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;



&lt;h2 id=&#34;zerotier&#34;&gt;&lt;a href=&#34;#zerotier&#34; class=&#34;headerlink&#34; title=&#34;zerotier&#34;&gt;&lt;/a&gt;zerotier&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;img name&lt;/th&gt;
&lt;th&gt;last version&lt;/th&gt;
&lt;th&gt;notes&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;henrist-zerotier-one1&lt;/td&gt;
&lt;td&gt;1.6.6&lt;/td&gt;
&lt;td&gt;没有自动配置路由&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;bltavares zerotier&lt;/td&gt;
&lt;td&gt;1.6.6&lt;/td&gt;
&lt;td&gt;网络不通&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;zyclonite&amp;#x2F;zerotier&amp;#x2F;&lt;/td&gt;
&lt;td&gt;1.8.4&lt;/td&gt;
&lt;td&gt;没有自动配置路由 配置路由后正常&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;spikhalskiy-zerotier1&lt;/td&gt;
&lt;td&gt;1.8.2&lt;/td&gt;
&lt;td&gt;运行会报错&lt;code&gt;zerotier-cli: /usr/lib/libstdc++.so.6: no version information available (required by zerotier-cli)&lt;/code&gt;, 没有自动配置路由 配置路由后正常&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;zerotier-zerotier-synology&lt;/td&gt;
&lt;td&gt;1.8.4&lt;/td&gt;
&lt;td&gt;没有自动配置路由 配置路由后正常&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;figure class=&#34;highlight livescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs livescript&#34;&gt;docker run &lt;span class=&#34;hljs-string&#34;&gt;\&lt;/span&gt;&lt;br&gt;  -d &lt;span class=&#34;hljs-string&#34;&gt;\&lt;/span&gt;&lt;br&gt;  --restart always &lt;span class=&#34;hljs-string&#34;&gt;\&lt;/span&gt;&lt;br&gt;  --name zerotier-one &lt;span class=&#34;hljs-string&#34;&gt;\&lt;/span&gt;&lt;br&gt;  --device /dev/net/tun &lt;span class=&#34;hljs-string&#34;&gt;\&lt;/span&gt;&lt;br&gt;  --net host &lt;span class=&#34;hljs-string&#34;&gt;\&lt;/span&gt;&lt;br&gt;  --cap-add NET_ADMIN &lt;span class=&#34;hljs-string&#34;&gt;\&lt;/span&gt;&lt;br&gt;  --cap-add SYS_ADMIN &lt;span class=&#34;hljs-string&#34;&gt;\&lt;/span&gt;&lt;br&gt;  -v /&lt;span class=&#34;hljs-keyword&#34;&gt;var&lt;/span&gt;/lib/zerotier-one:/&lt;span class=&#34;hljs-keyword&#34;&gt;var&lt;/span&gt;/lib/zerotier-one &lt;span class=&#34;hljs-string&#34;&gt;\&lt;/span&gt;&lt;br&gt;  zerotier/zerotier-synology&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;



&lt;h2 id=&#34;第三方套件&#34;&gt;&lt;a href=&#34;#第三方套件&#34; class=&#34;headerlink&#34; title=&#34;第三方套件&#34;&gt;&lt;/a&gt;第三方套件&lt;/h2&gt;&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs shell&#34;&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;矿神&lt;/span&gt;&lt;br&gt;https://spk.imnks.com/&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;



&lt;h2 id=&#34;群晖的备份-还原&#34;&gt;&lt;a href=&#34;#群晖的备份-还原&#34; class=&#34;headerlink&#34; title=&#34;群晖的备份 还原&#34;&gt;&lt;/a&gt;群晖的备份 还原&lt;/h2&gt;&lt;p&gt;晖硬盘接到电脑上使用diskgenius查看，有三个分区：系统、swap交换分区、数据存储区，所有的硬盘都有这三个分区。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;  交换分区，英文是swap，意思是“交换”、“实物交易”。 它的功能就是在内存不够的情况下，操作系统先把内存中暂时不用的数据，存到硬盘的交换空间，腾出内存来让别的程序运行，和Windows的虚拟内存（pagefile.sys）的作用是一样的。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/image-20220918161100014.png&#34; alt=&#34;image-20220918161100014&#34;&gt;&lt;/p&gt;
&lt;p&gt;弄清楚这三个分区是做什么的就很简单了, 我们备份和还原自然也就是备份和还原第一个系统分区了.&lt;/p&gt;
&lt;p&gt;需要注意的是群晖的系统存在于任何一块硬盘内, &lt;strong&gt;所以还原分区的时候需要将分区还原到每一块硬盘内才行&lt;/strong&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;  如果只还原一块后，开机进入系统，系统会提示修复，虽然也能成功但是并不建议这么做&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;群晖-硬盘扩容-硬盘升级&#34;&gt;&lt;a href=&#34;#群晖-硬盘扩容-硬盘升级&#34; class=&#34;headerlink&#34; title=&#34;群晖 硬盘扩容 硬盘升级&#34;&gt;&lt;/a&gt;群晖 硬盘扩容 硬盘升级&lt;/h2&gt;&lt;p&gt;紧跟上面, 如果我们需要进行硬盘扩容, 比如原来的硬盘128G, 现在购入一块新硬盘256G, 我们需要用256去替换原来的硬盘, 但是现有设备上盘位已经插满了或者是属于单盘位的机器, 这时候就要把硬盘拆下来手动将数据进行转移.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;  我的大致思路是使用DG全盘拷贝到256G硬盘上(当时尝试的时候没有找到这方面的文章, 不知道该怎么样操作, 担心数据出问题所以就用了全盘拷贝), 然后上电开机SSH登录上去扩容一下分区就好.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;克隆数据&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;首先打开&lt;code&gt;DiskGenius&lt;/code&gt;软件 选择 -&amp;gt; &lt;code&gt;工具&lt;/code&gt; -&amp;gt; &lt;code&gt;克隆磁盘&lt;/code&gt; 我这里选的是按扇区全盘克隆.&lt;/p&gt;
&lt;p&gt;讲道理来说将&lt;code&gt;系统区&lt;/code&gt;、&lt;code&gt;数据存储区&lt;/code&gt;拷贝过去, 再划分出&lt;code&gt;swap交换分区&lt;/code&gt;应该也是可以的.&lt;/p&gt;
&lt;p&gt;等待克隆完成.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;扩容分区&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;磁盘克隆完成后, 旧的硬盘先不能格式化掉, 需要先留着以防万一.&lt;/p&gt;
&lt;p&gt;将新的硬盘安装回群晖, 并上电开机, 开机一切正常, 查看存储管理器会发现, 256的磁盘只显示了128G, 这个时候我们就需要登录SSH进行下一步操作了.&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 首先查看一下新放进去的盘的挂载位置&lt;/span&gt;&lt;br&gt;$ fdisk -l&lt;br&gt;Disk /dev/sda: 232.9 GiB, 250059350016 bytes, 488397168 sectors&lt;br&gt;Units: sectors of 1 * 512 = 512 bytes&lt;br&gt;Sector size (logical/physical): 512 bytes / 512 bytes&lt;br&gt;I/O size (minimum/optimal): 512 bytes / 512 bytes&lt;br&gt;Disklabel &lt;span class=&#34;hljs-built_in&#34;&gt;type&lt;/span&gt;: dos&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 上面可以看到 设备在`/dev/sda` 这里的sda里面的a是按顺序来的 第二个第三个盘就是sdb sdc 类推&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 输入命令后它会让我们输入结束地址, 我们这里直接回车, 设定地址为最末尾&lt;/span&gt;&lt;br&gt;$ parted /dev/sda resizepart 3&lt;br&gt;End?  [250GB]?&lt;br&gt;Information: You may need to update /etc/fstab.&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 这里运行的时候报错了, 但是时间有点久没有记录下来给忘记了, 哎这些东西还是不能拖, 要立刻记录下来才行&lt;/span&gt;&lt;br&gt;$ resize2fs -f /dev/sda3 &lt;br&gt;resize2fs 1.42.6 (21-Sep-2012)&lt;br&gt;.....&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 再次查看扩容完成&lt;/span&gt;&lt;br&gt;$ fdisk -l&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;参考:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://imnks.com/389.html&#34;&gt;群晖升级硬盘 磁盘克隆后的简单扩容教程&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;群晖安装USB网卡驱动-AX88179A-6-2-3&#34;&gt;&lt;a href=&#34;#群晖安装USB网卡驱动-AX88179A-6-2-3&#34; class=&#34;headerlink&#34; title=&#34;群晖安装USB网卡驱动 AX88179A 6.2.3&#34;&gt;&lt;/a&gt;群晖安装USB网卡驱动 AX88179A 6.2.3&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/image-20220926214605083.png&#34; alt=&#34;image-20220926214605083&#34;&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;将USB网卡插入群晖&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;下载驱动程序 &lt;a href=&#34;%E7%BE%A4%E6%99%96/ax88179_178a.ko.zip&#34;&gt;ax88179_178a.ko.zip&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;解压后将&lt;code&gt;ax88179_178a.ko&lt;/code&gt;文件复制到群晖的&lt;code&gt;/lib/modules/&lt;/code&gt;目录下&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;cp&lt;/span&gt; /volume......./ax88179_178a.ko /lib/modules&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;使用命令 &lt;code&gt;chmod 644 ax88179_178a.ko&lt;/code&gt;修改文件权限为&lt;code&gt;-rw-r--r--&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;加载驱动&lt;code&gt;insmod /lib/modules/ax88179_178a.ko &lt;/code&gt; &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;我这里当时报错了, 但是似乎并没有什么影响&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;insmod: ERROR: could not insert module /lib/modules/ax88179_178a.ko: Invalid module format&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;拓展一下&lt;/p&gt;
&lt;blockquote&gt;
  &lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 获取已加载的驱动列表&lt;/span&gt;&lt;br&gt;lsmod&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 卸载驱动&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 参数为lsmod获取到的驱动名称，而不是路径&lt;/span&gt;&lt;br&gt;rmmod ax88179_178a&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;启用网卡 &lt;code&gt;ifconfig eth1 up&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;重新启动&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;  网上很多blog写需要添加启动项, 但是我这里并没有添加 看起来也没有什么问题.&lt;/p&gt;
&lt;p&gt;  添加启动项的操作是在群晖的&lt;code&gt;设置&lt;/code&gt;里面 添加一个&lt;code&gt;任务计划&lt;/code&gt;开机触发执行下面这个脚本&lt;/p&gt;
  &lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;insmod /lib/modules/ax88179_178a.ko&lt;br&gt;ifconfig eth1 up&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;/blockquote&gt;
&lt;h2 id=&#34;PC通过群晖的网卡桥接上网&#34;&gt;&lt;a href=&#34;#PC通过群晖的网卡桥接上网&#34; class=&#34;headerlink&#34; title=&#34;PC通过群晖的网卡桥接上网&#34;&gt;&lt;/a&gt;PC通过群晖的网卡桥接上网&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;注意&lt;/strong&gt;:首先需要确定Open vSwitch是开启的. 控制面板-&amp;gt;网络-&amp;gt;网络界面-&amp;gt;管理，打开Open vSwitch（如果使用了VMM套件会自动开启，而且提示无法禁用）.&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 路径图&lt;/span&gt;&lt;br&gt;网关(路由器) &amp;lt;-eth0-&amp;gt; 群晖 &amp;lt;-eth1-&amp;gt; PC&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;装了群晖的Virtual Machine Manager后一个接口会多出来一块网卡, 其中&lt;code&gt;eth0&lt;/code&gt;是物理网卡, &lt;code&gt;ovs_eth0&lt;/code&gt;是Open vSwitch这个网络管理工具虚拟出来的网卡.&lt;/p&gt;
&lt;p&gt;一般来说&lt;code&gt;eth0&lt;/code&gt;会空闲, 流量都是通过&lt;code&gt;ovs_eth0&lt;/code&gt;这个虚拟网卡, 其中&lt;code&gt;eth0&lt;/code&gt;会被配置成与&lt;code&gt;ovs_eth0&lt;/code&gt;桥接&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;修改配置文件&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;如你的电脑接在群晖的第一个网口&lt;code&gt;eth0&lt;/code&gt;就修改&lt;code&gt;ifcfg-eth0&lt;/code&gt;，接的是第二个网口&lt;code&gt;eth1&lt;/code&gt;就修改&lt;code&gt;ifcfg-eth1&lt;/code&gt;(本例)。&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 编辑&lt;/span&gt;&lt;br&gt;vim /etc/sysconfig/network-scripts/ifcfg-eth1&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 将BRIDGE 改成ovs_eth0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;# 原BRIDGE=ovs_eth1&lt;/span&gt;&lt;br&gt;BRIDGE=ovs_eth0&lt;br&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;blockquote&gt;
&lt;p&gt;   &lt;code&gt;/etc/sysconfig/network-scripts/ifcfg-eth1&lt;/code&gt;文件参数简介&lt;/p&gt;
&lt;p&gt;  &lt;img src=&#34;/2021/ee60585b/1841273-20191019215624473-1921771223.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;命令修改&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs shell&#34;&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;查看当前网桥 可以看到有两个网桥 ovs_eth0 和 ovs_eth1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;ovs-vsctl show&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;我们将网桥 ovs_eth1 删除, 并将 eth1 加入到 网桥ovs_eth0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;ovs-vsctl del-br ovs_eth1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;ovs-vsctl add-port ovs_eth0 eth1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;再次查看网桥状态&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;ovs-vsctl show&lt;/span&gt;&lt;br&gt;Bridge &amp;quot;ovs_eth0&amp;quot;&lt;br&gt;        Port &amp;quot;eth1&amp;quot;&lt;br&gt;            Interface &amp;quot;eth1&amp;quot;&lt;br&gt;        Port &amp;quot;eth0&amp;quot;&lt;br&gt;            Interface &amp;quot;eth0&amp;quot;&lt;br&gt;        Port &amp;quot;ovs_eth0&amp;quot;&lt;br&gt;            Interface &amp;quot;ovs_eth0&amp;quot;&lt;br&gt;                type: internal&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;此时eth0和eth1全部在ovs_eth0内，即两个网口处于同一个交换机内。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;将eth1和电脑相连，发现电脑可以正常从路由器获取IP地址，并正常上网&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;PC通过群晖的网卡NAT上网&#34;&gt;&lt;a href=&#34;#PC通过群晖的网卡NAT上网&#34; class=&#34;headerlink&#34; title=&#34;PC通过群晖的网卡NAT上网&#34;&gt;&lt;/a&gt;PC通过群晖的网卡NAT上网&lt;/h2&gt;&lt;p&gt;这里主要是利用&lt;code&gt;iptable&lt;/code&gt;路由流量.&lt;/p&gt;
&lt;p&gt;首先补个&lt;code&gt;iptable&lt;/code&gt;的教程&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://wooyun.js.org/drops/Iptables%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B.html&#34;&gt;Iptables入门教程&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;我们需要先给&lt;code&gt;局域网2 eth1&lt;/code&gt;设置一个静态ip &lt;code&gt;192.168.88.1/24 gw 192.168.88.1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;然后在DHCP服务器端开启&lt;code&gt;局域网2 eth1&lt;/code&gt;的DHCP服务, 网关填&lt;code&gt;192.168.88.1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;然后配置&lt;code&gt;iptable&lt;/code&gt;开启网口转发&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;/2021/ee60585b/image-20221121215936519.png&#34; alt=&#34;image-20221121215936519&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs shell&#34;&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;开启群晖的转发功能&lt;/span&gt;&lt;br&gt;echo &amp;quot;1&amp;quot; &amp;gt; /proc/sys/net/ipv4/ip_forward&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;为PC添加 去往群晖的 路由表 群晖开了对应接口的DHCP就不需要了&lt;/span&gt;&lt;br&gt;route add -net 192.168.88.0/24 gw 192.168.88.1&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;在群晖中添加iptable 策略&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;配置 NAT 服务器，执行命令&lt;/span&gt;&lt;br&gt;iptables -t nat -A POSTROUTING -s 192.168.88.0/24 -o ovs_eth0 -j MASQUERADE&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;-t 表名&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;-A 在指定链的末尾添加（--append）一条新的规则&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;-s 指定数据包的源地址参数，可以使IP地址、网络地址、主机名&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;   192.168.88.0 表示 192.168.88.x 的整个网络。&lt;/span&gt; &lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;-o 输出接口&lt;/span&gt; &lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;-j 目标动作或跳转&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;   MASQUERADE 则表示从 NAT 服务器的网卡上自动获取当前的 IP 地址来做端口转发。否则，基于目标的网络地址转换模式（即 DNAT）需要在每次 NAT 服务器连接外网的 IP 地址变更的时候重新配置端口转发。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;也可以使用源地址目标转换模式（即 SNAT），命令是&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;** 这里和上面选其一即可 **&lt;/span&gt;&lt;br&gt;iptables -t nat -A POSTROUTING -s 192.168.88.0/24 -o ovs_eth0 -j SNAT --to-source 192.168.20.2&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;显然这种方式也会依赖命令中指定的通向外网的 IP 地址，所以仍然不够灵活。推荐使用第一种方式。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;允许端口转发&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;此命令将允许经过 eth1 网卡（连接内网）的所有数据包通向外网的转发。&lt;/span&gt;&lt;br&gt;iptables -A FORWARD -i eth1 -j ACCEPT&lt;br&gt;&lt;span class=&#34;hljs-meta prompt_&#34;&gt;# &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;或者 仅允许转发192.168.88.0/24段的报文&lt;/span&gt;&lt;br&gt;iptables -A FORWARD -s 192.168.88.0/24 -j ACCEPT&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;参考&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/liuzhanchun/article/details/106819839&#34;&gt;Linux 内部路由实现及网口转发之理论篇&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/luozhen07/article/details/48051005&#34;&gt;Linux 系统双网卡实现内网端口转发&lt;/a&gt;&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
