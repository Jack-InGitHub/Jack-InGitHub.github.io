{
    "version": "https://jsonfeed.org/version/1",
    "title": "Oikiou's Blog • All posts by \"office\" tag",
    "description": "Blog",
    "home_page_url": "https://www.oikiou.top",
    "items": [
        {
            "id": "https://www.oikiou.top/2022/3ef2a47d/",
            "url": "https://www.oikiou.top/2022/3ef2a47d/",
            "title": "搭建KMS",
            "date_published": "2022-07-24T14:57:15.000Z",
            "content_html": "<h1 id=\"KMS\"><a href=\"#KMS\" class=\"headerlink\" title=\"KMS\"></a>KMS</h1><p>KMS（Key Management Service），密钥管理服务</p>\n<p>能够通过KMS进行激活的一般称为VL版,即VOLUME授权版，一般不会单独在零售市场进行发售，一般是直接向企业提供电子ISO映像进行批量授权安装，基于对KMS原理研究成果，我们可以自行搭建KMS激活服务器，实现每180天一次的自动激活，使得系统一直保持激活状态。</p>\n<p>KMS可以激活VOL版本的windows系统和office软件</p>\n<h1 id=\"Docker-部署KMS服务器\"><a href=\"#Docker-部署KMS服务器\" class=\"headerlink\" title=\"Docker 部署KMS服务器\"></a>Docker 部署KMS服务器</h1><p><a href=\"https://registry.hub.docker.com/r/teddysun/kms\">https://registry.hub.docker.com/r/teddysun/kms</a></p>\n<ol>\n<li><p>Pull the image</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">docker pull teddysun/kms<br></code></pre></td></tr></table></figure>\n<p>This pulls the latest release of KMS server. It can be found at Docker Hub.</p>\n</li>\n<li><p>Start a container</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">docker run -d -p 1688:1688 --name kms --restart=always teddysun/kms<br></code></pre></td></tr></table></figure>\n<p>Note: The TCP port number <code>1688</code> must be opened in firewall.</p>\n</li>\n</ol>\n<h1 id=\"激活\"><a href=\"#激活\" class=\"headerlink\" title=\"激活\"></a>激活</h1><h2 id=\"激活windows\"><a href=\"#激活windows\" class=\"headerlink\" title=\"激活windows\"></a>激活windows</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-comment\"># 待激活的主机上指定KMS服务器</span><br>slmgr /skms service_address(你搭建的服务器的地址)<br><br><span class=\"hljs-comment\"># 手动激活</span><br>slmgr /ato<br><br><span class=\"hljs-comment\"># 如果激活失败 尝试更改成GVLK KEY再次激活</span><br><span class=\"hljs-comment\"># 运行以下命令查看系统版本 </span><br>wmic os get caption<br><br><span class=\"hljs-comment\"># 访问下面的网址获取key</span><br><span class=\"hljs-comment\"># https://docs.microsoft.com/zh-cn/windows-server/get-started/kms-client-activation-keys</span><br><span class=\"hljs-comment\"># https://technet.microsoft.com/en-us/library/jj612867.aspx</span><br><span class=\"hljs-comment\"># 得到对应key之后，使用管理员权限运行cmd执行安装key：</span><br>slmgr /ipk xxxxx-xxxxx-xxxxx-xxxxx<br><br><span class=\"hljs-comment\"># 手动激活</span><br>slmgr /ato<br></code></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"激活office\"><a href=\"#激活office\" class=\"headerlink\" title=\"激活office\"></a>激活office</h2><p>首先你的OFFICE必须是VOL版本，否则无法激活。 找到你的office安装目录，比如</p>\n<figure class=\"highlight livescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs livescript\">C:<span class=\"hljs-string\">\\Program</span> Files (x86)<span class=\"hljs-string\">\\Microsoft</span> Office<span class=\"hljs-string\">\\Office16</span><br></code></pre></td></tr></table></figure>\n\n<p>64位的就是</p>\n<figure class=\"highlight livescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs livescript\">C:<span class=\"hljs-string\">\\Program</span> Files<span class=\"hljs-string\">\\Microsoft</span> Office<span class=\"hljs-string\">\\Office16</span><br></code></pre></td></tr></table></figure>\n<p>office16是office2016，office15就是2013，office14就是2010.</p>\n<p>然后目录对的话，该目录下面应该有个OSPP.VBS。</p>\n<p>直接输入下面的指令去指定KMS服务器</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs powershell\">cscript <span class=\"hljs-string\">&quot;C:\\Program Files (x86)\\Microsoft Office\\Office16\\OSPP.VBS&quot;</span> /sethst:service_address(你搭建的服务器的地址)<br><span class=\"hljs-comment\"># or</span><br>cscript <span class=\"hljs-string\">&quot;C:\\Program Files\\Microsoft Office\\Office16\\OSPP.VBS&quot;</span> /sethst:service_address(你搭建的服务器的地址)<br><br><span class=\"hljs-comment\"># cscript &quot;C:\\Program Files\\Microsoft Office\\Office16\\OSPP.VBS&quot; /sethst:8.8.8.8</span><br></code></pre></td></tr></table></figure>\n\n<p>一般来说，“一句命令已经完成了”，但一般office不会马上连接kms服务器进行激活，所以我们额外补充一条手动激活命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">cscript ospp.vbs /act<br></code></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"如果遇到报错，请检查：\"><a href=\"#如果遇到报错，请检查：\" class=\"headerlink\" title=\"如果遇到报错，请检查：\"></a>如果遇到报错，请检查：</h1><blockquote>\n<ol>\n<li>你的系统&#x2F;OFFICE是否是批量VL版本</li>\n<li>是否以管理员权限运行CMD</li>\n<li>你的系统&#x2F;OFFICE是否修改过KEY&#x2F;未安装GVLK KEY</li>\n<li>检查你的网络连接</li>\n<li>服务器繁忙，多试试（点击检查KMS服务是否可用）</li>\n<li>根据出错代码自己搜索出错原因</li>\n</ol>\n</blockquote>\n<h2 id=\"windows没有密钥\"><a href=\"#windows没有密钥\" class=\"headerlink\" title=\"windows没有密钥\"></a>windows没有密钥</h2><ul>\n<li>windows VOL KEY</li>\n</ul>\n<p><a href=\"https://docs.microsoft.com/zh-cn/windows-server/get-started/kmsclientkeys\">https://docs.microsoft.com/zh-cn/windows-server/get-started/kmsclientkeys</a></p>\n<h2 id=\"检查windows版本\"><a href=\"#检查windows版本\" class=\"headerlink\" title=\"检查windows版本\"></a>检查windows版本</h2><ul>\n<li>检查office是否是VOL版本</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-comment\"># 命令提示符（管理员）执行：cd “office的安装目录”</span><br><span class=\"hljs-built_in\">cd</span> <span class=\"hljs-string\">&quot;C:\\Program Files (x86)\\Microsoft Office\\Office16&quot;</span><br><span class=\"hljs-comment\"># or</span><br><span class=\"hljs-built_in\">cd</span> <span class=\"hljs-string\">&quot;C:\\Program Files\\Microsoft Office\\Office16&quot;</span><br><br><span class=\"hljs-comment\"># 执行：</span><br>cscript ospp.vbs /dstatus<br></code></pre></td></tr></table></figure>\n\n<p>在显示的信息中，如果有“VOLUME”字样就是VOL版，即支持KMS激活</p>\n<h2 id=\"office-密钥\"><a href=\"#office-密钥\" class=\"headerlink\" title=\"office 密钥\"></a>office 密钥</h2><ul>\n<li>卸载office的密钥</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-comment\"># 命令提示符（管理员）执行：cd “office的安装目录”</span><br><span class=\"hljs-built_in\">cd</span> <span class=\"hljs-string\">&quot;C:\\Program Files (x86)\\Microsoft Office\\Office16&quot;</span><br><span class=\"hljs-comment\"># or</span><br><span class=\"hljs-built_in\">cd</span> <span class=\"hljs-string\">&quot;C:\\Program Files\\Microsoft Office\\Office16&quot;</span><br><br><span class=\"hljs-comment\"># 查看当前状态</span><br>cscript ospp.vbs /dstatus<br><br><span class=\"hljs-comment\"># 找到 Last 5 characters of installed product key:XXXXX 语句</span><br><span class=\"hljs-comment\"># 卸载密钥</span><br>cscript ospp.vbs /unpkey:XXXXX<br></code></pre></td></tr></table></figure>\n\n<ul>\n<li>查找office的VOL KEY</li>\n</ul>\n<p><a href=\"https://docs.microsoft.com/zh-cn/DeployOffice/vlactivation/gvlks\">https://docs.microsoft.com/zh-cn/DeployOffice/vlactivation/gvlks</a></p>\n<ul>\n<li><p>安装密钥</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs shell\"><span class=\"hljs-meta prompt_\"># </span><span class=\"language-bash\">Office 专业增强版 2016</span><br>cscript ospp.vbs /inpkey:XQNVK-8JYDB-WJ9W3-YJ8YR-WFG99<br></code></pre></td></tr></table></figure></li>\n</ul>\n",
            "tags": [
                "kms",
                "office",
                "volume"
            ]
        }
    ]
}