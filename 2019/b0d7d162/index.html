<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.webp"><link rel="icon" href="/img/favicon.webp"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="author" content="Oikiou"><meta name="keywords" content=""><meta name="description" content="C语言高质量编程1.2 头文件的结构 头文件开头处的版权和版本声明（参见示例1-1）。 预处理块。 函数和类结构声明等。  假设头文件名称为 graphics.h，头文件的结构参见下面。  【规则1-2-1】为了防止头文件被重复引用，应当用ifndef&#x2F;define&#x2F;endif 结构产生预处理块。 【规则 1-2-2】用#include &lt;filename.h&gt; 格式来引用标准库的头文"><meta property="og:type" content="article"><meta property="og:title" content="C语言高质量编程"><meta property="og:url" content="https://www.oikiou.top/2019/b0d7d162/index.html"><meta property="og:site_name" content="Oikiou&#39;s Blog"><meta property="og:description" content="C语言高质量编程1.2 头文件的结构 头文件开头处的版权和版本声明（参见示例1-1）。 预处理块。 函数和类结构声明等。  假设头文件名称为 graphics.h，头文件的结构参见下面。  【规则1-2-1】为了防止头文件被重复引用，应当用ifndef&#x2F;define&#x2F;endif 结构产生预处理块。 【规则 1-2-2】用#include &lt;filename.h&gt; 格式来引用标准库的头文"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2019-10-28T02:30:00.000Z"><meta property="article:modified_time" content="2022-09-29T17:34:42.954Z"><meta property="article:author" content="Oikiou"><meta property="article:tag" content="c"><meta name="twitter:card" content="summary_large_image"><meta name="referrer" content="no-referrer-when-downgrade"><title>C语言高质量编程 - Oikiou&#39;s Blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/custom.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var dntVal,CONFIG={hostname:"www.oikiou.top",root:"/",version:"1.9.4",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"bash"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"left",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!1,baidu:null,google:"G-TSV6137NWK",gtag:"G-TSV6137NWK",tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/xml/local-search-database.xml"};CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.google-analytics.com/analytics.js",function(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-TSV6137NWK","auto"),ga("send","pageview")})</script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=G-TSV6137NWK",function(){function a(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],a("js",new Date),a("config","G-TSV6137NWK")})</script><meta name="generator" content="Hexo 6.3.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Oikiou&#39;s Blog</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(https://bing.img.run/1920x1080.php) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="C语言高质量编程"></span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> Oikiou </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2019-10-28 10:30" pubdate>2019年10月28日 上午</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 6.5k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 109 分钟 </span><span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="busuanzi_value_page_pv"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="padding-left:2rem;margin-right:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">C语言高质量编程</h1><p class="note note-info">本文最后更新于：9 个月前</p><div class="markdown-body"><h1 id="C语言高质量编程"><a href="#C语言高质量编程" class="headerlink" title="C语言高质量编程"></a>C语言高质量编程</h1><h1 id="1-2-头文件的结构"><a href="#1-2-头文件的结构" class="headerlink" title="1.2 头文件的结构"></a>1.2 头文件的结构</h1><ol><li>头文件开头处的版权和版本声明（参见示例1-1）。</li><li>预处理块。</li><li>函数和类结构声明等。</li></ol><p>假设头文件名称为 <code>graphics.h</code>，头文件的结构参见下面。</p><ul><li>【规则1-2-1】为了防止头文件被重复引用，应当用<code>ifndef/define/endif</code> 结构产生预处理块。</li><li>【规则 1-2-2】用<code>#include &lt;filename.h&gt;</code> 格式来引用标准库的头文件（编译器将从标准库目录开始搜索）。</li><li>【规则1-2-3】用<code>#include “filename.h”</code> 格式来引用非标准库的头文件（编译器将从用户的工作目录开始搜索）。</li><li>【建议1-2-1】头文件中只存放“声明”而不存放“定义”在 C++ 语法中，类的成员函数可以在声明的同时被定义，并且自动成为内联函数。这虽然会带来书写上的方便，但却造成了风格不一致，弊大于利。建议将成员函数的定义与声明分开，不论该函数体有多么小。</li><li>【建议1-2-2】不提倡使用全局变量，尽量不要在头文件中出现象extern int value 这类声明。</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> GRAPHICS_H <span class="hljs-comment">// 防止graphics.h 被重复引用</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> GRAPHICS_H</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span> <span class="hljs-comment">// 引用标准库的头文件</span></span><br>⋯<br><span class="hljs-meta">#<span class="hljs-keyword">include</span> “myheader.h” <span class="hljs-comment">// 引用非标准库的头文件</span></span><br>⋯<br><span class="hljs-type">void</span> <span class="hljs-title function_">Function1</span><span class="hljs-params">(⋯)</span>; <span class="hljs-comment">// 全局函数声明</span><br>⋯<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Box</span> // 类结构声明</span><br><span class="hljs-class">&#123;</span><br>⋯<br>&#125;;<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br></code></pre></td></tr></table></figure><h1 id="1-3-定义文件的结构"><a href="#1-3-定义文件的结构" class="headerlink" title="1.3 定义文件的结构"></a>1.3 定义文件的结构</h1><p>定义文件有三部分内容：</p><ol><li>定义文件开头处的版权和版本声明（参见示例1-1）。</li><li>对一些头文件的引用。</li><li>程序的实现体（包括数据和代码）。<br>假设定义文件的名称为 graphics.cpp，定义文件的结构参见下面。</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> “graphics.h” <span class="hljs-comment">// 引用头文件</span></span><br>⋯<br><span class="hljs-comment">// 全局函数的实现体</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">Function1</span><span class="hljs-params">(⋯)</span><br>&#123;<br>⋯<br>&#125;<br><span class="hljs-comment">// 类成员函数的实现体</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">Box::Draw</span><span class="hljs-params">(⋯)</span><br>&#123;<br>⋯<br>&#125;<br><br></code></pre></td></tr></table></figure><h1 id="2-1-空行"><a href="#2-1-空行" class="headerlink" title="2.1 空行"></a>2.1 空行</h1><p>空行起着分隔程序段落的作用。空行得体（不过多也不过少）将使程序的布局更加清晰。空行不会浪费内存，虽然打印含有空行的程序是会多消耗一些纸张，但是值得。所以不要舍不得用空行。</p><ul><li>【规则 2-1-1】在每个类声明之后、每个函数定义结束之后都要加空行。参见示例2-1（a）</li><li>【规则2-1-2】在一个函数体内，逻揖上密切相关的语句之间不加空行，其它地方应加空行分隔</li></ul><h1 id="2-2-代码行"><a href="#2-2-代码行" class="headerlink" title="2.2 代码行"></a>2.2 代码行</h1><ul><li>【规则2-2-1】<strong>一行代码只做一件事情</strong>，<strong>如只定义一个变量</strong>，或只写一条语句。这样的代码容易阅读，并且方便于写注释。</li><li>【规则2-2-2】if、for、while、do 等语句自占一行，执行语句不得紧跟其后。**不论执行语句有多少都要加{}**。这样可以防止书写失误。</li></ul><h1 id="2-3-代码行内的空格"><a href="#2-3-代码行内的空格" class="headerlink" title="2.3 代码行内的空格"></a>2.3 代码行内的空格</h1><ul><li>【规则2-3-1】关键字之后要留空格。象const、virtual、inline、case 等关键字之后至少要留一个空格，否则无法辨析关键字。象if、for、while 等关键字之后应留一个空格再跟左括号‘（’，以突出关键字。</li><li>【规则2-3-2】函数名之后不要留空格，紧跟左括号‘（’，以与关键字区别。</li><li><strong>【规则2-3-3】</strong>‘（’向后紧跟，‘）’、‘，’、‘;’ 向前紧跟，<strong>紧跟处不留空格。</strong></li><li><strong>【规则2-3-4】</strong>‘，’之后要留空格，如<code>Function(x, y, z)</code>。如果‘;’不是一行的结束符号，其后要留空格，如<code>for (initialization; condition; update)</code>。</li><li>【规则2-3-5】赋值操作符、比较操作符、算术操作符、逻辑操作符、位域操作符，如“&#x3D;”、“+&#x3D;” “&gt;&#x3D;”、“&lt;&#x3D;”、“+”、“*”、“%”、“&amp;&amp;”、“||”、“&lt;&lt;”,“^”等二元操作符的前后应当加空格。</li><li>【规则2-3-6】一元操作符如“!”、“~”、“++”、“–”、“&amp;”（地址运算符）等前后不加空格。</li><li>【规则2-3-7】xu“［］”、“.”、“-&gt;”这类操作符前后不加空格。</li><li>【建议2-3-1】对于表达式比较长的for 语句和if 语句，为了紧凑起见可以适当地去掉一些空格，如<code>for (i=0; i&lt;10; i++)和if ((a&lt;=b) &amp;&amp; (c&lt;=d))</code></li></ul><h1 id="2-4-对齐"><a href="#2-4-对齐" class="headerlink" title="2.4 对齐"></a>2.4 对齐</h1><ul><li>【规则2-4-1】程序的分界符‘{’和‘}’应独占一行并且位于同一列，同时与引用它们的语句左对齐。</li><li>【规则2-4-2】{ }之内的代码块在‘{’右边数格处左对齐。</li></ul><h1 id="2-5-长行拆分"><a href="#2-5-长行拆分" class="headerlink" title="2.5 长行拆分"></a>2.5 长行拆分</h1><ul><li>【规则2-5-1】代码行最大长度宜控制在70 至80 个字符以内。代码行不要过长，否则眼睛看不过来，也不便于打印。</li><li>【规则2-5-2】长表达式要在低优先级操作符处拆分成新行，操作符放在新行之首（以便突出操作符）。拆分出的新行要进行适当的缩进，使排版整齐，语句可读。</li></ul><h1 id="2-6-修饰符的位置"><a href="#2-6-修饰符的位置" class="headerlink" title="2.6 修饰符的位置"></a>2.6 修饰符的位置</h1><p>修饰符 * 和＆ 应该靠近数据类型还是该靠近变量名，是个有争议的活题。若将修饰符 * 靠近数据类型，例如：int* x; 从语义上讲此写法比较直观，即x是int 类型的指针。上述写法的弊端是容易引起误解，例如：int* x, y; 此处y 容易被误解为指针变量。虽然将x 和y 分行定义可以避免误解，但并不是人人都愿意这样做。</p><ul><li>【规则2-6-1】应当将修饰符 * 和＆ 紧靠变量名</li></ul><h1 id="2-7-注释"><a href="#2-7-注释" class="headerlink" title="2.7 注释"></a>2.7 注释</h1><p>C 语言的注释符为“&#x2F;<em>…</em>&#x2F;”。C++语言中，程序块的注释常采用“&#x2F;<em>…</em>&#x2F;”，行注释一般采用“&#x2F;&#x2F;…”。注释通常用于：<br>（1）版本、版权声明；<br>（2）函数接口说明；<br>（3）重要的代码行或段落提示。<br>虽然注释有助于理解代码，但注意不可过多地使用注释。<br>【规则2-7-1】注释是对代码的“提示”，而不是文档。程序中的注释不可喧宾夺主，注释太多了会让人眼花缭乱。注释的花样要少。<br>【规则2-7-2】如果代码本来就是清楚的，则不必加注释。否则多此一举，令人厌烦。例如i++; &#x2F;&#x2F; i 加 1，多余的注释<br>【规则2-7-3】边写代码边注释，修改代码同时修改相应的注释，以保证注释与代码的一致性。不再有用的注释要删除。<br>【规则2-7-4】注释应当准确、易懂，防止注释有二义性。错误的注释不但无益反而有害。<br>【规则2-7-5】尽量避免在注释中使用缩写，特别是不常用缩写。<br>【规则2-7-6】注释的位置应与被描述的代码相邻，可以放在代码的上方或右方，不可放在下方。<br><strong>【规则2-7-8】</strong>当代码比较长，特别是有多重嵌套时，应当在一些段落的结束处加注释，便于阅读。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/*</span><br><span class="hljs-comment">* 函数介绍：</span><br><span class="hljs-comment">* 输入参数：</span><br><span class="hljs-comment">* 输出参数：</span><br><span class="hljs-comment">* 返回值：</span><br><span class="hljs-comment">*/</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">Function</span><span class="hljs-params">(<span class="hljs-type">float</span> x, <span class="hljs-type">float</span> y, <span class="hljs-type">float</span> z)</span><br>&#123;<br>    …<br>&#125;<br><br><span class="hljs-keyword">if</span> (…)<br>&#123;<br>    …<br>    <span class="hljs-keyword">while</span> (…)<br>    &#123;<br>        …<br>    &#125; <span class="hljs-comment">// end of while</span><br>    …<br>&#125; <span class="hljs-comment">// end of if</span><br><br></code></pre></td></tr></table></figure><h1 id="3-2-简单的单片机应用程序命名规则"><a href="#3-2-简单的单片机应用程序命名规则" class="headerlink" title="3.2 简单的单片机应用程序命名规则"></a>3.2 简单的单片机应用程序命名规则</h1><ol><li>函数名用大写字母开头的单词组合而成。<br>例如：<br>void Draw(void); &#x2F;&#x2F; 函数名<br>void Setvalue(int value); &#x2F;&#x2F; 函数名</li><li>变量和参数用小写字母开头的单词组合而成，float 变量名前加 f，int 变量名前加 i，bit变量前加 b 。（char 不加）<br>例如：<br>bit b_tirm;<br>int i_time;<br>float f_time;<br>char time;</li><li>常量、宏定义（DF_xxx）全用大写的字母，用下划线分割单词。<br>例如：<br>code char MAX &#x3D; 100;<br>#define DF_MAX 100</li></ol><h1 id="4-3-if-语句"><a href="#4-3-if-语句" class="headerlink" title="4.3 if 语句"></a>4.3 if 语句</h1><h2 id="4-3-1-布尔变量与零值比较"><a href="#4-3-1-布尔变量与零值比较" class="headerlink" title="4.3.1 布尔变量与零值比较"></a>4.3.1 布尔变量与零值比较</h2><p>【规则4-3-1】不可将布尔变量直接与TRUE、FALSE 或者1、0 进行比较。根据布尔类型的语义，零值为“假”（记为FALSE），任何非零值都是“真”（记为TRUE）。TRUE 的值究竟是什么并没有统一的标准。例如Visual C++ 将TRUE 定义为</p><p>1，而Visual Basic 则将TRUE 定义为-1。</p><p>假设布尔变量名字为flag，它与零值比较的标准if 语句如下：</p><p>if (flag) &#x2F;&#x2F; 表示flag 为真</p><p>if (!flag) &#x2F;&#x2F; 表示flag 为假</p><p>其它的用法都属于不良风格，例如：<br>if (flag &#x3D;&#x3D; TRUE)<br>if (flag &#x3D;&#x3D; 1 )<br>if (flag &#x3D;&#x3D; FALSE)</p><p>if (flag &#x3D;&#x3D; 0)</p><h2 id="4-3-2-整型变量与零值比较"><a href="#4-3-2-整型变量与零值比较" class="headerlink" title="4.3.2 整型变量与零值比较"></a>4.3.2 整型变量与零值比较</h2><p>【规则4-3-2】应当将整型变量用“&#x3D;&#x3D;”或“！&#x3D;”直接与0 比较。<br>假设整型变量的名字为value，它与零值比较的标准if 语句如下：<br>if (value &#x3D;&#x3D; 0)<br>if (value !&#x3D; 0)<br>不可模仿布尔变量的风格而写成<br>if (value) &#x2F;&#x2F; 会让人误解 value 是布尔变量</p><p>if (!value)</p><h2 id="4-3-3-浮点变量与零值比较"><a href="#4-3-3-浮点变量与零值比较" class="headerlink" title="4.3.3 浮点变量与零值比较"></a>4.3.3 浮点变量与零值比较</h2><p>【规则4-3-3】不可将浮点变量用“&#x3D;&#x3D;”或“！&#x3D;”与任何数字比较。千万要留意，无论是float 还是double 类型的变量，都有精度限制。所以一定要避免将浮点变量用“&#x3D;&#x3D;”或“！&#x3D;”与数字比较，应该设法转化成“&gt;&#x3D;”或“&lt;&#x3D;”形式。</p><p>假设浮点变量的名字为x，应当将</p><p>if (x &#x3D;&#x3D; 0.0) &#x2F;&#x2F; 隐含错误的比较<br>转化为<br>if ((x&gt;&#x3D;-EPSINON) &amp;&amp; (x&lt;&#x3D;EPSINON))</p><p>其中EPSINON 是允许的误差（即精度）。</p><h3 id="4-3-4-指针变量与零值比较"><a href="#4-3-4-指针变量与零值比较" class="headerlink" title="4.3.4 指针变量与零值比较"></a>4.3.4 指针变量与零值比较</h3><p>【规则4-3-4】应当将指针变量用“&#x3D;&#x3D;”或“！&#x3D;”与NULL 比较。指针变量的零值是“空”（记为NULL）。尽管NULL 的值与0 相同，但是两者意义不同。假设指针变量的名字为p，它与零值比较的标准if 语句如下：</p><p>if (p &#x3D;&#x3D; NULL) &#x2F;&#x2F; p 与NULL 显式比较，强调p 是指针变量</p><p>if (p !&#x3D; NULL)<br>不要写成<br>if (p &#x3D;&#x3D; 0) &#x2F;&#x2F; 容易让人误解p 是整型变量<br>if (p !&#x3D; 0)<br>或者<br>if (p) &#x2F;&#x2F; 容易让人误解p 是布尔变量</p><p>if (!p)</p><h3 id="4-3-5-对if-语句的补充说明"><a href="#4-3-5-对if-语句的补充说明" class="headerlink" title="4.3.5 对if 语句的补充说明"></a>4.3.5 对if 语句的补充说明</h3><p>有时候我们可能会看到 if (NULL &#x3D;&#x3D; p) 这样古怪的格式。不是程序写错了，是程序员为了防止将 if (p &#x3D;&#x3D; NULL) 误写成 if (p &#x3D; NULL)，而有意把p 和NULL 颠倒。编译器认为 if (p &#x3D; NULL) 是合法的，但是会指出 if (NULL &#x3D; p)是错误的，因为NULL不能被赋值。</p><h1 id="4-4-循环语句的效率"><a href="#4-4-循环语句的效率" class="headerlink" title="4.4 循环语句的效率"></a>4.4 循环语句的效率</h1><p>【建议4-4-1】在多重循环中，如果有可能，应当将最长的循环放在最内层，最短的循环放在最外层，以减少CPU 跨切循环层的次数。例如示例4-4(b)的效率比示例4-4(a)的高。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 示例 4-4(a) 低效率：长循环在最外层 </span><br><span class="hljs-keyword">for</span> (row=<span class="hljs-number">0</span>; row&lt;<span class="hljs-number">100</span>; row++)<br>&#123;<br>    <span class="hljs-keyword">for</span> ( col=<span class="hljs-number">0</span>; col&lt;<span class="hljs-number">5</span>; col++ )<br>    &#123;<br>        sum = sum + a[row][col];<br>    &#125;<br>&#125;<br><span class="hljs-comment">// 示例4-4(b) 高效率：长循环在最内层</span><br><span class="hljs-keyword">for</span> (col=<span class="hljs-number">0</span>; col&lt;<span class="hljs-number">5</span>; col++ )<br>&#123;<br>    <span class="hljs-keyword">for</span> (row=<span class="hljs-number">0</span>; row&lt;<span class="hljs-number">100</span>; row++)<br>    &#123;<br>        sum = sum + a[row][col];<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>【建议4-4-2】如果循环体内存在逻辑判断，并且循环次数很大，宜将逻辑判断移到循环体的外面。示例4-4(c)的程序比示例4-4(d)多执行了N-1 次逻辑判断。并且由于前者老要进行逻辑判断，打断了循环“流水线”作业，使得编译器不能对循环进行优化处理，降低了效率。如果N 非常大，最好采用示例4-4(d)的写法，可以提高效率。如果N 非常小，两者效率差别并不明显，采用示例4-4(c)的写法比较好，因为程序更加简洁。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 效率低但程序简洁</span><br><span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i&lt;N; i++)<br>&#123;<br>    <span class="hljs-keyword">if</span> (condition)<br>        DoSomething();<br>    <span class="hljs-keyword">else</span><br>        DoOtherthing();<br>&#125;<br><span class="hljs-comment">// 效率高但程序不简洁</span><br><span class="hljs-keyword">if</span> (condition)<br>&#123;<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i&lt;N; i++)<br>        DoSomething();<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i&lt;N; i++)<br>        DoOtherthing();<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="4-5-for-语句的循环控制变量"><a href="#4-5-for-语句的循环控制变量" class="headerlink" title="4.5 for 语句的循环控制变量"></a>4.5 for 语句的循环控制变量</h1><p>【规则4-5-1】不可在for 循环体内修改循环变量，防止for 循环失去控制。<br>【建议4-5-1】建议for 语句的循环控制变量的取值采用“半开半闭区间”写法。<br>示例 4-5(a)中的x 值属于半开半闭区间“0 &#x3D;&lt; x &lt; N”，起点到终点的间隔为N，循环次数为N。<br>示例 4-5(b)中的x 值属于闭区间“0 &#x3D;&lt; x &lt;&#x3D; N-1”，起点到终点的间隔为N-1，循环次数为N。</p><p>相比之下，示例4-5(a)的写法更加直观，尽管两者的功能是相同的。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 循环变量属于半开半闭区间 </span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> x=<span class="hljs-number">0</span>; x&lt;N; x++)<br>&#123;<br>    ⋯<br>&#125;<br><span class="hljs-comment">// 循环变量属于闭区间</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> x=<span class="hljs-number">0</span>; x&lt;=N<span class="hljs-number">-1</span>; x++)<br>&#123;<br>    ⋯<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="4-6-switch-语句"><a href="#4-6-switch-语句" class="headerlink" title="4.6 switch 语句"></a>4.6 switch 语句</h1><p>【规则4-6-1】每个case 语句的结尾不要忘了加break，否则将导致多个分支重叠（除非有意使多个分支重叠）。<br>【规则4-6-2】不要忘记最后那个default 分支。即使程序真的不需要default 处理，也应该保留语句 default : break; 这样做并非多此一举，而是为了防止别人误以为你忘了default 处理。</p><h1 id="4-7-goto-语句"><a href="#4-7-goto-语句" class="headerlink" title="4.7 goto 语句"></a>4.7 goto 语句</h1><p>自从提倡结构化设计以来，goto 就成了有争议的语句。首先，由于goto 语句可以灵活跳转，如果不加限制，它的确会破坏结构化设计风格。其次，goto 语句经常带来错误或隐患。它可能跳过了某些对象的构造、变量的初始化、重要的计算等语句，例如：</p><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs pf">goto <span class="hljs-keyword">state</span>;<br>String s1, s2; // 被goto 跳过<br>int sum = <span class="hljs-number">0</span>; // 被goto 跳过<br>⋯<br><span class="hljs-keyword">state</span>:<br>⋯<br></code></pre></td></tr></table></figure><p>所以我们主张少用、慎用goto 语句，而不是禁用。</p><h1 id="5-1-为什么需要常量"><a href="#5-1-为什么需要常量" class="headerlink" title="5.1 为什么需要常量"></a>5.1 为什么需要常量</h1><p>如果不使用常量，直接在程序中填写数字或字符串，将会有什么麻烦？<br>（1） 程序的可读性（可理解性）变差。程序员自己会忘记那些数字或字符串是什么意思，用户则更加不知它们从何处来、表示什么。<br>（2） 在程序的很多地方输入同样的数字或字符串，难保不发生书写错误。</p><p>（3） 如果要修改数字或字符串，则会在很多地方改动，既麻烦又容易出错。</p><p>【规则5-1-1】尽量使用含义直观的常量来表示那些将在程序中多次出现的数字或字符串。</p><h1 id="5-2-const-与-define-的比较"><a href="#5-2-const-与-define-的比较" class="headerlink" title="5.2 const 与 #define 的比较"></a>5.2 const 与 #define 的比较</h1><p>C++ 语言可以用const 来定义常量，也可以用 #define 来定义常量。但是前者比后者有更多的优点：<br>（1） const 常量有数据类型，而宏常量没有数据类型。编译器可以对前者进行类型安全检查。而对后者只进行字符替换，没有类型安全检查，并且在字符替换可能会产生意料不到的错误（边际效应）。</p><p>（2） 有些集成化的调试工具可以对 const 常量进行调试，但是不能对宏常量进行调试。</p><p>【规则5-2-1】在C++ 程序中只使用const 常量而不使用宏常量，即const 常量完全取代宏常量</p><h1 id="5-3-常量定义规则"><a href="#5-3-常量定义规则" class="headerlink" title="5.3 常量定义规则"></a>5.3 常量定义规则</h1></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/language/" class="category-chain-item">language</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/c/">#c</a></div></div><div class="license-box my-3"><div class="license-title"><div>C语言高质量编程</div><div>https://www.oikiou.top/2019/b0d7d162/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Oikiou</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2019年10月28日</div></div><div class="license-meta-item"><div>许可协议</div><div><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="NC - 非商业性使用"><i class="iconfont icon-nc"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="SA - 相同方式共享"><i class="iconfont icon-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2020/a2d461a8/" title="给正在准备蓝桥杯的你"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">给正在准备蓝桥杯的你</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2019/14ee3806/" title="PID算法"><span class="hidden-mobile">PID算法</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><div id="twikoo"></div><script type="text/javascript">Fluid.utils.loadComments("#comments",function(){Fluid.utils.createScript("https://lib.baomitu.com/twikoo/1.6.10/twikoo.all.min.js",function(){var o=Object.assign({envId:"https://twikoo.oikiou.top:8884/",region:"ap-shanghai",path:"window.location.pathname"},{el:"#twikoo",path:"window.location.pathname",onCommentLoaded:function(){var o="#twikoo .tk-content img:not(.tk-owo-emotion)";Fluid.plugins.imageCaption(o),Fluid.plugins.fancyBox(o)}});twikoo.init(o)})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar category-bar" style="margin-left:-1rem"><div class="category-list"><div class="category row nomargin-x"><a class="category-item list-group-item category-item-action col-10 col-md-11 col-xm-11" title="language" id="heading-8512ae7d57b1396273f76fe6ed341a23" role="tab" data-toggle="collapse" href="#collapse-8512ae7d57b1396273f76fe6ed341a23" aria-expanded="true">language <span class="list-group-count">(8)</span> <i class="iconfont icon-arrowright"></i></a><div class="category-collapse collapse show" id="collapse-8512ae7d57b1396273f76fe6ed341a23" role="tabpanel" aria-labelledby="heading-8512ae7d57b1396273f76fe6ed341a23"><div class="category-post-list"><a href="/2019/b0d7d162/" title="C语言高质量编程" class="list-group-item list-group-item-action active"><span class="category-post">C语言高质量编程</span> </a><a href="/2020/3dd7ffa7/" title="C" class="list-group-item list-group-item-action"><span class="category-post">C</span> </a><a href="/2020/bf76c113/" title="MicroPython" class="list-group-item list-group-item-action"><span class="category-post">MicroPython</span> </a><a href="/2020/7ecf7a99/" title="PyQT" class="list-group-item list-group-item-action"><span class="category-post">PyQT</span> </a><a href="/2020/297a89d9/" title="Python学习笔记" class="list-group-item list-group-item-action"><span class="category-post">Python学习笔记</span> </a><a href="/2022/2f57a694/" title="正则表达式" class="list-group-item list-group-item-action"><span class="category-post">正则表达式</span> </a><a href="/2022/5751eea2/" title="C++" class="list-group-item list-group-item-action"><span class="category-post">C++</span> </a><a href="/2022/ddff0c71/" title="MS-DOS" class="list-group-item list-group-item-action"><span class="category-post">MS-DOS</span></a></div></div></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><span>如果你有任何反馈请联系oikiou@outlook.com</span></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">总访问量 <span id="busuanzi_value_site_pv"></span> 次 </span><span id="busuanzi_container_site_uv" style="display:none">总访客数 <span id="busuanzi_value_site_uv"></span> 人</span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t){var e=Fluid.plugins.typing,i=t.getElementById("subtitle");i&&e&&e(i.getAttribute("data-typed-text"))}((window,document))</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;0<t.find(".toc-list-item").length&&t.css("visibility","visible")}}))})</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/custom.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>