<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.webp"><link rel="icon" href="/img/favicon.webp"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="author" content="Oikiou"><meta name="keywords" content=""><meta name="description" content="前置知识SS(Shadowsocks) SSR(ShadowsocksR) v2ray vemess现在主流的科学上网方式是大家经常听的SS（Shadowsocks）、ssr（ShadowsocksR）、V2(v2ray)等等这些代理工具，还有基于这些代理工具的原理，扩展衍生出的在各平台使用且支持以上几种翻墙协议的科学上网工具，如clash、Netch、shadowrocket、Quantumul"><meta property="og:type" content="article"><meta property="og:title" content="V2ray"><meta property="og:url" content="https://www.oikiou.top/2022/e8d8fd18/index.html"><meta property="og:site_name" content="Oikiou&#39;s Blog"><meta property="og:description" content="前置知识SS(Shadowsocks) SSR(ShadowsocksR) v2ray vemess现在主流的科学上网方式是大家经常听的SS（Shadowsocks）、ssr（ShadowsocksR）、V2(v2ray)等等这些代理工具，还有基于这些代理工具的原理，扩展衍生出的在各平台使用且支持以上几种翻墙协议的科学上网工具，如clash、Netch、shadowrocket、Quantumul"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.oikiou.top/2022/e8d8fd18/how-to-choose-a-v2ray-plan.png"><meta property="article:published_time" content="2022-08-14T13:51:19.000Z"><meta property="article:modified_time" content="2022-09-10T05:20:07.503Z"><meta property="article:author" content="Oikiou"><meta property="article:tag" content="v2ray"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://www.oikiou.top/2022/e8d8fd18/how-to-choose-a-v2ray-plan.png"><meta name="referrer" content="no-referrer-when-downgrade"><title>V2ray - Oikiou&#39;s Blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/custom.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"www.oikiou.top",root:"/",version:"1.9.2",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"bash"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"left",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!1,baidu:null,google:"G-TSV6137NWK",gtag:"G-TSV6137NWK",tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/xml/local-search-database.xml"};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.google-analytics.com/analytics.js",function(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-TSV6137NWK","auto"),ga("send","pageview")})</script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=G-TSV6137NWK",function(){function a(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],a("js",new Date),a("config","G-TSV6137NWK")})</script><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Oikiou's Blog" type="application/atom+xml"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"> <a class="navbar-brand" href="/"><strong>Oikiou&#39;s Blog</strong></a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> 友链</a></li><li class="nav-item" id="search-btn"> <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"> <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/bg/wallpaper_07_low.webp) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="V2ray"></span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> Oikiou</span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-08-14 21:51" pubdate>2022年8月14日 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 12k 字</span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 202 分钟</span><span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="padding-left:2rem;margin-right:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></aside></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">V2ray</h1><p class="note note-info"> 本文最后更新于：12 天前</p><div class="markdown-body"><h1 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h1><h6 id="SS-Shadowsocks-SSR-ShadowsocksR-v2ray-vemess"><a href="#SS-Shadowsocks-SSR-ShadowsocksR-v2ray-vemess" class="headerlink" title="SS(Shadowsocks) SSR(ShadowsocksR) v2ray vemess"></a>SS(Shadowsocks) SSR(ShadowsocksR) v2ray vemess</h6><p>现在主流的科学上网方式是大家经常听的SS（Shadowsocks）、ssr（ShadowsocksR）、V2(v2ray)等等这些代理工具，还有基于这些代理工具的原理，扩展衍生出的在各平台使用且支持以上几种翻墙协议的科学上网工具，如clash、Netch、shadowrocket、Quantumult、Pharos Pro等等非常多。V2ray 也是一种加密软件，它有着自己的一个 Vemess 加密协议。</p><h6 id="VPN"><a href="#VPN" class="headerlink" title="VPN"></a><strong>VPN</strong></h6><p><strong>虚拟专用网</strong>（英语：virtual private network，缩写：<strong>VPN</strong>）将专用网络延伸到公共网络上，使用户能够在共享或公共网络上发送和接收数据，就像他们的计算设备直接连接到专用网络上一样[<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%99%9B%E6%93%AC%E7%A7%81%E4%BA%BA%E7%B6%B2%E8%B7%AF#cite_note-1">1]</a>。VPN的好处包括增加专用网络的功能、安全性和管理，它提供了对公共网络上无法访问的资源访问通常用于远程办公人员。加密很常见但不是VPN连接的固有部分。</p><p>VPN是通过使用专用线路或在现有网络上使用隧道协议创建一个虚拟的点对点连接而形成的。可从公共 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BA%92%E8%81%94%E7%BD%91">Internet</a> 获得的 VPN可以提供<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%B9%BF%E5%9F%9F%E7%BD%91">广域网</a> (WAN) 的一些好处。 从用户的角度来看，可以远程访问专用网络中可用的资源。</p><p>比如可以在家开学校VPN访问学校图书馆内网资源.</p><p>在GFW这块主要就说可以通过VPN内的某台主机访问受限网站.</p><h6 id="VPS"><a href="#VPS" class="headerlink" title="VPS"></a><strong>VPS</strong></h6><p>VPS就是虚拟专用服务器(Virtual private server)的英文缩写，简单的理解就是一台服务器被分成了很多台，当然这里的”分”并不是说砍成几半的，而是利用一些虚拟技术(<strong>OpenVZ</strong>, <strong>Xen</strong>, <strong>KVM</strong>)手段，使得多个<strong>用户可共享</strong>这台服务器。</p><p>通常，租用一台服务器费用是比较高的，而且对于用户来说，一台服务器的CPU计、内存、磁盘空间大多数时候是过剩的，这样非常浪费资源，并且用于又承担了较高的价格。而如果是购买VPS，价格则要划算得多，你相当于和其他多个用户一起在使用同一台服务器，你们<strong>共同分摊成本</strong>。当然你不用担心和其他用户在使用时产生冲突，这些问题通过虚拟化技术已经得到了很好的解决。</p><h6 id="梯子是什么"><a href="#梯子是什么" class="headerlink" title="梯子是什么"></a><strong>梯子是什么</strong></h6><p>梯子通常应该就是指能通过GFW的工具软件</p><h6 id="机场是什么？"><a href="#机场是什么？" class="headerlink" title="机场是什么？"></a><strong>机场是什么？</strong></h6><p>通常我们们会向服务器供应商租令了VPS主机，并在上面搭建SS或SSR的传输协议进行翻墙。由于SS&#x2F;SSR 最一开始以纸飞机做为Logo，因此俗称这些服务器节点为机场。</p><p>机场通常由第三方大厂承担搭建，直接向用户提供 ss、ssr、v2ray 节点服务，免去个人搭建流程，更快捷，线路优化也更好。<br>机场是老司机和小白皆可的一种方案，省事省心，稳定性和速度兼顾。</p><h6 id="V2Ray与Shadowsocks区别"><a href="#V2Ray与Shadowsocks区别" class="headerlink" title="V2Ray与Shadowsocks区别"></a><strong>V2Ray与Shadowsocks区别</strong></h6><p>V2Ray是在Shadowsocks之后出现的一个开源项目，目的就是为了更好的科学上网。相比于ss，V2Ray的定位是一个平台，任何开发者都可以在这个平台上利用V2Ray开发出一个新的代理软件，简单来说，ss的定位比较简单，功能也比较单一，而V2Ray的功能非常强大，相对的，V2Ray的<strong>配置就会复杂很多</strong>，喜欢鼓捣的同学可以试试。</p><h1 id="VPS-1"><a href="#VPS-1" class="headerlink" title="VPS"></a>VPS</h1><h2 id="VPS-运营商"><a href="#VPS-运营商" class="headerlink" title="VPS 运营商"></a>VPS 运营商</h2><table><thead><tr><th align="left">VPS 商家</th><th align="left">最低价格</th><th align="left">支付方式</th><th align="left">特点</th></tr></thead><tbody><tr><td align="left"><a target="_blank" rel="noopener" href="https://p3terx.com/archives/cn2-gia-vps-cloudpowerall.html">CloudPowerall</a></td><td align="left">$29.99&#x2F;年</td><td align="left"><strong>支付宝</strong>、PayPal、信用卡</td><td align="left"><strong>CN2 GIA</strong> 高端高速线路</td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="https://p3terx.com/archives/cheap-vps-bandwagonhost.html">BandwagonHost</a></td><td align="left">$49.99&#x2F;年</td><td align="left"><strong>支付宝</strong>、<strong>微信</strong>、PayPal、信用卡</td><td align="left"><strong>CN2 GIA</strong> 高端高速线路</td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="https://p3terx.com/go/aHR0cHM6Ly93d3cuZG1pdC5pby9hZmYucGhwP2FmZj0yMjk2JnBpZD0xMDAmbGFuZ3VhZ2U9Y2hpbmVzZQ">DMIT</a></td><td align="left">$88.88&#x2F;年</td><td align="left"><strong>支付宝</strong>、PayPal、信用卡</td><td align="left"><strong>CN2 GIA</strong> 高端高速线路</td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="https://p3terx.com/go/aHR0cHM6Ly9obWJjbG91ZC5jb20vYWZmLnBocD9hZmY9MjU0JnBpZD0xOTkmbGFuZ3VhZ2U9Y2hpbmVzZQ">HMBCloud</a></td><td align="left">$69.99&#x2F;年</td><td align="left"><strong>支付宝</strong>、PayPal、信用卡</td><td align="left"><strong>CN2 GIA</strong> 高端高速线路</td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="https://p3terx.com/archives/cheap-vps-buyvm.html">BuyVM</a></td><td align="left">$2&#x2F;月 ¥10&#x2F;月</td><td align="left"><strong>支付宝</strong>、PayPal、信用卡、Bitcoin</td><td align="left">低价、<strong>无限流量</strong>、大硬盘</td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="https://p3terx.com/archives/cheap-vps-racknerd.html">RackNerd</a></td><td align="left">$8.89&#x2F;年</td><td align="left"><strong>支付宝</strong>、PayPal、信用卡、Bitcoin</td><td align="left">低价格、大流量、高配置</td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="https://p3terx.com/archives/cheap-vps-cloudcone.html">CloudCone</a></td><td align="left">$1.99&#x2F;月</td><td align="left"><strong>支付宝</strong>、PayPal、信用卡</td><td align="left">低价格、大流量、大硬盘</td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="https://p3terx.com/go/aHR0cHM6Ly93d3cudnVsdHIuY29tLz9yZWY9NzEzMzE2OQ">Vultr</a></td><td align="left">$2.5&#x2F;月</td><td align="left"><strong>支付宝</strong>、<strong>微信</strong>、PayPal、Bitcoin</td><td align="left"><strong><a target="_blank" rel="noopener" href="https://p3terx.com/go/aHR0cHM6Ly93d3cudnVsdHIuY29tLz9yZWY9ODM4MjU2NC02Rw">注册送 100 美元</a>，有效期30天</strong></td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="https://p3terx.com/go/aHR0cHM6Ly9tLmRvLmNvL2MvNDkyMDc2YjE0ZmIy">DigitalOcean</a></td><td align="left">$5&#x2F;月</td><td align="left">PayPal、信用卡</td><td align="left"><strong><a target="_blank" rel="noopener" href="https://p3terx.com/go/aHR0cHM6Ly9tLmRvLmNvL2MvNDkyMDc2YjE0ZmIy">注册送 100 美元</a>，有效期60天</strong></td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="https://p3terx.com/archives/cuii-vps-olixnk-cloud.html">OLink Cloud</a></td><td align="left">$4&#x2F;月</td><td align="left"><strong>支付宝</strong>、PayPal、信用卡</td><td align="left"><strong>CU PM</strong> (AS9929) 精品线路</td></tr></tbody></table><p>购入的是 RackNerd 听说是卷钱跑路大王, 而且这个不能退钱买了就退不了, 购买后24小时内可以提单support换ip超时之后换就得交钱了, 我的第一个ip被墙, 第二个ip上不了谷歌, 对了听说这个VPS的全部产品都上不了奈飞.</p><p>同事推荐 CloudCone 低价好用, 这个按时间计费, 下次买这个试试看, 开到被墙 IP 地址可以选择删掉主机重新购买，由于按秒计费实际并不会扣款（活动套餐为7天无理由退款），会全额返还金额。也可以选择提交工单支付 2 美元更换可用 IP 。</p><h2 id="VPS-测试脚本"><a href="#VPS-测试脚本" class="headerlink" title="VPS 测试脚本"></a>VPS 测试脚本</h2><p>参考 <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/117547388">VPS常用测试脚本</a></p><h3 id="SuperBench-sh"><a href="#SuperBench-sh" class="headerlink" title="SuperBench.sh"></a>SuperBench.sh</h3><p>老鬼大佬的SuperBench测试脚本</p><ul><li>改进了显示的模式，基本参数添加了颜色，方面区分与查找。</li><li>I&#x2F;O测试，更改了原来默认的测试的内容，采用小文件，中等文件，大文件，分别测试IO性能，然后取平均值。</li><li>速度测试替换成了 Superspeed 里面的测试，第一个默认节点是，Speedtest 默认，其他分别测试到中国电信，联通，移动，各三个不同地区的速度。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget -qO- --no-check-certificate https://raw.githubusercontent.com/oooldking/script/master/superbench.sh | bash<br><span class="hljs-comment">#或者</span><br>curl -Lso- -no-check-certificate https://raw.githubusercontent.com/oooldking/script/master/superb<br></code></pre></td></tr></table></figure><h3 id="Bench-sh"><a href="#Bench-sh" class="headerlink" title="Bench.sh"></a>Bench.sh</h3><p>秋水逸冰大佬的写的Bench.sh脚本</p><ul><li>显示当前测试的各种系统信息；</li><li>取自世界多处的知名数据中心的测试点，下载测试比较全面；</li><li>支持 IPv6 下载测速；</li><li>IO 测试三次，并显示平均值。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget -qO- bench.sh | bash<br><span class="hljs-comment">#或者</span><br>curl -Lso- bench.sh | bash<br><span class="hljs-comment">#或者</span><br>wget -qO- 86.re/bench.sh | bash<br><span class="hljs-comment">#或者</span><br>curl -so- 86.re/bench.sh | bash<br></code></pre></td></tr></table></figure><h2 id="speedtest"><a href="#speedtest" class="headerlink" title="speedtest"></a>speedtest</h2><p>使用 speedtest.net 提供的 CLI 工具测试通过 WARP 访问外部网络的极限网速，不过仅限测试 IPv4 的速度。</p><ul><li>安装 Ookla Speedtest CLI</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -fsSL git.io/speedtest-cli.sh | sudo bash<br></code></pre></td></tr></table></figure><ul><li>执行<code>speedtest</code>命令测速。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">speedtest<br></code></pre></td></tr></table></figure><h1 id="v2ray搭建"><a href="#v2ray搭建" class="headerlink" title="v2ray搭建"></a>v2ray搭建</h1><h2 id="参考资料及前置知识"><a href="#参考资料及前置知识" class="headerlink" title="参考资料及前置知识"></a>参考资料及前置知识</h2><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p>V2Ray 项目地址：<a target="_blank" rel="noopener" href="https://github.com/v2ray/v2ray-core">https://github.com/v2ray/v2ray-core</a></p><p>V2Ray 用户手册：<a target="_blank" rel="noopener" href="https://www.v2ray.com/">https://www.v2ray.com</a></p><p><a target="_blank" rel="noopener" href="https://github.com/v2fly/v2ray-examples">!! v2ray参考配置文件</a></p><p><a target="_blank" rel="noopener" href="https://www.v2fly.org/guide/start.html">v2ray 白话文教程</a></p><p><a target="_blank" rel="noopener" href="https://toutyrater.github.io/">v2ray 白话文教程社区版</a></p><p><a target="_blank" rel="noopener" href="https://www.v2ray.com/chapter_02/01_overview.html">v2ray的配置文件格式说明</a></p><h3 id="前置知识-1"><a href="#前置知识-1" class="headerlink" title="前置知识"></a>前置知识</h3><h4 id="ws-WebSocket"><a href="#ws-WebSocket" class="headerlink" title="ws WebSocket"></a>ws WebSocket</h4><p>好的我们清楚了TLS是什么，我们现在就来讲一讲WS，我们经常说的WS其实也就是 WebSocket，但是 WebSocket 和我们常见的 Socket 是完全两个不同的东西。WebSocket 他是使用80 端口作为一般的请求，使用443 端口作为传输加密层的一个端口，WebSocket 它的一个数据格式是比较轻量的，它的性能开销都很小，但是他的通讯效率特别的高。大家只要弄清楚WebSocket 和 Socket 是完全不同的两个东西就行了。</p><h4 id="TLS"><a href="#TLS" class="headerlink" title="TLS"></a>TLS</h4><p>其实TIS翻译成中文就是传输层安全。大家需要知道 V2ray 的 TLS，并不是伪装，也不是混淆，他这是完整的真正的TIS。包括后面我们要说的WebSocket 也不是伪装，TLS 他是证书认证的机制，所以我们若是需要 TLS 就需要申请，证书需要申请域名 等等的一些。</p><p>证书当然是有免费的也有收费的，我们经常使用的就是免费的，我们经常使用的一件脚本里面的，自动申请证书都是免费的证书申请，基本上我们的证书都是来自 Let’s encrypt。这么一个证书签发机构，那么对于证书申请的办法，目前就我所知道使用的最多的也就是acme 的一个一键脚本，由于Let’s encrypt 的证书有效期只有三个月，那么也就是意味着我们每九十天就必须更新一次证书。而 acme 脚本它是每 60天 会帮我们自动更新一次证书，当然你也可以选择手动的去更新你的SSL证书。</p><h4 id="Trojan"><a href="#Trojan" class="headerlink" title="Trojan"></a>Trojan</h4><p>其实 Trojan 的话，他翻译成中文就是木马病毒的一个意思，所以说我们把 Trojan 也成为木马。由于 Trojan 他是一个比较新型的翻墙软件，他这个开发者设计的时候估计是想到了更适合我们国情的一种思路。</p><p>在穿越防火墙的时候，我们总是想强加密或者是随机混淆的一些办法可能欺骗防火墙，但是Trojan 实现了这个思路的一个反面，他模仿了互联网上最常见的，就是我们刚才所说的HTTPS 的一个协议。他欺骗防火墙说我这个东西就是一个 HTTPS，从而不会被防火墙识别。</p><p>Trojan 它的工作端口是在443，如果是合法的Trojan 请求的话那么他就会为这种请求提供服务，如果你的Trojan 请求不合法的话，他就会将不合法的这种请求转交给你WEB服务器上面的Nginx，由Nginx 为那种流量服务那么基于这种工作原理。我们就可以知道Trojan 的一切表现和 Nginx 是一模一样，不会引入或产生额外的一些特征包，从而达到无法识别的一些效果。</p><p>大家也就应该知道了Trojan 其实也就是V2ray+ws+tls 的一个精简版。既然是精简版，那么 Trojan 在能效方面就会有更好的一个表现，其实在实际的测试过程中 Trojan 的速度也的确是比V2ray+ws+tls 快那么一点点</p><h4 id="刚开始使用-V2Ray，有什么需要注意的吗？"><a href="#刚开始使用-V2Ray，有什么需要注意的吗？" class="headerlink" title="刚开始使用 V2Ray，有什么需要注意的吗？"></a>刚开始使用 V2Ray，有什么需要注意的吗？</h4><p>由于许多 V2Ray 用户都有使用过 Shadowsocks 的经验，基本上可以按照使用 Shadowsocks 那样使用。但是 V2Ray 还是和 Shadowsocks 不太一样，所以我大概说一下使用上的差异。请注意，差异不代表好坏或优劣，如果一个事物必须拥有其他同类所拥有的东西，那么它也就没有了存在的意义。</p><ul><li>客户端：V2Ray 本身只是一个内核，V2Ray 上的图形客户端大多是调用 V2Ray 内核套一个图形界面的外壳，类似于 Linux 内核和 Linux 操作系统的关系；而 Shadowsocks 的客户端都是自己重新实现了一遍 Shadowsocks 协议。本文的内容短期内不涉及图形客户端的使用。</li><li>分流：也许大家第一反映是 PAC，实际上无论是 Shadowsocks (特指 Shadowsocks-libev) 还是 V2Ray 本身不支持 PAC，都是客户端加进来的；Shadowsocks 的分流使用 ACL，V2Ray 使用自己实现的路由功能，孰优孰劣只是仁者智者的问题。</li><li>分享链接&#x2F;二维码：V2Ray 不像 Shadowsocks 那样有统一规定的 URL 格式，所以各个 V2Ray 图形客户端的分享链接&#x2F;二维码不一定通用。</li><li>加密方式：V2Ray (特指 VMess 协议) 不像 Shadowsocks 那样看重对加密方式的选择，并且 VMess 的加密方式是由客户端指定的，服务器自适应。</li><li>时间：使用 V2Ray 要保证时间准确，因为这是为了安全设计的。</li><li>密码：V2Ray(VMesss) 只有 id（使用 UUID 的格式），作用类似于 Shadowsocks 的密码，但随机性远好于 Shadowsocks 的密码，只是不太方便记忆(安全和方便的矛盾)。</li><li>UDP 转发：VMess 是基于 TCP 的协议，对于 UDP 包 V2Ray 会转成 TCP 再传输的，即 UDP over TCP。要 UDP 转发功能在客户端的 socks 协议中开启 UDP 即可。</li><li>路由器翻墙：实际上它们并没有什么区别，不要以为没有插件就不能在路由器上用，看事物请看本质。</li></ul><h4 id="既然-V2Ray-复杂，为什么要用它？"><a href="#既然-V2Ray-复杂，为什么要用它？" class="headerlink" title="既然 V2Ray 复杂，为什么要用它？"></a>既然 V2Ray 复杂，为什么要用它？</h4><p>童鞋，某事物的优点和缺点总是相生相随的。相对来说，V2Ray 有以下优势：</p><ul><li><p><strong>更完善的协议:</strong> V2Ray 使用了新的自行研发的 VMess 协议，改正了 Shadowsocks 一些已有的缺点，更难被墙检测到</p></li><li><p><strong>更强大的性能:</strong> 网络性能更好，具体数据可以看 <a target="_blank" rel="noopener" href="https://steemit.com/cn/@v2ray/3cjiux">V2Ray 官方博客</a></p></li><li><p>更丰富的功能:</p><p>以下是部分 V2Ray 的功能</p><ul><li>mKCP: KCP 协议在 V2Ray 上的实现，不必另行安装 kcptun</li><li>动态端口：动态改变通信的端口，对抗对长时间大流量端口的限速封锁</li><li>路由功能：可以随意设定指定数据包的流向，去广告、反跟踪都可以</li><li>传出代理：看名字可能不太好理解，其实差不多可以称之为多重代理。类似于 Tor 的代理</li><li>数据包伪装：类似于 Shadowsocks-rss 的混淆，另外对于 mKCP 的数据包也可伪装，伪装常见流量，令识别更困难</li><li>WebSocket 协议：可以 PaaS 平台搭建V2Ray，通过 WebSocket 代理。也可以通过它使用 CDN 中转，抗封锁效果更好</li><li>Mux:多路复用，进一步提高科学上网的并发性能</li></ul></li></ul><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><h3 id="1-检查系统"><a href="#1-检查系统" class="headerlink" title="1 检查系统"></a>1 检查系统</h3><h4 id="时间是否准确"><a href="#时间是否准确" class="headerlink" title="时间是否准确"></a>时间是否准确</h4><p>V2Ray 对于时间有比较严格的要求，要求服务器和客户端时间差绝对值不能超过 2 分钟，所以一定要保证时间足够准确。还好 V2Ray 并不要求时区一致。比如说自个儿电脑上的时间是北京时间（东 8 区）2017-07-31 12:08:31，但是 VPS 上的时区是东 9 区，所以 VPS 上的时间应该是2017-07-31 13:06:31 到 2017-07-31 13:10:31 之间才能正常使用 V2Ray。当然，也可以自行改成自己想要的时区。</p><p>对于 VPS(Linux) 可以执行命令 <code>date -R</code> 查看时间：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">date</span> -R<br>Sun, 22 Jan 2017 10:10:36 -0500<br></code></pre></td></tr></table></figure><p>输出结果中的 -0500 代表的是时区为西 5 区，如果转换成东 8 区时间则为 <code>2017-01-22 23:10:36</code>。</p><p>如果时间不准确，可以使用 <code>date --set</code> 修改时间：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo <span class="hljs-built_in">date</span> --<span class="hljs-built_in">set</span>=<span class="hljs-string">&quot;2017-01-22 16:16:23&quot;</span><br>Sun 22 Jan 16:16:23 GMT 2017<br></code></pre></td></tr></table></figure><h3 id="2-安装"><a href="#2-安装" class="headerlink" title="2 安装"></a>2 安装</h3><h4 id="2-1-在VPS上安装"><a href="#2-1-在VPS上安装" class="headerlink" title="2.1 在VPS上安装"></a>2.1 在VPS上安装</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 这个好像已经过期</span><br>bash &lt;(curl -L -s https://install.direct/go.sh)<br><br>bash &lt;(curl -L https://raw.githubusercontent.com/v2fly/fhs-install-v2ray/master/install-release.sh)<br></code></pre></td></tr></table></figure><p>此脚本会自动安装以下文件：</p><ul><li><code>/usr/local/bin/v2ray</code>：V2Ray 程序；</li><li><code>/usr/local/bin/v2ctl</code>：V2Ray 工具；</li><li><code>/usr/local/etc/v2ray/config.json</code>：配置文件；</li><li><code>/usr/local/bin/v2ray/geoip.dat</code>：IP 数据文件</li><li><code>/usr/local/bin/v2ray/geosite.dat</code>：域名数据文件</li></ul><p>此脚本会配置自动运行脚本。自动运行脚本会在系统重启之后，自动运行 V2Ray。目前自动运行脚本只支持带有 Systemd 的系统，以及 Debian &#x2F; Ubuntu 全系列。</p><p>脚本运行完成后，你需要：</p><ol><li>编辑 <code>/etc/v2ray/config.json</code> 文件来配置你需要的代理方式；</li><li>运行<code>service v2ray start</code>来启动 V2Ray 进程； 也可以使用 <code>systemctl start v2ray</code></li><li><code>systemctl enable v2ray</code>开机启动V2ray</li><li>之后可以使用 <code>service v2ray start|stop|status|reload|restart|force-reload</code> 控制 V2Ray 的运行。</li></ol><h4 id="2-2-在pc安装"><a href="#2-2-在pc安装" class="headerlink" title="2.2 在pc安装"></a>2.2 在pc安装</h4><p>点<a target="_blank" rel="noopener" href="https://github.com/v2ray/v2ray-core/releases">这里下载Github releases 的v2ray</a> Windows 压缩包，如果是 32 位系统，下载 v2ray-windows-32.zip，如果是 64 位系统，下载 v2ray-windows-64.zip（下载速度慢或无法下载请考虑挂已有的翻墙软件来下载）。下载并且解压之后会有下面这些文件：</p><ul><li><code>v2ray.exe</code> 运行 V2Ray 的程序文件</li><li><code>wv2ray.exe</code> 同 v2ray.exe，区别在于wv2ray.exe是后台运行的，不像 v2ray.exe 会有类似于 cmd 控制台的窗口。运行 V2Ray 时从 v2ray.exe 和 wv2ray.exe 中任选一个即可</li><li><code>config.json</code> V2Ray 的配置文件，后面我们对 V2Ray 进行配置其实就是修改这个文件</li><li><code>v2ctl.exe</code> V2Ray 的工具，有多种功能，除特殊用途外，一般由 v2ray.exe 来调用，用户不用太关心</li><li><code>geosite.dat</code> 用于路由的域名文件</li><li><code>geoip.dat</code> 用于路由的 IP 文件</li><li><code>其它</code> 除上面的提到文件外，其他的不是运行 V2Ray 的必要文件。更详细的说明可以看 doc 文件夹下的 readme.md 文件，可以通过记事本或其它的文本编辑器打开查看</li></ul><h3 id="3-配置"><a href="#3-配置" class="headerlink" title="3 配置"></a>3 配置</h3><ul><li>关于json</li></ul><p>对于 Linux 有一个软件叫 jq，可以执行这样的指令检查配置文件的语法是否正确：这里的 config.json 是当前目录下的 config.json。特别注意命令中的点 . 不能省去。</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">$ <span class="hljs-keyword">jq </span>. <span class="hljs-built_in">config</span>.<span class="hljs-keyword">json</span><br></code></pre></td></tr></table></figure><p>（从 v2.11 起新增了一个注释功能，配置文件允许 <code>//</code> 和 <code>/**/</code> 注释。但是 JSON 的标准格式的没有注释的，也就是说如果你给配置文件加了注释，再使用上文我说的格式化功能会报错说你的 JSON 语法（格式）不对。）</p><ul><li>关于id</li></ul><p>由于 id 使用的是 UUID 的格式，我们可以使用任何 UUID 生成工具生成 UUID 作为这里的 id。比如 <a target="_blank" rel="noopener" href="https://www.uuidgenerator.net/">UUID Generator</a> 这个网站，只要一打开或者刷新这个网页就可以得到一个 UUID，如下图。或者可以在 Linux 使用命令 <code>cat /proc/sys/kernel/random/uuid</code> 生成。</p><ul><li>关于数据流向</li></ul><p>实际上数据包的流向就是：</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript">&#123;浏览器&#125; &lt;--<span class="hljs-function"><span class="hljs-params">(socks)</span>--&gt;</span> &#123;V2Ray 客户端 inbound &lt;-&gt; V2Ray 客户端 outbound&#125; &lt;--<span class="hljs-function"><span class="hljs-params">(VMess)</span>--&gt;</span>  &#123;V2Ray 服务器 inbound &lt;-&gt; V2Ray 服务器 outbound&#125; &lt;--<span class="hljs-function"><span class="hljs-params">(Freedom)</span>--&gt;</span> &#123;目标网站&#125;<br></code></pre></td></tr></table></figure><h4 id="3-1-客户端"><a href="#3-1-客户端" class="headerlink" title="3.1 客户端"></a>3.1 客户端</h4><p>服务器的配置中需要确保 <strong>1.id</strong> <strong>2.outbounds port</strong> 与客户端一致，还需要检查 <strong>3.服务器的IP</strong> <strong>4.inbounds port(本地sock5的地址)</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;log&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;loglevel&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;warning&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;routing&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;domainStrategy&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;AsIs&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;rules&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>            <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;ip&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                    <span class="hljs-string">&quot;geoip:private&quot;</span><br>                <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;outboundTag&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;direct&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;field&quot;</span><br>            <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;inbounds&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;port&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1080</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;protocol&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;socks&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;settings&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;auth&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;noauth&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;udp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>            <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;tag&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;socks&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;outbounds&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;protocol&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vmess&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;settings&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;vnext&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                    <span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;users&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                            <span class="hljs-punctuation">&#123;</span><br>                                <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>                            <span class="hljs-punctuation">&#125;</span><br>                        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;port&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1234</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;address&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Your_IP_Address&quot;</span><br>                    <span class="hljs-punctuation">&#125;</span><br>                <span class="hljs-punctuation">]</span><br>            <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;protocol&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;freedom&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;tag&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;direct&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h4 id="3-2-服务端"><a href="#3-2-服务端" class="headerlink" title="3.2 服务端"></a>3.2 服务端</h4><p>下面配置需要注意的地方是 <strong>1.inbounds Port</strong> <strong>2.id</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;log&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;loglevel&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;warning&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;routing&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;domainStrategy&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;AsIs&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;rules&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>            <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;ip&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                    <span class="hljs-string">&quot;geoip:private&quot;</span><br>                <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;outboundTag&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;blocked&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;field&quot;</span><br>            <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;inbounds&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;port&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1234</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;protocol&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vmess&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;settings&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;clients&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>                    <span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>                    <span class="hljs-punctuation">&#125;</span><br>                <span class="hljs-punctuation">]</span><br>            <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;outbounds&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;protocol&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;freedom&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;protocol&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;blackhole&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;tag&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;blocked&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h2><h3 id="配置文件的选择"><a href="#配置文件的选择" class="headerlink" title="配置文件的选择"></a>配置文件的选择</h3><p><img src="/2022/e8d8fd18/how-to-choose-a-v2ray-plan.png" srcset="/img/loading.gif" lazyload alt="how-to-choose-a-v2ray-plan.png"></p><p><a target="_blank" rel="noopener" href="https://github.com/v2fly/v2ray-examples/">https://github.com/v2fly/v2ray-examples/</a></p><h3 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h3><p>WebSocket 的配置其实很简单，就跟 mKCP 一样把 <code>network</code> 改成 <code>&quot;network&quot;:&quot;ws&quot;</code> 行了</p><p><a target="_blank" rel="noopener" href="https://toutyrater.github.io/advanced/websocket.html">https://toutyrater.github.io/advanced/websocket.html</a></p><h3 id="动态端口-避免被电信封杀"><a href="#动态端口-避免被电信封杀" class="headerlink" title="动态端口(避免被电信封杀)"></a>动态端口(避免被电信封杀)</h3><p>V2Ray 提供了一个叫动态端口的功能。顾名思义，就是可以动态变化通信端口，该功能的初衷是为了应对电信服务运营商可能会对长时间大流量的单个端口进行限速。</p><p><strong>实测效果很不错</strong></p><p><a target="_blank" rel="noopener" href="https://toutyrater.github.io/advanced/dynamicport.html">https://toutyrater.github.io/advanced/dynamicport.html</a></p><h3 id="TLS-1"><a href="#TLS-1" class="headerlink" title="TLS"></a>TLS</h3><p>&#x2F;&#x2F; TODO</p><h3 id="Mux"><a href="#Mux" class="headerlink" title="Mux"></a>Mux</h3><h3 id="Route-国内直连"><a href="#Route-国内直连" class="headerlink" title="Route 国内直连"></a>Route 国内直连</h3><p><a target="_blank" rel="noopener" href="https://toutyrater.github.io/basic/routing/cndirect.html">https://toutyrater.github.io/basic/routing/cndirect.html</a></p><h3 id="AD-Block"><a href="#AD-Block" class="headerlink" title="AD Block"></a>AD Block</h3><h2 id="客户端图形化工具"><a href="#客户端图形化工具" class="headerlink" title="客户端图形化工具"></a>客户端图形化工具</h2><p>参考 <a target="_blank" rel="noopener" href="https://www.v2ray.com/awesome/tools.html">https://www.v2ray.com/awesome/tools.html</a></p><p><a target="_blank" rel="noopener" href="https://tlanyan.pp.ua/v2ray-clients-download/">https://tlanyan.pp.ua/v2ray-clients-download/</a></p><h1 id="WARP"><a href="#WARP" class="headerlink" title="WARP"></a>WARP</h1><p><a target="_blank" rel="noopener" href="https://p3terx.com/go/aHR0cHM6Ly8xLjEuMS4xLw">WARP</a> 是 Cloud­flare 提供的一项基于 Wire­Guard 的网络流量安全及加速服务，能够让你通过连接到 Cloud­flare 的边缘节点实现隐私保护及链路优化。之前有很多小伙伴拿来当做某科学的上网工具来使用，应该很熟悉了。不过由于 Wire­Guard 数据传输使用的 UDP 协议，中国大陆运营商会对其进行 QoS ，加上多数 IP 被封锁，现在可以说几乎处于不可用的状态了。而对于自由网络的地区来说没有这些限制，加上有国外开发者制作的工具可以生成通用的 Wire­Guard 配置文件，这使得我们可以在海外 VPS 上部署并获得如下效果加成：</p><ul><li>WARP 网络出入口均为双栈 (IPv4&#x2F;IPv6)，因此单栈服务器可以连接到 WARP 来获取额外的网络连通性支持：<ul><li>IPv6 Only VPS 可获得 IPv4 网络的访问能，不再局限于 DNS64 的束缚，能自定义任意 DNS 解析服务器。对使用某科学的上网工具有奇效。</li><li>IPv4 Only VPS 可获得 IPv6 网络的访问能力，可作为 IPv6 Only VPS 的 SSH 跳板。此外 WARP 的 IPv6 网络的质量比 <a target="_blank" rel="noopener" href="https://p3terx.com/archives/use-he-tunnel-broker-to-add-public-network-ipv6-support-to-ipv4-vps-for-free.html">HE IPv6 Tunnel Broker</a> 甚至自带的都要好，很少绕路。</li></ul></li><li>WARP 对外访问网络的 IP 被很多网站视为真实用户，即所谓的 “原生” IP，可以解除某些网站基于 IP 的封锁限制：<ul><li>解锁 Netflix 非自制剧</li><li>跳过 Google 验证码</li><li>解除 Google 学术访问限制</li><li>解除 YouTube Premium 定位漂移和地区限制</li></ul></li></ul><h2 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h2><p><a target="_blank" rel="noopener" href="https://www.moeelf.com/archives/301.html">https://www.moeelf.com/archives/301.html</a> (教程)</p><p><a target="_blank" rel="noopener" href="https://p3terx.com/go/aHR0cHM6Ly9naXRodWIuY29tL1AzVEVSWC93YXJwLnNo">https://github.com/P3TERX/warp.sh</a></p><p><a target="_blank" rel="noopener" href="https://github.com/fscarmen/warp">https://github.com/fscarmen/warp</a></p><h2 id="P3TERX部署"><a href="#P3TERX部署" class="headerlink" title="P3TERX部署"></a>P3TERX部署</h2><p>我这里部署了之后虽然避免了谷歌的人机验证但是速度下降严重, 暂时弃用, 后续可以考虑ip分流</p><p>参考 <a target="_blank" rel="noopener" href="https://p3terx.com/archives/use-cloudflare-warp-to-add-extra-ipv4-or-ipv6-network-support-to-vps-servers-for-free.html">https://p3terx.com/archives/use-cloudflare-warp-to-add-extra-ipv4-or-ipv6-network-support-to-vps-servers-for-free.html</a></p><p><a target="_blank" rel="noopener" href="https://p3terx.com/archives/cloudflare-warp-configuration-script.html">https://p3terx.com/archives/cloudflare-warp-configuration-script.html</a></p><ul><li><p>无论 VPS 是 IPv4 还是 IPv6 又或都有，添加 WARP Wire­Guard 双栈全局网络，直接使用以下命令一把梭：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 自动配置 WARP WireGuard 双栈全局网络</span><br>bash &lt;(curl -fsSL git.io/warp.sh) d<br></code></pre></td></tr></table></figure></li><li><p>给喜欢功能菜单的小伙伴特别准备的功能，执行以下命令显示功能菜单和贴心的状态显示：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Cloudflare WARP 一键配置脚本 功能菜单</span><br>bash &lt;(curl -fsSL git.io/warp.sh) menu<br></code></pre></td></tr></table></figure></li><li><p>安装并自动配置 WARP IPv6 网络（使用 WireGuard），让您的 Linux 服务器访问 IPv6 网络。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash &lt;(curl -fsSL git.io/warp.sh) wg6<br></code></pre></td></tr></table></figure></li><li><p>关闭接口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo wg-quick down wgcf<br></code></pre></td></tr></table></figure></li><li><p>check</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># IPv6</span><br>curl -6 ip.p3terx.com<br><span class="hljs-comment"># IPv4</span><br>curl -4 ip.p3terx.com<br></code></pre></td></tr></table></figure><h2 id="fscarmen部署"><a href="#fscarmen部署" class="headerlink" title="fscarmen部署"></a>fscarmen部署</h2><p>首次运行</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">wget -N https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/fscarmen/</span>warp<span class="hljs-regexp">/main/m</span>enu.sh &amp;&amp; bash menu.sh [option] [lisence]<br></code></pre></td></tr></table></figure><p>再次运行</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">warp <span class="hljs-selector-attr">[option]</span> <span class="hljs-selector-attr">[lisence]</span><br></code></pre></td></tr></table></figure><h1 id="BBR加速"><a href="#BBR加速" class="headerlink" title="BBR加速"></a>BBR加速</h1><p>大家都知道国外的服务器远离大陆，在国内连接速度并不是很好，尤其是在晚高峰期体验效果明显有所下降，此时我们需要安装一些脚本进行加速。前段时间 Google 开源了 TCP BBR 拥塞控制算法，并提交到了 Linux 内核，从 4.9 开始，Linux 内核已经用上了该算法。根据用户使用体验的效果来看在 VPS 上开启了 TCP BBR 后网速最高可达到10几倍的提升。</p><p>关于 Google BBR 拥塞控制算法目前有很多个版本，一个原版，另一个为魔改版，还有加强版的BBRPLUS版本。魔改版 Google BBR 和PLUS版本的BBR是在原版的基础上调整了一些参数，加速效果更胜一筹。</p><h2 id="google原版-BBR"><a href="#google原版-BBR" class="headerlink" title="google原版 BBR"></a>google原版 BBR</h2><p>较新的系统是自带BBR的 以下可以开启</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;net.core.default_qdisc=fq&quot;</span> &gt;&gt; /etc/sysctl.conf<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;net.ipv4.tcp_congestion_control=bbr&quot;</span> &gt;&gt; /etc/sysctl.conf<br>sysctl -p<br>lsmod | grep bbr<br></code></pre></td></tr></table></figure><h2 id="魔改BBR"><a href="#魔改BBR" class="headerlink" title="魔改BBR"></a>魔改BBR</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget -N --no-check-certificate <span class="hljs-string">&quot;https://raw.githubusercontent.com/chiakge/Linux-NetSpeed/master/tcp.sh&quot;</span> &amp;&amp; <span class="hljs-built_in">chmod</span> +x tcp.sh &amp;&amp; ./tcp.sh<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget -N --no-check-certificate <span class="hljs-string">&quot;https://github.000060000.xyz/tcpx.sh&quot;</span> &amp;&amp; <span class="hljs-built_in">chmod</span> +x tcpx.sh &amp;&amp; ./tcpx.sh<br></code></pre></td></tr></table></figure></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/tools/" class="category-chain-item">tools</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/v2ray/">#v2ray</a></div></div><div class="license-box my-3"><div class="license-title"><div>V2ray</div><div>https://www.oikiou.top/2022/e8d8fd18/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Oikiou</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2022年8月14日</div></div><div class="license-meta-item"><div>许可协议</div><div><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i></span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="NC - 非商业性使用"><i class="iconfont icon-nc"></i></span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="SA - 相同方式共享"><i class="iconfont icon-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div></div><article id="comments" lazyload><div id="twikoo"></div><script type="text/javascript">Fluid.utils.loadComments("#comments",function(){Fluid.utils.createScript("https://lib.baomitu.com/twikoo/1.6.5/twikoo.all.min.js",function(){var t=Object.assign({envId:"https://pretty.cf:8884/",region:"ap-shanghai",path:"window.location.pathname"},{el:"#twikoo",path:"window.location.pathname",onCommentLoaded:function(){var t="#twikoo .tk-content img:not(.tk-owo-emotion)";Fluid.plugins.imageCaption(t),Fluid.plugins.fancyBox(t)}});twikoo.init(t)})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4> <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"> <input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="statistics"> <span id="busuanzi_container_site_pv" style="display:none">总访问量<span id="busuanzi_value_site_pv"></span> 次</span> <span id="busuanzi_container_site_uv" style="display:none">总访客数<span id="busuanzi_value_site_uv"></span> 人</span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var o=jQuery("#board-ctn").offset().top;window.tocbot.init({tocSelector:"#toc-body",contentSelector:".markdown-body",headingSelector:CONFIG.toc.headingSelector||"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",collapseDepth:CONFIG.toc.collapseDepth||0,scrollSmooth:!0,headingsOffset:-o}),0<t.find(".toc-list-item").length&&t.css("visibility","visible")}})</script><script src="https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script defer="defer" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/custom.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>